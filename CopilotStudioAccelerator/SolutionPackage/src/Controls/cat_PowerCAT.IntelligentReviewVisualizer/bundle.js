/*! For license information please see bundle.js.LICENSE.txt */
var pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad;(()=>{var e={276:(e,t,r)=>{"use strict";e.exports=r(7414).extend({implicit:[r(4858),r(9650)],explicit:[r(5265),r(4573),r(6599),r(6402)]})},332:(e,t,r)=>{"use strict";var n=r(1602);e.exports=new n({explicit:[r(2461),r(5693),r(1096)]})},884:(e,t,r)=>{"use strict";var n=r(9444);function i(e,t,r,n,i){var o="",a="",s=Math.floor(i/2)-1;return n-t>s&&(t=n-s+(o=" ... ").length),r-n>s&&(r=n+s-(a=" ...").length),{str:o+e.slice(t,r).replace(/\t/g,"→")+a,pos:n-t+o.length}}function o(e,t){return n.repeat(" ",t-e.length)+e}e.exports=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var r,a=/\r?\n|\r|\0/g,s=[0],l=[],c=-1;r=a.exec(e.buffer);)l.push(r.index),s.push(r.index+r[0].length),e.position<=r.index&&c<0&&(c=s.length-2);c<0&&(c=s.length-1);var u,p,d="",f=Math.min(e.line+t.linesAfter,l.length).toString().length,h=t.maxLength-(t.indent+f+3);for(u=1;u<=t.linesBefore&&!(c-u<0);u++)p=i(e.buffer,s[c-u],l[c-u],e.position-(s[c]-s[c-u]),h),d=n.repeat(" ",t.indent)+o((e.line-u+1).toString(),f)+" | "+p.str+"\n"+d;for(p=i(e.buffer,s[c],l[c],e.position,h),d+=n.repeat(" ",t.indent)+o((e.line+1).toString(),f)+" | "+p.str+"\n",d+=n.repeat("-",t.indent+f+3+p.pos)+"^\n",u=1;u<=t.linesAfter&&!(c+u>=l.length);u++)p=i(e.buffer,s[c+u],l[c+u],e.position-(s[c]-s[c+u]),h),d+=n.repeat(" ",t.indent)+o((e.line+u+1).toString(),f)+" | "+p.str+"\n";return d.replace(/\n$/,"")}},1096:(e,t,r)=>{"use strict";var n=r(9113);e.exports=new n("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}})},1274:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.patternCheckUnusedVariables=function(e){var{patternID:t,patternName:r,description:o,docLink:a,recommendation:s,severity:l,category:c}=n.FlowPatternDetails.UnusedVariables,u=(0,i.getDeclaredVariables)(e),p=(0,i.getVariablesUsedInVariableActions)(e),d=[];function f(e,t){return!("string"!=typeof e||!e.includes("variables('".concat(t,"')")))||!(!e||"object"!=typeof e)&&Object.values(e).some((e=>f(e,t)))}return u.forEach((t=>{f(e,t.name)&&p.add(t.name)})),u.forEach((e=>{p.has(e.name)||d.push(e.name)})),{patternID:t,patternName:r,description:o,status:0===d.length?"Pass":"Fail",instanceValue:d,failureReason:d.length>0?"Unused variables detected.":"",recommendation:s,docLinks:a,severity:l,category:c}},t.patternOptimizeActionCounts=function(e){var{patternID:t,patternName:r,description:i,docLink:o,recommendation:a,severity:s,category:l}=n.FlowPatternDetails.ActionCount,c=function e(t){var r=0;return t&&"object"==typeof t?(t.hasOwnProperty("actions")&&"object"==typeof t.actions&&(r+=Object.keys(t.actions).length),Object.values(t).forEach((t=>{("object"==typeof t||Array.isArray(t))&&(r+=e(t))}))):Array.isArray(t)&&t.forEach((t=>{r+=e(t)})),r}(e),u=c>50;return{patternID:t,patternName:r,description:i,status:u?"Fail":"Pass",instanceValue:u?["".concat(c," actions detected, consider reducing to 50 or less actions.")]:[],failureReason:u?"Action count exceeds recommended limit of 50 actions per flow.":"",recommendation:a,docLinks:o,severity:s,category:l}},t.patternCheckConsistentNaming=function(e){var t,r,{patternID:i,patternName:o,description:a,docLink:s,recommendation:l,severity:c,category:u}=n.FlowPatternDetails.NamingConventions,p=(null==e||null===(t=e.properties)||void 0===t||null===(t=t.definition)||void 0===t?void 0:t.actions)||{},d=(null==e||null===(r=e.properties)||void 0===r||null===(r=r.definition)||void 0===r?void 0:r.triggers)||{},f=[];function h(e,t){e.manual||Object.keys(e).forEach((e=>{e.startsWith(t)||f.push(e)}))}return h(d,"Trg_"),h(p,"Act_"),{patternID:i,patternName:o,description:a,status:0===f.length?"Pass":"Warning",instanceValue:f,failureReason:f.length>0?"Inconsistent naming detected.":"",recommendation:l,docLinks:s,severity:c,category:u}},t.patternCheckNestedLoops=function(e){var t,{patternID:r,patternName:i,description:o,docLink:a,recommendation:s,severity:l,category:c}=n.FlowPatternDetails.NestedLoops,u=(null==e||null===(t=e.properties)||void 0===t||null===(t=t.definition)||void 0===t?void 0:t.actions)||{},p=[],d=new Set;function f(e,t,r){if(e&&"object"==typeof e){if(d.has(t))return;d.add(t);var n=e.type;if("Foreach"===n||"Until"===n){if(r.length>0){var i=r[r.length-1];p.push("".concat(i," -> ").concat(t))}r.push(t)}e.actions&&Object.keys(e.actions).forEach((t=>{f(e.actions[t],t,[...r])})),"If"===n&&(e.actions&&Object.keys(e.actions).forEach((t=>{f(e.actions[t],t,[...r])})),e.else&&e.else.actions&&Object.keys(e.else.actions).forEach((t=>{f(e.else.actions[t],t,[...r])}))),"Switch"===n&&e.cases&&Object.entries(e.cases).forEach((e=>{var[,t]=e;t.actions&&Object.keys(t.actions).forEach((e=>{f(t.actions[e],e,[...r])}))})),"Scope"===n&&e.actions&&Object.keys(e.actions).forEach((t=>{f(e.actions[t],t,[...r])})),"Foreach"!==n&&"Until"!==n||r.pop()}}return Object.keys(u).forEach((e=>{f(u[e],e,[])})),{patternID:r,patternName:i,description:o,status:0===p.length?"Pass":"Fail",instanceValue:p,failureReason:p.length>0?"Nested loops detected.":"",recommendation:s,docLinks:a,severity:l,category:c}},t.patternCheckConcurrencySettings=function(e){var t,{patternID:r,patternName:i,description:o,docLink:a,recommendation:s,severity:l,category:c}=n.FlowPatternDetails.Concurrency,u=[];return function e(t){t&&"object"==typeof t&&Object.keys(t).forEach((r=>{var n,i=t[r];"Foreach"!==i.type||null!==(n=i.runtimeConfiguration)&&void 0!==n&&null!==(n=n.concurrency)&&void 0!==n&&n.repetitions||u.push(r),"If"===i.type?(i.actions&&e(i.actions),i.else&&i.else.actions&&e(i.else.actions)):"Switch"===i.type&&i.cases?Object.values(i.cases).forEach((t=>{t.actions&&e(t.actions)})):("Until"===i.type&&i.actions||"Scope"===i.type&&i.actions||i.actions)&&e(i.actions)}))}((null==e||null===(t=e.properties)||void 0===t||null===(t=t.definition)||void 0===t?void 0:t.actions)||{}),{patternID:r,patternName:i,description:o,status:0===u.length?"Pass":"Fail",instanceValue:u,failureReason:u.length>0?"Concurrency settings missing.":"",recommendation:s,docLinks:a,severity:l,category:c}},t.patternCheckTriggerCondition=function(e){var t,{patternID:r,patternName:i,description:o,docLink:a,recommendation:s,severity:l,category:c}=n.FlowPatternDetails.TriggerCondition,u=(null==e||null===(t=e.properties)||void 0===t||null===(t=t.definition)||void 0===t?void 0:t.triggers)||{},p=[];return Object.keys(u).forEach((e=>{var t=u[e];"Recurrence"===t.type||"Request"===t.type||t.conditions&&0!==t.conditions.length||p.push(e)})),{patternID:r,patternName:i,description:o,status:0===p.length?"Pass":"Fail",instanceValue:p,failureReason:p.length>0?"Missing trigger conditions to avoid unnecessary flow executions.":"",recommendation:s,docLinks:a,severity:l,category:c}},t.patternCheckMultipleInitializeVariable=function(e){var{patternID:t,patternName:r,description:i,docLink:o,recommendation:a,severity:s,category:l}=n.FlowPatternDetails.MultipleInitializeVariableActions,c=0;!function e(t){if(t&&"object"==typeof t&&("InitializeVariable"===t.type&&(c+=1),t.actions))for(var r in t.actions)e(t.actions[r])}(e.properties.definition);var u=c>1;return{patternID:t,patternName:r,description:i,status:u?"Fail":"Pass",instanceValue:u?["InitializeVariable actions count: ".concat(c)]:[],failureReason:u?"More than one 'InitializeVariable' action detected.":"",recommendation:a,docLinks:o,severity:s,category:l}},t.patternCheckStaticVariables=function(e){var{patternID:t,patternName:r,description:i,docLink:o,recommendation:a,severity:s,category:l}=n.FlowPatternDetails.StaticVariables,c=new Set,u=new Set,p=[];(function e(t){if(t&&"object"==typeof t){if(t.type)if("InitializeVariable"===t.type){var r,n=null===(r=t.inputs)||void 0===r||null===(r=r.variables)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.name;n&&c.add(n)}else if("SetVariable"===t.type||"IncrementVariable"===t.type||"DecrementVariable"===t.type||"AppendToStringVariable"===t.type||"AppendToArrayVariable"===t.type){var i,o=null===(i=t.inputs)||void 0===i?void 0:i.name;o&&u.add(o)}if(t.actions)for(var a in t.actions)e(t.actions[a]);for(var s in t)"actions"!==s&&t.hasOwnProperty(s)&&e(t[s])}})(e.properties.definition),c.forEach((e=>{u.has(e)||p.push(e)}));var d=p.length>0;return{patternID:t,patternName:r,description:i,status:d?"Fail":"Pass",instanceValue:p,failureReason:d?"Variables initialized but never updated detected. Use ":"",recommendation:a,docLinks:o,severity:s,category:l}},t.patternCheckPowerAppResponse=function(e){var{patternID:t,patternName:r,description:i,docLink:o,recommendation:a,severity:s,category:l}=n.FlowPatternDetails.PowerAppResponse,c=!1;return function e(t){if(t&&"object"==typeof t){if("Response"!==t.type||"PowerApp"!==t.kind&&"Http"!==t.kind||t.operationOptions||(c=!0),t.actions)for(var r in t.actions)e(t.actions[r]);for(var n in t)"actions"!==n&&t.hasOwnProperty(n)&&e(t[n])}}(e.properties.definition),{patternID:t,patternName:r,description:i,status:c?"Fail":"Pass",instanceValue:c?["PowerApp response action found"]:[],failureReason:c?"Warning: Logic may fail if the response is not sent within 120 seconds.":"",recommendation:a,docLinks:o,severity:s,category:l}},t.patternCheckScopeUsage=function(e){var{patternID:t,patternName:r,description:i,docLink:o,recommendation:a,severity:s,category:l}=n.FlowPatternDetails.ScopeUsage,c=!1,u=function e(t){var r=0;return t&&"object"==typeof t?(t.hasOwnProperty("actions")&&"object"==typeof t.actions&&(r+=Object.keys(t.actions).length),"Scope"===t.type&&(c=!0),Object.values(t).forEach((t=>{("object"==typeof t||Array.isArray(t))&&(r+=e(t))}))):Array.isArray(t)&&t.forEach((t=>{r+=e(t)})),r}(e),p=u>10&&!c;return{patternID:t,patternName:r,description:i,status:p?"Fail":"Pass",instanceValue:p?["Action count: ".concat(u)]:[],failureReason:p?"Use Scopes to group actions and implement error handling (with Run After conditions) to handle failures gracefully.":"",recommendation:a,docLinks:o,severity:s,category:l}},t.patternCheckDataRetrievalParameters=function(e){var t,{patternID:r,patternName:i,description:o,docLink:a,recommendation:s,severity:l,category:c}=n.FlowPatternDetails.DataRetrievalParameters,u=[],p=new Set;!function e(t){t&&"object"==typeof t&&Object.keys(t).forEach((r=>{var n=t[r];if(!p.has(r)){if(p.add(r),"OpenApiConnection"===n.type){var i=n.inputs;if(i&&i.host&&i.parameters){var o=i.host.operationId,a=i.host.apiId||"";if("GetItems"===o&&a.includes("sharepoint")){var s=i.parameters,l=s.hasOwnProperty("$filter"),c=s.hasOwnProperty("$top");l&&c||u.push("Action '".concat(r,"' (SharePoint GetItems) is missing '").concat(l?"":"$filter").concat(l||c?"":" and ").concat(c?"":"$top","'."))}else if("GetItem"===o&&a.includes("commondataservice"))i.parameters.hasOwnProperty("$select")||u.push("Action '".concat(r,"' (CDS GetItem) is missing '$select'."));else if("ListRecords"===o&&a.includes("commondataservice")){var d=i.parameters,f=[];if(d.hasOwnProperty("$select")||f.push("$select"),d.hasOwnProperty("$filter")||f.push("$filter"),d.hasOwnProperty("$top")||f.push("$top"),f.length>0){var h=1===(m=f).length?m[0]:2===m.length?"".concat(m[0]," and ").concat(m[1]):"".concat(m.slice(0,-1).join(", "),", and ").concat(m[m.length-1]);u.push("Action '".concat(r,"' (CDS ListRecords) is missing '").concat(h,"'."))}}}}var m;n.actions&&e(n.actions),"If"===n.type&&(n.actions&&e(n.actions),n.else&&n.else.actions&&e(n.else.actions)),"Switch"===n.type&&n.cases&&Object.values(n.cases).forEach((t=>{t.actions&&e(t.actions)})),"Foreach"!==n.type&&"Until"!==n.type||!n.actions||e(n.actions)}}))}((null==e||null===(t=e.properties)||void 0===t||null===(t=t.definition)||void 0===t?void 0:t.actions)||{});var d=u.length>0;return{patternID:r,patternName:i,description:o,status:d?"Fail":"Pass",instanceValue:u,failureReason:d?"Missing recommended parameters in data retrieval actions.":"",recommendation:s,docLinks:a,severity:l,category:c}},t.patternCheckForActionNote=function(e){var t,{patternID:r,patternName:i,description:o,docLink:a,recommendation:s,severity:l,category:c}=n.FlowPatternDetails.ActionNote,u=[];!function e(t){t&&"object"==typeof t&&Object.keys(t).forEach((r=>{var n,i=t[r];i.description&&""!==i.description.trim()||u.push(r),i.actions&&e(i.actions),"If"===i.type&&(i.actions&&e(i.actions),null!==(n=i.else)&&void 0!==n&&n.actions&&e(i.else.actions)),"Switch"===i.type&&i.cases&&Object.values(i.cases).forEach((t=>{t.actions&&e(t.actions)})),"Foreach"!==i.type&&"Until"!==i.type||!i.actions||e(i.actions)}))}((null==e||null===(t=e.properties)||void 0===t||null===(t=t.definition)||void 0===t?void 0:t.actions)||{});var p=u.length>0;return{patternID:r,patternName:i,description:o,status:p?"Warning":"Pass",instanceValue:u,failureReason:p?"Actions missing notes.":"",recommendation:s,docLinks:a,severity:l,category:c}},t.patternCheckCreateUpdateInsideLoop=function(e){var t,{patternID:r,patternName:i,description:o,docLink:a,recommendation:s,severity:l,category:c}=n.FlowPatternDetails.CreateUpdateInsideLoop,u=new Set,p=["CreateRecord","CreateRecordWithOrganization","UpdateOnlyRecord","UpdateOnlyRecordWithOrganization","UpdateRecord","UpdateRecordWithOrganization","DeleteRecord","DeleteRecordWithOrganization"],d=["CreateFile","PostItem","DeleteFile","DeleteItem","UpdateFile","PatchItem"];!function e(t,r){t&&"object"==typeof t&&Object.keys(t).forEach((n=>{var i,o,a,s=t[n],l=null===(i=s.inputs)||void 0===i||null===(i=i.host)||void 0===i?void 0:i.operationId,c=null===(o=s.inputs)||void 0===o||null===(o=o.host)||void 0===o?void 0:o.apiId;r&&"OpenApiConnection"===s.type&&(null!=c&&c.includes("commondataservice")&&p.includes(l)||null!=c&&c.includes("sharepoint")&&d.includes(l))&&u.add(n),"Foreach"!==s.type&&"Until"!==s.type||e(s.actions,!0),s.actions&&e(s.actions,r),"If"===s.type&&(s.actions&&e(s.actions,r),null!==(a=s.else)&&void 0!==a&&a.actions&&e(s.else.actions,r)),"Switch"===s.type&&s.cases&&Object.values(s.cases).forEach((t=>{t.actions&&e(t.actions,r)}))}))}((null==e||null===(t=e.properties)||void 0===t||null===(t=t.definition)||void 0===t?void 0:t.actions)||{},!1);var f=u.size>0;return{patternID:r,patternName:i,description:o,status:f?"Fail":"Pass",instanceValue:Array.from(u),failureReason:f?"Create/Update actions found inside loops.":"",recommendation:s,docLinks:a,severity:l,category:c}};var n=r(7985),i=r(9257)},1376:function(e,t,r){"use strict";function n(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,l,"next",e)}function l(e){n(a,i,o,s,l,"throw",e)}s(void 0)}))}}var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.singleCollectCollections=t.singleSetVariables=void 0,t.patternCheckMediaFileSize=function(e){return c.apply(this,arguments)},t.patternCheckUnusedMediaResources=function(e){return u.apply(this,arguments)},t.patternCheckDelayLoading=function(e){return p.apply(this,arguments)},t.patternCheckAppSettings=function(e){return d.apply(this,arguments)},t.patternCheckAppCheckerAccessibilityIssues=function(e){return f.apply(this,arguments)},t.patternCheckUnusedElements=function(e){return h.apply(this,arguments)},t.patternCheckForNamedFormulas=function(e,r,n,i,o){if(e&&"string"==typeof e){for(var s,c=(0,l.removeComments)(e);null!==(s=m.exec(c));){var u=s[1],p=s.index+s[0].indexOf("("),{endIndex:d}=(0,l.findMatchingParenthesis)(c,p),f=-1!==d?c.substring(s.index,d+1):s[0];v.has(u)||(t.singleSetVariables[u]?(delete t.singleSetVariables[u],v.add(u)):t.singleSetVariables[u]={ScreenName:r,ControlName:n||r.replace(/ /g,"")+"Properties",PropertyName:i,Code:c,PatternName:a.PowerAppsPatternInfo.NamedFormulas,FailureReason:"",ControlType:o,FailedPowerFxCode:f})}for(;null!==(s=g.exec(c));){var h=s[1],w=s.index+s[0].indexOf("("),{endIndex:E}=(0,l.findMatchingParenthesis)(c,w),N=-1!==E?c.substring(s.index,E+1):s[0];b.has(h)||(t.singleCollectCollections[h]?(delete t.singleCollectCollections[h],b.add(h)):t.singleCollectCollections[h]={ScreenName:r,ControlName:n||r.replace(/ /g,"")+"Properties",PropertyName:i,Code:c,PatternName:a.PowerAppsPatternInfo.NamedFormulas,FailureReason:"",ControlType:o,FailedPowerFxCode:N})}for(;null!==(s=y.exec(c));){var A=s[1];t.singleCollectCollections[A]&&delete t.singleCollectCollections[A],b.add(A)}}},t.patternCheckForUxLayout=function(e,t,r){try{t[Object.keys(t)[0]].Control.startsWith("GroupContainer")||r.push({ScreenName:e,ControlName:"",PropertyName:"",Code:"",PatternName:a.PowerAppsPatternInfo.UxLayout,FailureReason:"Use Containers to build responsive apps."})}catch(e){e instanceof Error?s.default.error("Error processing pattern: ".concat(e.message)):s.default.error("Unknown error processing pattern")}},t.patternCheckForCodeReadability=function(e,t,r,n,i,o){var s=t,c=(0,l.removeComments)(t);if("string"==typeof c){s.length===c.length&&c.length>1e3&&r.push({ScreenName:n,ControlName:i||n.replace(/ /g,"")+"Properties",PropertyName:e,Code:c,PatternName:a.PowerAppsPatternInfo.CodeReadability,FailureReason:"Code length exceeds 1000 characters without any comments.",ControlType:o,FailedPowerFxCode:c});var u=(0,l.containsNestedIf)(c);u&&r.push({ScreenName:n,ControlName:i||n.replace(/ /g,"")+"Properties",PropertyName:e,Code:c,PatternName:a.PowerAppsPatternInfo.CodeReadability,FailureReason:"Nested If statements detected.",ControlType:o,FailedPowerFxCode:u})}},t.patternCheckForNestedAPICalls=function(e,t,r,n,i,o,s,c){var u=(0,l.removeComments)(t);if("string"==typeof u){var p=(0,l.findAPIFunctionOccurrences)(u);for(var d of p){var f=d.content,h=(0,l.findAPIFunctionOccurrences)(f);for(var m of h){var g=(0,l.getFirstParameter)(m.content),y=(0,l.normalizeDataSourceName)(g);if(s.includes(y.toLowerCase())||y.toLowerCase().includes("office365users")&&s.includes("office365users")){r.push({ScreenName:n,ControlName:i||n.replace(/ /g,"")+"Properties",PropertyName:e,Code:u,PatternName:a.PowerAppsPatternInfo.NestedAPICalls,ControlType:c,FailedPowerFxCode:m.functionName+"("+m.content+")",FailureReason:"Filter/Search/ForAll/LookUp/Patch function with external API call detected inside another Filter/Search/ForAll/LookUp/Patch function."});break}}}}},t.patternCheckForErrorHandling=function(e,t,r,n,i,o,s,c){var u=(0,l.removeComments)(t);if("string"==typeof u){var p=(0,l.findPatchOccurrences)(u);for(var d of p){var f=(0,l.getNthArgument)(d.content,1);if(f){var h=(0,l.normalizeDataSourceName)(f);(s.includes(h.toLowerCase())||h.toLowerCase().includes("office365users")&&s.includes("office365users"))&&((0,l.isFunctionWrapped)(u,d.startIndex-1,["IfError","IsError"])||r.push({ScreenName:n,ControlName:i||n.replace(/ /g,"")+"Properties",PropertyName:e,Code:u,PatternName:a.PowerAppsPatternInfo.ErrorHandling,ControlType:c,FailedPowerFxCode:d.functionName+"("+d.content+")",FailureReason:"Patch function with external API call detected without error handling with IfError/IsError function."}))}}}},t.patternCheckForNPlusOneQuery=function(e,t,r,n,i,o,s,c){var u=(0,l.removeComments)(t);if("string"==typeof t)for(var p of a.QueryFunctions)for(var d=new RegExp("".concat(p,"\\(([^)]+)\\)"),"gi"),f=void 0;null!==(f=d.exec(u));){var h=f[1],m=(0,l.normalizeDataSourceName)(h.split(",")[0].trim());(s.includes(m.toLowerCase())||m.toLowerCase().includes("office365users")&&s.includes("office365users"))&&r.push({ScreenName:n,ControlName:i||n.replace(/ /g,"")+"Properties",PropertyName:e,Code:u,PatternName:a.PowerAppsPatternInfo.NPlusOne,ControlType:c,FailedPowerFxCode:f[0],FailureReason:"Filter/LookUp/Search/CountRows/ForAll/Patch function with external API call detected inside a Gallery child control."})}},t.patternCheckForInefficientDataRetrieval=function(e,t,r,n,i,o,s,c){var u=(0,l.removeComments)(t);if("string"==typeof u){var p=(0,l.findFirstLastOccurrences)(u);for(var d of p){var f=d.content,h=(0,l.findFilterSearchOccurrences)(f);for(var m of h){var g=(0,l.getFirstParameter)(m.content),y=(0,l.normalizeDataSourceName)(g);(s.includes(y.toLowerCase())||y.toLowerCase().includes("office365users")&&s.includes("office365users"))&&r.push({ScreenName:n,ControlName:i||n.replace(/ /g,"")+"Properties",PropertyName:e,Code:u,PatternName:a.PowerAppsPatternInfo.InefficientDataRetrieval,ControlType:c,FailedPowerFxCode:m.functionName+"("+m.content+")",FailureReason:"Filter/Search function with external API call detected inside First/Last function."})}}}},t.patternCheckForNestedFilters=function(e,t,r,n,i,o,s,c){var u=(0,l.removeComments)(t);if("string"==typeof u){var p=(0,l.findFilterSearchOccurrences)(u);for(var d of p){var f=d.content,h=(0,l.findFilterSearchLookUpOccurrences)(f);for(var m of h){var g=(0,l.getFirstParameter)(m.content),y=(0,l.normalizeDataSourceName)(g);(s.includes(y.toLowerCase())||y.toLowerCase().includes("office365users")&&s.includes("office365users"))&&r.push({ScreenName:n,ControlName:i||n.replace(/ /g,"")+"Properties",PropertyName:e,Code:u,PatternName:a.PowerAppsPatternInfo.NestedFilters,ControlType:c,FailedPowerFxCode:m.functionName+"("+m.content+")",FailureReason:"Nested Filter/Search/LookUp function with external API call detected inside Filter/Search function."})}}}},t.patternCheckForPatchFormulaOptimization=function(e,t,r,n,i,o,s,c){var u=(0,l.removeComments)(t);if("string"==typeof u){var p=(0,l.findPatchOccurrences)(u);for(var d of p){var f=(0,l.getNthArgument)(d.content,2);if(f){var h=(0,l.findFilterSearchLookUpOccurrences)(f);for(var m of h){var g=(0,l.getFirstParameter)(m.content),y=(0,l.normalizeDataSourceName)(g);(s.includes(y.toLowerCase())||y.toLowerCase().includes("office365users")&&s.includes("office365users"))&&r.push({ScreenName:n,ControlName:i||n.replace(/ /g,"")+"Properties",PropertyName:e,Code:u,PatternName:a.PowerAppsPatternInfo.PatchFormulaOptimization,ControlType:c,FailedPowerFxCode:m.functionName+"("+m.content+")",FailureReason:"Filter/Search/LookUp function with external API call detected inside Patch function."})}}}}};var a=r(7985),s=o(r(5525)),l=r(9734);function c(){return(c=i((function*(e){var t=a.PowerAppsPatternDetails[a.PowerAppsPatternInfo.MediaFileSize],r=!0,n="",i=e.assets;if(i.length>0){var o=[];i.forEach((e=>{e.exceedsThreshold&&(r=!1,o.push(e.mediaName))})),o.length>0&&(t.recommendation,o.join(", "),n+="Following files are exceeding 300KB file size: "+o.join(", ")+". ")}return{patternID:t.patternID,patternName:t.patternName,description:t.description,status:r?"Pass":"Fail",instanceValue:[],failureReason:r?"":n,recommendation:t.recommendation,docLinks:t.docLinks,severity:t.severity,category:t.category}}))).apply(this,arguments)}function u(){return(u=i((function*(e){var t=a.PowerAppsPatternDetails[a.PowerAppsPatternInfo.UnusedMediaResources],r=!0,n="",i=e.appCheckerIssues.filter((e=>"app-UnusedMediaResources"===e.RuleId));if(i.length>0){r=!1;var o=i.map((e=>e.Location)).join(", ");n="The following media resources are unused: ".concat(o,"."),"Remove or reference these unused media resources to optimize performance: ".concat(o,".")}return{patternID:t.patternID,patternName:t.patternName,description:t.description,status:r?"Pass":"Fail",instanceValue:[],failureReason:r?"":n,recommendation:t.recommendation,docLinks:t.docLinks,severity:t.severity,category:t.category}}))).apply(this,arguments)}function p(){return(p=i((function*(e){var t=a.PowerAppsPatternDetails[a.PowerAppsPatternInfo.InefficientDelayLoading],r=!0,n="",i=e.appCheckerIssues.filter((e=>"app-InefficientDelayLoading"===e.RuleId));if(i.length>0){r=!1;var o=i.map((e=>e.Location)).join(", ");n="Following locations contain control references from other screens : ".concat(o,"."),"Referencing controls from other screens can impact app performance by slowing down loading and navigation. Use variables, collections, and navigation context to share state across screens. Remove other screen control references from following locations: ".concat(o,".")}return{patternID:t.patternID,patternName:t.patternName,description:t.description,status:r?"Pass":"Fail",instanceValue:[],failureReason:r?"":n,recommendation:t.recommendation,docLinks:t.docLinks,severity:t.severity,category:t.category}}))).apply(this,arguments)}function d(){return(d=i((function*(e){var t,r=a.PowerAppsPatternDetails[a.PowerAppsPatternInfo.AppSettings],n=!0,i="",o=(null===(t=e.appSettings)||void 0===t?void 0:t.AppPreviewFlagsMap)||{},s=[];for(var l of a.AppSettingsList)!1===o[l]&&s.push(l);return s.length>0&&(n=!1,r.recommendation," ".concat(s.join(", "),"."),i="Following settings are turned off: ".concat(s.join(", "),".")),{patternID:r.patternID,patternName:r.patternName,description:r.description,status:n?"Pass":"Fail",instanceValue:[],failureReason:n?"":i,recommendation:r.recommendation,docLinks:r.docLinks,severity:r.severity,category:r.category}}))).apply(this,arguments)}function f(){return(f=i((function*(e){var t=a.PowerAppsPatternDetails[a.PowerAppsPatternInfo.AppCheckerAccessibilityIssues],r=!0,n="Errors or warnings from App Checker Results: ",i=new Set;return e.appCheckerIssues.forEach((e=>{"accessibility"===e.Category&&i.add(e.RuleId)})),i.size>0&&(r=!1,n=n.concat(" ",Array.from(i).join(", "))),{patternID:t.patternID,patternName:t.patternName,description:t.description,status:r?"Pass":"Fail",instanceValue:[],failureReason:r?"":n,recommendation:t.recommendation,docLinks:t.docLinks,severity:t.severity,category:t.category}}))).apply(this,arguments)}function h(){return(h=i((function*(e){var t=a.PowerAppsPatternDetails[a.PowerAppsPatternInfo.UnusedElements],r=!0,n="Errors or warnings from App Checker Results: ",i=new Set,o=[];if(e.appCheckerIssues.forEach((e=>{a.RelevantRuleIdsForUnusedElements.includes(e.RuleId)&&(i.add(e.RuleId),o.push(e.Location))})),i.size>0&&(r=!1,n=n.concat(" "+Array.from(i).join(", "))),o.length>0){var s=o.join(", ");n+=" The following variables are unused: ".concat(s,"."),"Remove or reference these unused variables: ".concat(s,".")}return{patternID:t.patternID,patternName:t.patternName,description:t.description,status:r?"Pass":"Fail",instanceValue:[],failureReason:r?"":n,recommendation:t.recommendation,docLinks:t.docLinks,severity:t.severity,category:t.category}}))).apply(this,arguments)}var m=/\bSet\s*\(\s*([A-Za-z0-9_]+)\s*,/gi,g=/\b(?:Collect|ClearCollect)\s*\(\s*([A-Za-z0-9_]+)\s*,/gi,y=/\bPatch\s*\(\s*([A-Za-z0-9_]+)\s*,/gi;t.singleSetVariables={},t.singleCollectCollections={};var v=new Set,b=new Set},1485:(e,t,r)=>{"use strict";var n=r(4818),i=r(5696);function o(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}e.exports.Type=r(9113),e.exports.Schema=r(1602),e.exports.FAILSAFE_SCHEMA=r(332),e.exports.JSON_SCHEMA=r(7379),e.exports.CORE_SCHEMA=r(7414),e.exports.DEFAULT_SCHEMA=r(276),e.exports.load=n.load,e.exports.loadAll=n.loadAll,e.exports.dump=i.dump,e.exports.YAMLException=r(6116),e.exports.types={binary:r(5265),float:r(2332),map:r(1096),null:r(5809),pairs:r(6599),set:r(6402),timestamp:r(4858),bool:r(2220),int:r(6379),merge:r(9650),omap:r(4573),seq:r(5693),str:r(2461)},e.exports.safeLoad=o("safeLoad","load"),e.exports.safeLoadAll=o("safeLoadAll","loadAll"),e.exports.safeDump=o("safeDump","dump")},1602:(e,t,r)=>{"use strict";var n=r(6116),i=r(9113);function o(e,t){var r=[];return e[t].forEach((function(e){var t=r.length;r.forEach((function(r,n){r.tag===e.tag&&r.kind===e.kind&&r.multi===e.multi&&(t=n)})),r[t]=e})),r}function a(e){return this.extend(e)}a.prototype.extend=function(e){var t=[],r=[];if(e instanceof i)r.push(e);else if(Array.isArray(e))r=r.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new n("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(r=r.concat(e.explicit))}t.forEach((function(e){if(!(e instanceof i))throw new n("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new n("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new n("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")})),r.forEach((function(e){if(!(e instanceof i))throw new n("Specified list of YAML types (or a single Type object) contains a non-Type object.")}));var s=Object.create(a.prototype);return s.implicit=(this.implicit||[]).concat(t),s.explicit=(this.explicit||[]).concat(r),s.compiledImplicit=o(s,"implicit"),s.compiledExplicit=o(s,"explicit"),s.compiledTypeMap=function(){var e,t,r={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function n(e){e.multi?(r.multi[e.kind].push(e),r.multi.fallback.push(e)):r[e.kind][e.tag]=r.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(n);return r}(s.compiledImplicit,s.compiledExplicit),s},e.exports=a},1630:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.typeMap=void 0,t.typeMap={1:"Entity",2:"Attribute",3:"Relationship",4:"Attribute Picklist Value",5:"Attribute Lookup Value",6:"View Attribute",7:"Localized Label",8:"Relationship Extra Condition",9:"Option Set",10:"Entity Relationship",11:"Entity Relationship Role",12:"Entity Relationship Relationships",13:"Managed Property",14:"Entity Key",16:"Privilege",17:"PrivilegeObjectTypeCode",18:"Index",20:"Role",21:"Role Privilege",22:"Display String",23:"Display String Map",24:"Form",25:"Organization",26:"Saved Query",29:"Workflow",31:"Report",32:"Report Entity",33:"Report Category",34:"Report Visibility",35:"Attachment",36:"Email Template",37:"Contract Template",38:"KB Article Template",39:"Mail Merge Template",44:"Duplicate Rule",45:"Duplicate Rule Condition",46:"Entity Map",47:"Attribute Map",48:"Ribbon Command",49:"Ribbon Context Group",50:"Ribbon Customization",52:"Ribbon Rule",53:"Ribbon Tab To Command Map",55:"Ribbon Diff",59:"Saved Query Visualization",60:"System Form",61:"Web Resource",62:"Site Map",63:"Connection Role",64:"Complex Control",65:"Hierarchy Rule",66:"Custom Control",68:"Custom Control Default Config",70:"Field Security Profile",71:"Field Permission",90:"Plugin Type",91:"Plugin Assembly",92:"SDK Message Processing Step",93:"SDK Message Processing Step Image",95:"Service Endpoint",150:"Routing Rule",151:"Routing Rule Item",152:"SLA",153:"SLA Item",154:"Convert Rule",155:"Convert Rule Item",161:"Mobile Offline Profile",162:"Mobile Offline Profile Item",165:"Similarity Rule",166:"Data Source Mapping",201:"SDKMessage",202:"SDKMessageFilter",203:"SdkMessagePair",204:"SdkMessageRequest",205:"SdkMessageRequestField",206:"SdkMessageResponse",207:"SdkMessageResponseField",208:"Import Map",210:"WebWizard",300:"Canvas App",371:"Connector",372:"Connector",380:"Environment Variable Definition",381:"Environment Variable Value",400:"AI Project Type",401:"AI Project",402:"AI Configuration",430:"Entity Analytics Configuration",431:"Attribute Image Configuration",432:"Entity Image Configuration"}},1880:e=>{"use strict";function t(e){try{return JSON.stringify(e)}catch(e){return'"[Circular]"'}}e.exports=function(e,r,n){var i=n&&n.stringify||t;if("object"==typeof e&&null!==e){var o=r.length+1;if(1===o)return e;var a=new Array(o);a[0]=i(e);for(var s=1;s<o;s++)a[s]=i(r[s]);return a.join(" ")}if("string"!=typeof e)return e;var l=r.length;if(0===l)return e;for(var c="",u=0,p=-1,d=e&&e.length||0,f=0;f<d;){if(37===e.charCodeAt(f)&&f+1<d){switch(p=p>-1?p:0,e.charCodeAt(f+1)){case 100:case 102:if(u>=l)break;if(null==r[u])break;p<f&&(c+=e.slice(p,f)),c+=Number(r[u]),p=f+2,f++;break;case 105:if(u>=l)break;if(null==r[u])break;p<f&&(c+=e.slice(p,f)),c+=Math.floor(Number(r[u])),p=f+2,f++;break;case 79:case 111:case 106:if(u>=l)break;if(void 0===r[u])break;p<f&&(c+=e.slice(p,f));var h=typeof r[u];if("string"===h){c+="'"+r[u]+"'",p=f+2,f++;break}if("function"===h){c+=r[u].name||"<anonymous>",p=f+2,f++;break}c+=i(r[u]),p=f+2,f++;break;case 115:if(u>=l)break;p<f&&(c+=e.slice(p,f)),c+=String(r[u]),p=f+2,f++;break;case 37:p<f&&(c+=e.slice(p,f)),c+="%",p=f+2,f++,u--}++u}++f}return-1===p?e:(p<d&&(c+=e.slice(p)),c)}},2112:(e,t,r)=>{"use strict";var n=r(3715).freeze;t.XML_ENTITIES=n({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=n({Aacute:"Á",aacute:"á",Abreve:"Ă",abreve:"ă",ac:"∾",acd:"∿",acE:"∾̳",Acirc:"Â",acirc:"â",acute:"´",Acy:"А",acy:"а",AElig:"Æ",aelig:"æ",af:"⁡",Afr:"𝔄",afr:"𝔞",Agrave:"À",agrave:"à",alefsym:"ℵ",aleph:"ℵ",Alpha:"Α",alpha:"α",Amacr:"Ā",amacr:"ā",amalg:"⨿",AMP:"&",amp:"&",And:"⩓",and:"∧",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",Aogon:"Ą",aogon:"ą",Aopf:"𝔸",aopf:"𝕒",ap:"≈",apacir:"⩯",apE:"⩰",ape:"≊",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",Aring:"Å",aring:"å",Ascr:"𝒜",ascr:"𝒶",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",Atilde:"Ã",atilde:"ã",Auml:"Ä",auml:"ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",Barwed:"⌆",barwed:"⌅",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",Bcy:"Б",bcy:"б",bdquo:"„",becaus:"∵",Because:"∵",because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",Beta:"Β",beta:"β",beth:"ℶ",between:"≬",Bfr:"𝔅",bfr:"𝔟",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bNot:"⫭",bnot:"⌐",Bopf:"𝔹",bopf:"𝕓",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxDL:"╗",boxDl:"╖",boxdL:"╕",boxdl:"┐",boxDR:"╔",boxDr:"╓",boxdR:"╒",boxdr:"┌",boxH:"═",boxh:"─",boxHD:"╦",boxHd:"╤",boxhD:"╥",boxhd:"┬",boxHU:"╩",boxHu:"╧",boxhU:"╨",boxhu:"┴",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxUL:"╝",boxUl:"╜",boxuL:"╛",boxul:"┘",boxUR:"╚",boxUr:"╙",boxuR:"╘",boxur:"└",boxV:"║",boxv:"│",boxVH:"╬",boxVh:"╫",boxvH:"╪",boxvh:"┼",boxVL:"╣",boxVl:"╢",boxvL:"╡",boxvl:"┤",boxVR:"╠",boxVr:"╟",boxvR:"╞",boxvr:"├",bprime:"‵",Breve:"˘",breve:"˘",brvbar:"¦",Bscr:"ℬ",bscr:"𝒷",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpE:"⪮",bumpe:"≏",Bumpeq:"≎",bumpeq:"≏",Cacute:"Ć",cacute:"ć",Cap:"⋒",cap:"∩",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",Ccaron:"Č",ccaron:"č",Ccedil:"Ç",ccedil:"ç",Ccirc:"Ĉ",ccirc:"ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",Cdot:"Ċ",cdot:"ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",CenterDot:"·",centerdot:"·",Cfr:"ℭ",cfr:"𝔠",CHcy:"Ч",chcy:"ч",check:"✓",checkmark:"✓",Chi:"Χ",chi:"χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cirE:"⧃",cire:"≗",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",Colon:"∷",colon:":",Colone:"⩴",colone:"≔",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",Conint:"∯",conint:"∮",ContourIntegral:"∮",Copf:"ℂ",copf:"𝕔",coprod:"∐",Coproduct:"∐",COPY:"©",copy:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",Cross:"⨯",cross:"✗",Cscr:"𝒞",cscr:"𝒸",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",Cup:"⋓",cup:"∪",cupbrcap:"⩈",CupCap:"≍",cupcap:"⩆",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",Dagger:"‡",dagger:"†",daleth:"ℸ",Darr:"↡",dArr:"⇓",darr:"↓",dash:"‐",Dashv:"⫤",dashv:"⊣",dbkarow:"⤏",dblac:"˝",Dcaron:"Ď",dcaron:"ď",Dcy:"Д",dcy:"д",DD:"ⅅ",dd:"ⅆ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",Delta:"Δ",delta:"δ",demptyv:"⦱",dfisht:"⥿",Dfr:"𝔇",dfr:"𝔡",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",Diamond:"⋄",diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",DJcy:"Ђ",djcy:"ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",Dopf:"𝔻",dopf:"𝕕",Dot:"¨",dot:"˙",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",DownArrow:"↓",Downarrow:"⇓",downarrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",Dscr:"𝒟",dscr:"𝒹",DScy:"Ѕ",dscy:"ѕ",dsol:"⧶",Dstrok:"Đ",dstrok:"đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",DZcy:"Џ",dzcy:"џ",dzigrarr:"⟿",Eacute:"É",eacute:"é",easter:"⩮",Ecaron:"Ě",ecaron:"ě",ecir:"≖",Ecirc:"Ê",ecirc:"ê",ecolon:"≕",Ecy:"Э",ecy:"э",eDDot:"⩷",Edot:"Ė",eDot:"≑",edot:"ė",ee:"ⅇ",efDot:"≒",Efr:"𝔈",efr:"𝔢",eg:"⪚",Egrave:"È",egrave:"è",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",Emacr:"Ē",emacr:"ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",ENG:"Ŋ",eng:"ŋ",ensp:" ",Eogon:"Ę",eogon:"ę",Eopf:"𝔼",eopf:"𝕖",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",Epsilon:"Ε",epsilon:"ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",Escr:"ℰ",escr:"ℯ",esdot:"≐",Esim:"⩳",esim:"≂",Eta:"Η",eta:"η",ETH:"Ð",eth:"ð",Euml:"Ë",euml:"ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",ExponentialE:"ⅇ",exponentiale:"ⅇ",fallingdotseq:"≒",Fcy:"Ф",fcy:"ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",Ffr:"𝔉",ffr:"𝔣",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",Fopf:"𝔽",fopf:"𝕗",ForAll:"∀",forall:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",Fscr:"ℱ",fscr:"𝒻",gacute:"ǵ",Gamma:"Γ",gamma:"γ",Gammad:"Ϝ",gammad:"ϝ",gap:"⪆",Gbreve:"Ğ",gbreve:"ğ",Gcedil:"Ģ",Gcirc:"Ĝ",gcirc:"ĝ",Gcy:"Г",gcy:"г",Gdot:"Ġ",gdot:"ġ",gE:"≧",ge:"≥",gEl:"⪌",gel:"⋛",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",Gfr:"𝔊",gfr:"𝔤",Gg:"⋙",gg:"≫",ggg:"⋙",gimel:"ℷ",GJcy:"Ѓ",gjcy:"ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gnE:"≩",gne:"⪈",gneq:"⪈",gneqq:"≩",gnsim:"⋧",Gopf:"𝔾",gopf:"𝕘",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",Gscr:"𝒢",gscr:"ℊ",gsim:"≳",gsime:"⪎",gsiml:"⪐",Gt:"≫",GT:">",gt:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",HARDcy:"Ъ",hardcy:"ъ",hArr:"⇔",harr:"↔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",Hcirc:"Ĥ",hcirc:"ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",Hfr:"ℌ",hfr:"𝔥",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",Hopf:"ℍ",hopf:"𝕙",horbar:"―",HorizontalLine:"─",Hscr:"ℋ",hscr:"𝒽",hslash:"ℏ",Hstrok:"Ħ",hstrok:"ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",Iacute:"Í",iacute:"í",ic:"⁣",Icirc:"Î",icirc:"î",Icy:"И",icy:"и",Idot:"İ",IEcy:"Е",iecy:"е",iexcl:"¡",iff:"⇔",Ifr:"ℑ",ifr:"𝔦",Igrave:"Ì",igrave:"ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",IJlig:"Ĳ",ijlig:"ĳ",Im:"ℑ",Imacr:"Ī",imacr:"ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",Int:"∬",int:"∫",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",IOcy:"Ё",iocy:"ё",Iogon:"Į",iogon:"į",Iopf:"𝕀",iopf:"𝕚",Iota:"Ι",iota:"ι",iprod:"⨼",iquest:"¿",Iscr:"ℐ",iscr:"𝒾",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",Itilde:"Ĩ",itilde:"ĩ",Iukcy:"І",iukcy:"і",Iuml:"Ï",iuml:"ï",Jcirc:"Ĵ",jcirc:"ĵ",Jcy:"Й",jcy:"й",Jfr:"𝔍",jfr:"𝔧",jmath:"ȷ",Jopf:"𝕁",jopf:"𝕛",Jscr:"𝒥",jscr:"𝒿",Jsercy:"Ј",jsercy:"ј",Jukcy:"Є",jukcy:"є",Kappa:"Κ",kappa:"κ",kappav:"ϰ",Kcedil:"Ķ",kcedil:"ķ",Kcy:"К",kcy:"к",Kfr:"𝔎",kfr:"𝔨",kgreen:"ĸ",KHcy:"Х",khcy:"х",KJcy:"Ќ",kjcy:"ќ",Kopf:"𝕂",kopf:"𝕜",Kscr:"𝒦",kscr:"𝓀",lAarr:"⇚",Lacute:"Ĺ",lacute:"ĺ",laemptyv:"⦴",lagran:"ℒ",Lambda:"Λ",lambda:"λ",Lang:"⟪",lang:"⟨",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",Larr:"↞",lArr:"⇐",larr:"←",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",lAtail:"⤛",latail:"⤙",late:"⪭",lates:"⪭︀",lBarr:"⤎",lbarr:"⤌",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",Lcaron:"Ľ",lcaron:"ľ",Lcedil:"Ļ",lcedil:"ļ",lceil:"⌈",lcub:"{",Lcy:"Л",lcy:"л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",lE:"≦",le:"≤",LeftAngleBracket:"⟨",LeftArrow:"←",Leftarrow:"⇐",leftarrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",LeftRightArrow:"↔",Leftrightarrow:"⇔",leftrightarrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",lEg:"⪋",leg:"⋚",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",Lfr:"𝔏",lfr:"𝔩",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",LJcy:"Љ",ljcy:"љ",Ll:"⋘",ll:"≪",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",Lmidot:"Ŀ",lmidot:"ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lnE:"≨",lne:"⪇",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",LongLeftArrow:"⟵",Longleftarrow:"⟸",longleftarrow:"⟵",LongLeftRightArrow:"⟷",Longleftrightarrow:"⟺",longleftrightarrow:"⟷",longmapsto:"⟼",LongRightArrow:"⟶",Longrightarrow:"⟹",longrightarrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",Lopf:"𝕃",lopf:"𝕝",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",Lscr:"ℒ",lscr:"𝓁",Lsh:"↰",lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",Lstrok:"Ł",lstrok:"ł",Lt:"≪",LT:"<",lt:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",Map:"⤅",map:"↦",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",Mcy:"М",mcy:"м",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",Mfr:"𝔐",mfr:"𝔪",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",Mopf:"𝕄",mopf:"𝕞",mp:"∓",Mscr:"ℳ",mscr:"𝓂",mstpos:"∾",Mu:"Μ",mu:"μ",multimap:"⊸",mumap:"⊸",nabla:"∇",Nacute:"Ń",nacute:"ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",Ncaron:"Ň",ncaron:"ň",Ncedil:"Ņ",ncedil:"ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",Ncy:"Н",ncy:"н",ndash:"–",ne:"≠",nearhk:"⤤",neArr:"⇗",nearr:"↗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:"\n",nexist:"∄",nexists:"∄",Nfr:"𝔑",nfr:"𝔫",ngE:"≧̸",nge:"≱",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",nGt:"≫⃒",ngt:"≯",ngtr:"≯",nGtv:"≫̸",nhArr:"⇎",nharr:"↮",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",NJcy:"Њ",njcy:"њ",nlArr:"⇍",nlarr:"↚",nldr:"‥",nlE:"≦̸",nle:"≰",nLeftarrow:"⇍",nleftarrow:"↚",nLeftrightarrow:"⇎",nleftrightarrow:"↮",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nLt:"≪⃒",nlt:"≮",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",Nopf:"ℕ",nopf:"𝕟",Not:"⫬",not:"¬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrArr:"⇏",nrarr:"↛",nrarrc:"⤳̸",nrarrw:"↝̸",nRightarrow:"⇏",nrightarrow:"↛",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",Nscr:"𝒩",nscr:"𝓃",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsubE:"⫅̸",nsube:"⊈",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupE:"⫆̸",nsupe:"⊉",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",Ntilde:"Ñ",ntilde:"ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",Nu:"Ν",nu:"ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nVDash:"⊯",nVdash:"⊮",nvDash:"⊭",nvdash:"⊬",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwArr:"⇖",nwarr:"↖",nwarrow:"↖",nwnear:"⤧",Oacute:"Ó",oacute:"ó",oast:"⊛",ocir:"⊚",Ocirc:"Ô",ocirc:"ô",Ocy:"О",ocy:"о",odash:"⊝",Odblac:"Ő",odblac:"ő",odiv:"⨸",odot:"⊙",odsold:"⦼",OElig:"Œ",oelig:"œ",ofcir:"⦿",Ofr:"𝔒",ofr:"𝔬",ogon:"˛",Ograve:"Ò",ograve:"ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",Omacr:"Ō",omacr:"ō",Omega:"Ω",omega:"ω",Omicron:"Ο",omicron:"ο",omid:"⦶",ominus:"⊖",Oopf:"𝕆",oopf:"𝕠",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",Or:"⩔",or:"∨",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",Oscr:"𝒪",oscr:"ℴ",Oslash:"Ø",oslash:"ø",osol:"⊘",Otilde:"Õ",otilde:"õ",Otimes:"⨷",otimes:"⊗",otimesas:"⨶",Ouml:"Ö",ouml:"ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",Pcy:"П",pcy:"п",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",Pfr:"𝔓",pfr:"𝔭",Phi:"Φ",phi:"φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",Pi:"Π",pi:"π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",Popf:"ℙ",popf:"𝕡",pound:"£",Pr:"⪻",pr:"≺",prap:"⪷",prcue:"≼",prE:"⪳",pre:"⪯",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",Prime:"″",prime:"′",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",Pscr:"𝒫",pscr:"𝓅",Psi:"Ψ",psi:"ψ",puncsp:" ",Qfr:"𝔔",qfr:"𝔮",qint:"⨌",Qopf:"ℚ",qopf:"𝕢",qprime:"⁗",Qscr:"𝒬",qscr:"𝓆",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",QUOT:'"',quot:'"',rAarr:"⇛",race:"∽̱",Racute:"Ŕ",racute:"ŕ",radic:"√",raemptyv:"⦳",Rang:"⟫",rang:"⟩",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",Rarr:"↠",rArr:"⇒",rarr:"→",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",Rarrtl:"⤖",rarrtl:"↣",rarrw:"↝",rAtail:"⤜",ratail:"⤚",ratio:"∶",rationals:"ℚ",RBarr:"⤐",rBarr:"⤏",rbarr:"⤍",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",Rcaron:"Ř",rcaron:"ř",Rcedil:"Ŗ",rcedil:"ŗ",rceil:"⌉",rcub:"}",Rcy:"Р",rcy:"р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",REG:"®",reg:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",Rfr:"ℜ",rfr:"𝔯",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",Rho:"Ρ",rho:"ρ",rhov:"ϱ",RightAngleBracket:"⟩",RightArrow:"→",Rightarrow:"⇒",rightarrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",Ropf:"ℝ",ropf:"𝕣",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",Rscr:"ℛ",rscr:"𝓇",Rsh:"↱",rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",Sacute:"Ś",sacute:"ś",sbquo:"‚",Sc:"⪼",sc:"≻",scap:"⪸",Scaron:"Š",scaron:"š",sccue:"≽",scE:"⪴",sce:"⪰",Scedil:"Ş",scedil:"ş",Scirc:"Ŝ",scirc:"ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",Scy:"С",scy:"с",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",seArr:"⇘",searr:"↘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",Sfr:"𝔖",sfr:"𝔰",sfrown:"⌢",sharp:"♯",SHCHcy:"Щ",shchcy:"щ",SHcy:"Ш",shcy:"ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",Sigma:"Σ",sigma:"σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",SOFTcy:"Ь",softcy:"ь",sol:"/",solb:"⧄",solbar:"⌿",Sopf:"𝕊",sopf:"𝕤",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",Square:"□",square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",Sscr:"𝒮",sscr:"𝓈",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",Star:"⋆",star:"☆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",Sub:"⋐",sub:"⊂",subdot:"⪽",subE:"⫅",sube:"⊆",subedot:"⫃",submult:"⫁",subnE:"⫋",subne:"⊊",subplus:"⪿",subrarr:"⥹",Subset:"⋐",subset:"⊂",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",Sum:"∑",sum:"∑",sung:"♪",Sup:"⋑",sup:"⊃",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supE:"⫆",supe:"⊇",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supnE:"⫌",supne:"⊋",supplus:"⫀",Supset:"⋑",supset:"⊃",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swArr:"⇙",swarr:"↙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"\t",target:"⌖",Tau:"Τ",tau:"τ",tbrk:"⎴",Tcaron:"Ť",tcaron:"ť",Tcedil:"Ţ",tcedil:"ţ",Tcy:"Т",tcy:"т",tdot:"⃛",telrec:"⌕",Tfr:"𝔗",tfr:"𝔱",there4:"∴",Therefore:"∴",therefore:"∴",Theta:"Θ",theta:"θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",THORN:"Þ",thorn:"þ",Tilde:"∼",tilde:"˜",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",Topf:"𝕋",topf:"𝕥",topfork:"⫚",tosa:"⤩",tprime:"‴",TRADE:"™",trade:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",Tscr:"𝒯",tscr:"𝓉",TScy:"Ц",tscy:"ц",TSHcy:"Ћ",tshcy:"ћ",Tstrok:"Ŧ",tstrok:"ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",Uacute:"Ú",uacute:"ú",Uarr:"↟",uArr:"⇑",uarr:"↑",Uarrocir:"⥉",Ubrcy:"Ў",ubrcy:"ў",Ubreve:"Ŭ",ubreve:"ŭ",Ucirc:"Û",ucirc:"û",Ucy:"У",ucy:"у",udarr:"⇅",Udblac:"Ű",udblac:"ű",udhar:"⥮",ufisht:"⥾",Ufr:"𝔘",ufr:"𝔲",Ugrave:"Ù",ugrave:"ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",Umacr:"Ū",umacr:"ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",Uogon:"Ų",uogon:"ų",Uopf:"𝕌",uopf:"𝕦",UpArrow:"↑",Uparrow:"⇑",uparrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",UpDownArrow:"↕",Updownarrow:"⇕",updownarrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",Upsi:"ϒ",upsi:"υ",upsih:"ϒ",Upsilon:"Υ",upsilon:"υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",Uring:"Ů",uring:"ů",urtri:"◹",Uscr:"𝒰",uscr:"𝓊",utdot:"⋰",Utilde:"Ũ",utilde:"ũ",utri:"▵",utrif:"▴",uuarr:"⇈",Uuml:"Ü",uuml:"ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",vArr:"⇕",varr:"↕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",Vbar:"⫫",vBar:"⫨",vBarv:"⫩",Vcy:"В",vcy:"в",VDash:"⊫",Vdash:"⊩",vDash:"⊨",vdash:"⊢",Vdashl:"⫦",Vee:"⋁",vee:"∨",veebar:"⊻",veeeq:"≚",vellip:"⋮",Verbar:"‖",verbar:"|",Vert:"‖",vert:"|",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",Vfr:"𝔙",vfr:"𝔳",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",Vopf:"𝕍",vopf:"𝕧",vprop:"∝",vrtri:"⊳",Vscr:"𝒱",vscr:"𝓋",vsubnE:"⫋︀",vsubne:"⊊︀",vsupnE:"⫌︀",vsupne:"⊋︀",Vvdash:"⊪",vzigzag:"⦚",Wcirc:"Ŵ",wcirc:"ŵ",wedbar:"⩟",Wedge:"⋀",wedge:"∧",wedgeq:"≙",weierp:"℘",Wfr:"𝔚",wfr:"𝔴",Wopf:"𝕎",wopf:"𝕨",wp:"℘",wr:"≀",wreath:"≀",Wscr:"𝒲",wscr:"𝓌",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",Xfr:"𝔛",xfr:"𝔵",xhArr:"⟺",xharr:"⟷",Xi:"Ξ",xi:"ξ",xlArr:"⟸",xlarr:"⟵",xmap:"⟼",xnis:"⋻",xodot:"⨀",Xopf:"𝕏",xopf:"𝕩",xoplus:"⨁",xotime:"⨂",xrArr:"⟹",xrarr:"⟶",Xscr:"𝒳",xscr:"𝓍",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",Yacute:"Ý",yacute:"ý",YAcy:"Я",yacy:"я",Ycirc:"Ŷ",ycirc:"ŷ",Ycy:"Ы",ycy:"ы",yen:"¥",Yfr:"𝔜",yfr:"𝔶",YIcy:"Ї",yicy:"ї",Yopf:"𝕐",yopf:"𝕪",Yscr:"𝒴",yscr:"𝓎",YUcy:"Ю",yucy:"ю",Yuml:"Ÿ",yuml:"ÿ",Zacute:"Ź",zacute:"ź",Zcaron:"Ž",zcaron:"ž",Zcy:"З",zcy:"з",Zdot:"Ż",zdot:"ż",zeetrf:"ℨ",ZeroWidthSpace:"​",Zeta:"Ζ",zeta:"ζ",Zfr:"ℨ",zfr:"𝔷",ZHcy:"Ж",zhcy:"ж",zigrarr:"⇝",Zopf:"ℤ",zopf:"𝕫",Zscr:"𝒵",zscr:"𝓏",zwj:"‍",zwnj:"‌"}),t.entityMap=t.HTML_ENTITIES},2186:(e,t,r)=>{"use strict";t.LO=t.kJ=void 0;var n=r(6944);Object.defineProperty(t,"kJ",{enumerable:!0,get:function(){return n.extractSolutionDetail}});r(7004),r(6442),r(3067),r(7953);var i=r(7338);Object.defineProperty(t,"LO",{enumerable:!0,get:function(){return i.startReview}})},2220:(e,t,r)=>{"use strict";var n=r(9113);e.exports=new n("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"})},2332:(e,t,r)=>{"use strict";var n=r(9444),i=r(9113),o=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),a=/^[-+]?[0-9]+e/;e.exports=new i("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!o.test(e)||"_"===e[e.length-1])},construct:function(e){var t,r;return r="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===r?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:r*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||n.isNegativeZero(e))},represent:function(e,t){var r;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(n.isNegativeZero(e))return"-0.0";return r=e.toString(10),a.test(r)?r.replace("e",".e"):r},defaultStyle:"lowercase"})},2461:(e,t,r)=>{"use strict";var n=r(9113);e.exports=new n("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}})},2591:(e,t,r)=>{"use strict";var n=r(1880);e.exports=p;var i=function(){function e(e){return void 0!==e&&e}try{return"undefined"!=typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{},o={mapHttpRequest:y,mapHttpResponse:y,wrapRequestSerializer:v,wrapResponseSerializer:v,wrapErrorSerializer:v,req:y,res:y,err:m,errWithCause:m};function a(e,t){return"silent"===e?1/0:t.levels.values[e]}var s=Symbol("pino.logFuncs"),l=Symbol("pino.hierarchy"),c={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function u(e,t){var r={logger:t,parent:e[l]};t[l]=r}function p(e){(e=e||{}).browser=e.browser||{};var t=e.browser.transmit;if(t&&"function"!=typeof t.send)throw Error("pino: transmit option must have a send function");var r=e.browser.write||i;e.browser.write&&(e.browser.asObject=!0);var n=e.serializers||{},o=function(e,t){return Array.isArray(e)?e.filter((function(e){return"!stdSerializers.err"!==e})):!0===e&&Object.keys(t)}(e.browser.serialize,n),l=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(l=!1);var m=Object.keys(e.customLevels||{}),y=["error","fatal","warn","info","debug","trace"].concat(m);"function"==typeof r&&y.forEach((function(e){r[e]=r})),(!1===e.enabled||e.browser.disabled)&&(e.level="silent");var v=e.level||"info",w=Object.create(r);w.log||(w.log=b),function(e,t,r){var n={};t.forEach((e=>{n[e]=r[e]?r[e]:i[e]||i[c[e]||"log"]||b})),e[s]=n}(w,y,r),u({},w),Object.defineProperty(w,"levelVal",{get:function(){return a(this.level,this)}}),Object.defineProperty(w,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,d(this,E,w,"error"),d(this,E,w,"fatal"),d(this,E,w,"warn"),d(this,E,w,"info"),d(this,E,w,"debug"),d(this,E,w,"trace"),m.forEach((e=>{d(this,E,w,e)}))}});var E={transmit:t,serialize:o,asObject:e.browser.asObject,formatters:e.browser.formatters,levels:y,timestamp:g(e),messageKey:e.messageKey||"msg",onChild:e.onChild||b};function N(r,i,a){if(!i)throw new Error("missing bindings for child Pino");a=a||{},o&&i.serializers&&(a.serializers=i.serializers);var s=a.serializers;if(o&&s){var l=Object.assign({},n,s),c=!0===e.browser.serialize?Object.keys(l):o;delete i.serializers,f([i],c,l,this._stdErrSerialize)}function p(e){this._childLevel=1+(0|e._childLevel),this.bindings=i,l&&(this.serializers=l,this._serialize=c),t&&(this._logEvent=h([].concat(e._logEvent.bindings,i)))}p.prototype=this;var d=new p(this);return u(this,d),d.child=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return N.call(this,r,...t)},d.level=a.level||this.level,r.onChild(d),d}return w.levels=function(e){var t,r,n=e.customLevels||{};return{values:Object.assign({},p.levels.values,n),labels:Object.assign({},p.levels.labels,(t=n,r={},Object.keys(t).forEach((function(e){r[t[e]]=e})),r))}}(e),w.level=v,w.setMaxListeners=w.getMaxListeners=w.emit=w.addListener=w.on=w.prependListener=w.once=w.prependOnceListener=w.removeListener=w.removeAllListeners=w.listeners=w.listenerCount=w.eventNames=w.write=w.flush=b,w.serializers=n,w._serialize=o,w._stdErrSerialize=l,w.child=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return N.call(this,E,...t)},t&&(w._logEvent=h()),w}function d(e,t,r,o){if(Object.defineProperty(e,o,{value:a(e.level,r)>a(o,r)?b:r[s][o],writable:!0,enumerable:!0,configurable:!0}),e[o]===b){if(!t.transmit)return;var c=a(t.transmit.level||e.level,r);if(a(o,r)<c)return}e[o]=function(e,t,r,o){return l=e[s][o],function(){for(var s=t.timestamp(),c=new Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===i?i:this,p=0;p<c.length;p++)c[p]=arguments[p];var d=!1;if(t.serialize&&(f(c,this._serialize,this.serializers,this._stdErrSerialize),d=!0),t.asObject||t.formatters?l.call(u,function(e,t,r,i,o){var{level:a,log:s=e=>e}=o.formatters||{},l=r.slice(),c=l[0],u={};if(i&&(u.time=i),a){var p=a(t,e.levels.values[t]);Object.assign(u,p)}else u.level=e.levels.values[t];var d=1+(0|e._childLevel);if(d<1&&(d=1),null!==c&&"object"==typeof c){for(;d--&&"object"==typeof l[0];)Object.assign(u,l.shift());c=l.length?n(l.shift(),l):void 0}else"string"==typeof c&&(c=n(l.shift(),l));return void 0!==c&&(u[o.messageKey]=c),s(u)}(this,o,c,s,t)):l.apply(u,c),t.transmit){var m=t.transmit.level||e._level,g=a(m,r),y=a(o,r);if(y<g)return;!function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=t.send,o=t.ts,a=t.methodLevel,s=t.methodValue,l=t.val,c=e._logEvent.bindings;n||f(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=o,e._logEvent.messages=r.filter((function(e){return-1===c.indexOf(e)})),e._logEvent.level.label=a,e._logEvent.level.value=s,i(a,e._logEvent,l),e._logEvent=h(c)}(this,{ts:s,methodLevel:o,methodValue:y,transmitLevel:m,transmitValue:r.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:a(e._level,r)},c,d)}};var l}(e,t,r,o);var u=function(e){var t=[];e.bindings&&t.push(e.bindings);for(var r=e[l];r.parent;)(r=r.parent).logger.bindings&&t.push(r.logger.bindings);return t.reverse()}(e);0!==u.length&&(e[o]=function(e,t){return function(){return t.apply(this,[...e,...arguments])}}(u,e[o]))}function f(e,t,r,n){for(var i in e)if(n&&e[i]instanceof Error)e[i]=p.stdSerializers.err(e[i]);else if("object"==typeof e[i]&&!Array.isArray(e[i])&&t)for(var o in e[i])t.indexOf(o)>-1&&o in r&&(e[i][o]=r[o](e[i][o]))}function h(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function m(e){var t={type:e.constructor.name,msg:e.message,stack:e.stack};for(var r in e)void 0===t[r]&&(t[r]=e[r]);return t}function g(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?w:E}function y(){return{}}function v(e){return e}function b(){}function w(){return!1}function E(){return Date.now()}p.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},p.stdSerializers=o,p.stdTimeFunctions=Object.assign({},{nullTime:w,epochTime:E,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),e.exports.default=p,e.exports.pino=p},3067:function(e,t,r){"use strict";function n(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,l,"next",e)}function l(e){n(a,i,o,s,l,"throw",e)}s(void 0)}))}}var o,a=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||(o=function(e){return o=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},o(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=o(e),n=0;n<r.length;n++)"default"!==r[n]&&a(t,e,r[n]);return s(t,e),t}),c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.reviewPowerAppsComponents=function(e,t){return g.apply(this,arguments)},t.readPropertiesFile=function(e,t){return v.apply(this,arguments)},t.processYamlFiles=I;var u=c(r(5271)),p=c(r(1485)),d=l(r(5525)),f=r(7985),h=r(1376),m=r(9734);function g(){return g=i((function*(e,t){var r=e.folder("CanvasApps"),n=[];if(Object.keys(f.PowerAppsPatternInfo).length,!r)return d.default.error("No CanvasApps folder found in the solution."),{items:n,totalApps:0,totalScore:"0%"};var i=[];r.forEach(((e,r)=>{e.endsWith(".msapp")&&i.push(function(e,t,r){return y.apply(this,arguments)}(r,n,t))})),yield Promise.all(i);var o=n.reduce(((e,t)=>e+(Number(t.score.replace("%",""))||0)),0);return{items:n,totalApps:n.length,totalScore:n.length?Math.round(o/n.length).toString()+"%":"0%"}})),g.apply(this,arguments)}function y(){return(y=i((function*(e,t,r){try{var n=yield e.async("arraybuffer"),i=yield u.default.loadAsync(n),o=(0,m.createMsApp)(),a=i.file("Properties.json");if(a)try{var s=yield a.async("string"),l=JSON.parse(s);if(o.appSettings=l,"ComponentLibrary"===l.DocumentType)return void console.log("Skipping Component Library: ".concat(l.Name))}catch(e){(0,d.logError)(e,"Error parsing Properties.json")}else d.default.error("Properties.json file not found in the .msapp file.");var c=i.folder("Resources\\");yield Promise.all([b(c,o),E(i,o),A(i,o),C(i,o),T(i,o),I(i,o)]);var p=[],g=new Set,y=0,v=[h.patternCheckMediaFileSize,h.patternCheckUnusedMediaResources,h.patternCheckAppSettings,h.patternCheckAppCheckerAccessibilityIssues,h.patternCheckUnusedElements,h.patternCheckDelayLoading],w=function*(){try{var e=yield N(o);if(r&&r.length>0&&!g.has(e.patternID)){var t=r.find((t=>t.data.patternID===e.patternID));if(t){var n=t.data;e.patternName=null!=n.patternName&&""!==n.patternName?n.patternName:e.patternName,e.description=null!=n.description&&""!==n.description?n.description:e.description,e.docLinks=null!=n.docLinks&&""!==n.docLinks?n.docLinks:e.docLinks,e.recommendation=null!=n.recommendation&&""!==n.recommendation?n.recommendation:e.recommendation,e.severity=null!=n.severity&&""!==n.severity?n.severity:e.severity,e.category=null!=n.category&&""!==n.category?n.category:e.category}}p.push(e),g.add(e.patternID),"Pass"===e.status&&y++,"Warning"===e.status&&(y+=.5)}catch(e){e instanceof Error?d.default.error("Error processing pattern: ".concat(e.message)):d.default.error("Unknown error processing pattern")}};for(var N of v)yield*w();var S=(0,m.iterateThroughScreens)(o),_=!o.yaml||0===Object.keys(o.yaml).length||1===Object.keys(o.yaml).length&&!o.yaml.Screens&&!o.yaml.App,D=(0,m.processFailures)(S,r,_);for(var x of D)g.has(x.patternID)||("Pass"===x.status&&y++,"Warning"===x.status&&(y+=.5),p.push(x),g.add(x.patternID));t.push({name:o.appSettings.Name.toLowerCase().endsWith(".msapp")?decodeURI(o.appSettings.Name.substring(0,o.appSettings.Name.length-6)).replace(/%2B/g," ").replace(/%2b/g,"+")||o.appSettings.Name||"Unknown App Name":o.appSettings.Name,result:p,totalScreens:o.totalScreens||0,totalCanvasComponents:o.totalCanvasComponents||0,totalCodeComponents:o.totalCodeComponents||0,score:y>0?Math.round(y/Object.keys(f.PowerAppsPatternInfo).length*100)+"%":"0%"})}catch(e){(0,d.logError)(e,"Error processing pattern app file")}}))).apply(this,arguments)}function v(){return(v=i((function*(e,t){var r=e.file("Properties.json");if(r)try{var n=yield r.async("string"),i=JSON.parse(n);t.appSettings=i}catch(e){(0,d.logError)(e,"Error parsing Properties.json")}else d.default.error("Properties.json file not found in the .msapp file.")}))).apply(this,arguments)}function b(e,t){return w.apply(this,arguments)}function w(){return(w=i((function*(e,t){if(e){var r=e.folder("Controls");if(r){var n=Object.keys(r.files).filter((e=>e.endsWith("bundle.js")));t.totalCodeComponents=n.length}}}))).apply(this,arguments)}function E(e,t){return N.apply(this,arguments)}function N(){return(N=i((function*(e,t){var r=0,n=e.folder("Components\\");n?r=Object.keys(n.files).filter((e=>!n.files[e].dir&&e.startsWith("Components\\")&&e.endsWith(".json"))).length:d.default.error("Components folder not found in the .msapp file."),t.totalCanvasComponents=r,d.default.info("Total canvas component files detected: ".concat(r))}))).apply(this,arguments)}function A(e,t){return S.apply(this,arguments)}function S(){return(S=i((function*(e,t){var r=e.file("References\\DataSources.json");if(r)try{var n=yield r.async("string"),i=JSON.parse(n);t.dataSources=i.DataSources}catch(e){(0,d.logError)(e,"Error parsing DataSources.json")}else d.default.error("DataSources.json file not found in the References folder.")}))).apply(this,arguments)}function C(e,t){return _.apply(this,arguments)}function _(){return(_=i((function*(e,t){var r=e.file("AppCheckerResult.sarif");if(r)try{var n=yield r.async("string"),i=JSON.parse(n);t.appCheckerIssues=function(e){return e.runs?e.runs.flatMap((e=>{var t,r,n=new Map(null===(t=e.tool)||void 0===t||null===(t=t.driver)||void 0===t||null===(t=t.rules)||void 0===t?void 0:t.map((e=>[e.id,e])));return(null===(r=e.results)||void 0===r?void 0:r.map((e=>{var t,r,i,o,a,s,l=n.get(e.ruleId);return{RuleId:e.ruleId,HowToFix:(null==l||null===(t=l.properties)||void 0===t?void 0:t.howToFix)||"No recommendation provided",WhyFix:(null==l||null===(r=l.properties)||void 0===r?void 0:r.whyFix)||"",Message:(null==l||null===(i=l.messageStrings)||void 0===i||null===(i=i.issue)||void 0===i?void 0:i.text)||"No message provided",Location:(null===(o=e.locations)||void 0===o||null===(o=o[0])||void 0===o||null===(o=o.physicalLocation)||void 0===o||null===(o=o.address)||void 0===o?void 0:o.fullyQualifiedName)||"Unknown Location",Severity:(null===(a=e.properties)||void 0===a?void 0:a.level)||"Unknown Severity",Category:(null==l||null===(s=l.properties)||void 0===s?void 0:s.primaryCategory)||""}})))||[]})):[]}(i)}catch(e){(0,d.logError)(e,"Error parsing AppCheckerResult.sarif")}else d.default.error("AppCheckerResult.sarif file not found in the .msapp file.")}))).apply(this,arguments)}function T(e,t){return D.apply(this,arguments)}function D(){return(D=i((function*(e,t){var r=e.folder("Assets\\Images");if(r){var n=Object.keys(r.files).filter((e=>!r.files[e].dir&&e.startsWith("Assets\\Images\\"))),i=[],o=function*(r){var n=e.file(r);if(n){var o=n.async("blob").then((e=>{var n=e.size,i=r.split("/").pop()||r;t.assets.push({mediaName:i,mediaSize:n,exceedsThreshold:n>f.MEDIA_FILE_SIZE_THRESHOLD})})).catch((e=>{d.default.error("Failed to process file ".concat(r,": ").concat(e.message))}));i.push(o)}};for(var a of n)yield*o(a);yield Promise.all(i)}}))).apply(this,arguments)}function I(e,t){return x.apply(this,arguments)}function x(){return(x=i((function*(e,t){var r=e.folder("Src\\");if(r){var n=Object.keys(r.files).filter((e=>!r.files[e].dir&&e.startsWith("Src\\"))),i=[],o=0,a={},s=function*(t){var r=e.file(t);if(o++,r){var n=r.async("string").then((e=>{if(e){var r,n,i=p.default.load(e),o=null===(r=t.split(/[/\\]/).pop())||void 0===r?void 0:r.replace(".pa.yaml","");"App"===o?a.App=i.App:o&&null!==(n=i.Screens)&&void 0!==n&&n[o]&&(a.Screens=a.Screens||{},a.Screens[o]=i.Screens[o])}})).catch((e=>{d.default.error("Failed to process file ".concat(t,": ").concat(e.message))}));i.push(n)}else d.default.error("File not found in JSZip structure for path: ".concat(t))};for(var l of n)yield*s(l);yield Promise.all(i),t.totalScreens=o?o-1:0,t.yaml=a}else d.default.error("Src folder not found in the .msapp file.")}))).apply(this,arguments)}},3114:(e,t)=>{"use strict";function r(e){try{"function"!=typeof e&&(e=RegExp);var t=new e("𝌆","u").exec("𝌆");return!!t&&2===t[0].length}catch(e){}return!1}var n=r();function i(e){if("["!==e.source[0])throw new Error(e+" can not be used with chars");return e.source.slice(1,e.source.lastIndexOf("]"))}function o(e,t){if("["!==e.source[0])throw new Error("/"+e.source+"/ can not be used with chars_without");if(!t||"string"!=typeof t)throw new Error(JSON.stringify(t)+" is not a valid search");if(-1===e.source.indexOf(t))throw new Error('"'+t+'" is not is /'+e.source+"/");if("-"===t&&1!==e.source.indexOf(t))throw new Error('"'+t+'" is not at the first postion of /'+e.source+"/");return new RegExp(e.source.replace(t,""),n?"u":"")}function a(e){var t=this;return new RegExp(Array.prototype.slice.call(arguments).map((function(e){var r="string"==typeof e;if(r&&void 0===t&&"|"===e)throw new Error("use regg instead of reg to wrap expressions with `|`!");return r?e:e.source})).join(""),n?"mu":"m")}function s(e){if(0===arguments.length)throw new Error("no parameters provided");return a.apply(s,["(?:"].concat(Array.prototype.slice.call(arguments),[")"]))}var l=/[-\x09\x0A\x0D\x20-\x2C\x2E-\uD7FF\uE000-\uFFFD]/;n&&(l=a("[",i(l),"\\u{10000}-\\u{10FFFF}","]"));var c=/[\x20\x09\x0D\x0A]/,u=i(c),p=a(c,"+"),d=a(c,"*"),f=/[:_a-zA-Z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;n&&(f=a("[",i(f),"\\u{10000}-\\u{10FFFF}","]"));var h=a("[",i(f),i(/[-.0-9\xB7]/),i(/[\u0300-\u036F\u203F-\u2040]/),"]"),m=a(f,h,"*"),g=a(h,"+"),y=a("&",m,";"),v=s(/&#[0-9]+;|&#x[0-9a-fA-F]+;/),b=s(y,"|",v),w=a("%",m,";"),E=s(a('"',s(/[^%&"]/,"|",w,"|",b),"*",'"'),"|",a("'",s(/[^%&']/,"|",w,"|",b),"*","'")),N=s('"',s(/[^<&"]/,"|",b),"*",'"',"|","'",s(/[^<&']/,"|",b),"*","'"),A=a(o(f,":"),o(h,":"),"*"),S=a(A,s(":",A),"?"),C=a("^",S,"$"),_=a("(",S,")"),T=s(/"[^"]*"|'[^']*'/),D=a(/^<\?/,"(",m,")",s(p,"(",l,"*?)"),"?",/\?>/),I=/[\x20\x0D\x0Aa-zA-Z0-9-'()+,./:=?;!*#@$_%]/,x=s('"',I,'*"',"|","'",o(I,"'"),"*'"),P="\x3c!--",k=a(P,s(o(l,"-"),"|",a("-",o(l,"-"))),"*","--\x3e"),O="#PCDATA",R=s(a(/\(/,d,O,s(d,/\|/,d,S),"*",d,/\)\*/),"|",a(/\(/,d,O,d,/\)/)),L=s("EMPTY","|","ANY","|",R,"|",a(/\([^>]+\)/,/[?*+]?/)),F=a("<!ELEMENT",p,s(S,"|",w),p,s(L,"|",w),d,">"),M=a("NOTATION",p,/\(/,d,m,s(d,/\|/,d,m),"*",d,/\)/),U=a(/\(/,d,g,s(d,/\|/,d,g),"*",d,/\)/),B=s(M,"|",U),j=s(/CDATA|ID|IDREF|IDREFS|ENTITY|ENTITIES|NMTOKEN|NMTOKENS/,"|",B),z=s(/#REQUIRED|#IMPLIED/,"|",s(s("#FIXED",p),"?",N)),V=a("<!ATTLIST",p,m,s(p,m,p,j,p,z),"*",d,">"),q="about:legacy-compat",H=s('"'+q+'"',"|","'"+q+"'"),W="SYSTEM",G="PUBLIC",Y=s(s(W,p,T),"|",s(G,p,x,p,T)),X=a("^",s(s(W,p,"(?<SystemLiteralOnly>",T,")"),"|",s(G,p,"(?<PubidLiteral>",x,")",p,"(?<SystemLiteral>",T,")"))),Z=s(p,"NDATA",p,m),Q="<!ENTITY",K=a(Q,p,m,p,s(E,"|",s(Y,Z,"?")),d,">"),J=s(E,"|",Y),$=s(K,"|",a(Q,p,"%",p,m,p,J,d,">")),ee=a(G,p,x),te=a("<!NOTATION",p,m,p,s(Y,"|",ee),d,">"),re=a(d,"=",d),ne=/1[.]\d+/,ie=a(p,"version",re,s("'",ne,"'","|",'"',ne,'"')),oe=/[A-Za-z][-A-Za-z0-9._]*/,ae=a(/^<\?xml/,ie,s(p,"encoding",re,s('"',oe,'"',"|","'",oe,"'")),"?",s(p,"standalone",re,s("'",s("yes","|","no"),"'","|",'"',s("yes","|","no"),'"')),"?",d,/\?>/),se=a(l,"*?",/\]\]>/),le=a(/<!\[CDATA\[/,se);t.chars=i,t.chars_without=o,t.detectUnicodeSupport=r,t.reg=a,t.regg=s,t.ABOUT_LEGACY_COMPAT=q,t.ABOUT_LEGACY_COMPAT_SystemLiteral=H,t.AttlistDecl=V,t.CDATA_START="<![CDATA[",t.CDATA_END="]]>",t.CDSect=le,t.Char=l,t.Comment=k,t.COMMENT_START=P,t.COMMENT_END="--\x3e",t.DOCTYPE_DECL_START="<!DOCTYPE",t.elementdecl=F,t.EntityDecl=$,t.EntityValue=E,t.ExternalID=Y,t.ExternalID_match=X,t.Name=m,t.NotationDecl=te,t.Reference=b,t.PEReference=w,t.PI=D,t.PUBLIC=G,t.PubidLiteral=x,t.QName=S,t.QName_exact=C,t.QName_group=_,t.S=p,t.SChar_s=u,t.S_OPT=d,t.SYSTEM=W,t.SystemLiteral=T,t.UNICODE_REPLACEMENT_CHARACTER="�",t.UNICODE_SUPPORT=n,t.XMLDecl=ae},3152:(e,t,r)=>{"use strict";r.r(t),r.d(t,{IntelligentReviewVisualizer:()=>c});const n=Reactv16,i=FluentUIReactv940;var o=r(2186),a=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}l((n=n.apply(e,t||[])).next())}))},s=n.memo((e=>{var{initiateReview:t,resetInitiateReview:r,webapi:s,height:l,width:c,isAuthoringMode:u,chooseButtonTitle:p,solutionName:d,onResultEvaluation:f,onDetailsExtraction:h,hideUserInterface:m,solutionFile:g,patternDetails:y,reviewSolution:v,extractSolutionDetails:b,customPromptResults:w}=e,[E,N]=n.useState(),A=n.useRef(null);n.useEffect((()=>{t&&(r(),S())}));var S=()=>a(void 0,void 0,void 0,(function*(){var e=u?E:g;if(e){if(!u&&e.fileUrl)try{e=yield(t=e.fileUrl,r=e.fileName,n=e.mimeType,a(void 0,void 0,void 0,(function*(){try{var e=yield fetch(t);if(!e.ok)throw new Error("HTTP error! Status: ".concat(e.status));var i=yield e.blob();return new File([i],r,{type:n})}catch(e){throw console.error("Error fetching or processing zip file:",e),e}})))}catch(e){return void alert("Error fetching the ZIP file from URL.")}var t,r,n;try{if(v){var i=yield(0,o.LO)(e,d,s,y,w);console.log(i),f(i)}if(b){var l=yield(0,o.kJ)(e,d,s);h(l)}}catch(e){console.error("Error during the review process:",e)}finally{console.log("Review evaluation completed")}}else console.log("Please upload a ZIP file to start the review.")}));return m?n.createElement("div",{style:{width:c,height:l}}):n.createElement("div",{style:{width:c,height:l,display:"flex",alignItems:"center",justifyContent:"flex-start",overflow:"hidden",boxSizing:"border-box"}},n.createElement("input",{type:"file",accept:".zip",ref:A,onChange:e=>{var t,r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r){if("application/zip"!==r.type&&!r.name.endsWith(".zip"))return alert("Please upload a valid ZIP file."),void(e.target.value="");N(r)}},style:{display:"none"}}),n.createElement(i.Button,{onClick:()=>{A.current&&A.current.click()},appearance:"primary",style:{marginRight:"10px"}},p),n.createElement(i.Text,{style:{margin:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flexGrow:1,flexShrink:1,minWidth:0}},E?"Selected Solution: ".concat(E.name):"No solution selected"))}));s.displayName="FileUploadComponent";class l{static getReviewSchema(){return{ReviewResults:{$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{Copilot:{type:"object",properties:{items:{type:"array",items:{type:"object",properties:{name:{type:"string"},displayName:{type:"string"},result:{type:"array",items:{type:"object",properties:{patternName:{type:"string"},patternID:{type:"string"},status:{type:"string"},instanceValue:{type:"array",items:{type:"object",properties:{Topic:{type:"array",items:{type:"object",properties:{TopicName:{type:"string"},InvalidTriggerQueries:{type:"array",items:{type:"string"}},VariableName:{type:"string"},VariableDisplayName:{type:"string"},VariableDescription:{type:"string"},VariableType:{type:"string"},ModelDescription:{type:"string"},Score:{type:"number"}}}},Flows:{type:"array",items:{type:"string"}},KnowledgeSource:{type:"array",items:{type:"object",properties:{KnowledgeName:{type:"string"},Description:{type:"string"},Score:{type:"number"}}}},Entity:{type:"object",properties:{RegexEntity:{type:"array",items:{type:"object",properties:{name:{type:"string"},pattern:{type:"string"},matchingPatternEntityList:{type:"array",items:{type:"string"}}}}}}},Actions:{type:"array",items:{type:"object",properties:{ActionName:{type:"string"},ModelDescription:{type:"string"},Score:{type:"number"}}}}}}},failureReason:{type:"string"},recommendation:{type:"string"},docLinks:{type:"string",format:"uri"},category:{type:"string"},description:{type:"string"},severity:{type:"string"}}}},score:{type:"string"}}}},totalBots:{type:"integer"},totalScore:{type:"string"}}},PowerAutomate:{type:"object",properties:{items:{type:"array",items:{type:"object",properties:{name:{type:"string"},displayName:{type:"string"},result:{type:"array",items:{type:"object",properties:{patternName:{type:"string"},patternID:{type:"string"},status:{type:"string"},instanceValue:{type:"array",items:{type:"string"}},failureReason:{type:"string"},recommendation:{type:"string"},docLinks:{type:"string",format:"uri"},category:{type:"string"},description:{type:"string"},severity:{type:"string"}}}},score:{type:"string"}}}},totalFlows:{type:"integer"},totalScore:{type:"string"}}},PowerApps:{type:"object",properties:{items:{type:"array",items:{type:"object",properties:{name:{type:"string"},displayName:{type:"string"},totalScreens:{type:"integer"},totalCanvasComponents:{type:"integer"},totalCodeComponents:{type:"integer"},result:{type:"array",items:{type:"object",properties:{patternName:{type:"string"},patternID:{type:"string"},status:{type:"string"},instanceValue:{type:"array",items:{type:"object",properties:{ScreenName:{type:"string"},ControlName:{type:"string"},PropertyName:{type:"string"},Code:{type:"string"},PatternName:{type:"string"},ControlType:{type:"string"},FailedPowerFxCode:{type:"string"},FailureReason:{type:"string"}}}},failureReason:{type:"string"},recommendation:{type:"string"},docLinks:{type:"string",format:"uri"},category:{type:"string"},description:{type:"string"},severity:{type:"string"}}}},score:{type:"string"}}}},totalApps:{type:"integer"},totalScore:{type:"string"}}},SolutionScore:{type:"string"}}},SolutionDetails:{$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{solutionOverview:{type:"object",properties:{displayName:{type:"string"},uniqueName:{type:"string"},description:{type:"string"},version:{type:"string"},solutionType:{type:"string"}},required:["displayName","uniqueName","version"]},canvasApps:{type:"array",items:{type:"object",properties:{appName:{type:"string"},appDescription:{type:"string"},screens:{type:"array",items:{type:"object",properties:{screenName:{type:"string"},screenYaml:{type:"string"}},required:["screenName","screenYaml"]}},sarifLog:{type:"object",properties:{runs:{type:"array",items:{type:"object",properties:{tool:{type:"object",properties:{driver:{type:"object",properties:{name:{type:"string"},rules:{type:"array",items:{type:"object",properties:{id:{type:"string"},properties:{type:"object",properties:{howToFix:{type:"string"},whyFix:{type:"string"},primaryCategory:{type:"string"}},additionalProperties:!0},messageStrings:{type:"object",properties:{issue:{type:"object",properties:{text:{type:"string"}}}}}},required:["id"]}}},required:["name","rules"]}},required:["driver"]},results:{type:"array",items:{type:"object",properties:{ruleId:{type:"string"},messageStrings:{type:"object",properties:{issue:{type:"object",properties:{text:{type:"string"}}}}},locations:{type:"array",items:{type:"object",properties:{physicalLocation:{type:"object",properties:{address:{type:"object",properties:{fullyQualifiedName:{type:"string"}}}}}}}},properties:{type:"object",properties:{level:{type:"string"}},additionalProperties:!0}},required:["ruleId"]}}},required:["tool","results"]}}},required:["runs"]}},required:["appName","appDescription","screens","sarifLog"]}},tables:{type:"array",items:{type:"object",properties:{DisplayName:{type:"string"},SchemaName:{type:"string"},Description:{type:"string"},Fields:{type:"array",items:{type:"object",properties:{Name:{type:"string"},SchemaName:{type:"string"},DataType:{type:"string"}},required:["Name","SchemaName","DataType"]}},Relationships:{type:"object",properties:{OneToMany:{type:"array",items:{type:"object",properties:{SchemaName:{type:"string"},ReferencingEntity:{type:"string"},ReferencingAttribute:{type:"string"},ReferencedEntity:{type:"string"}},required:["SchemaName","ReferencingEntity","ReferencingAttribute","ReferencedEntity"]}},ManyToOne:{type:"array",items:{type:"object"}},ManyToMany:{type:"array",items:{type:"object",properties:{SchemaName:{type:"string"},Entity1LogicalName:{type:"string"},Entity2LogicalName:{type:"string"}},required:["SchemaName","Entity1LogicalName","Entity2LogicalName"]}}}}},required:["DisplayName","SchemaName","Fields","Relationships"]}},workflows:{type:"array",items:{type:"object",properties:{name:{type:"string"},primaryEntity:{type:"string"},category:{type:"string"},json:{type:"string"}},required:["name","primaryEntity","category"]}},codeComponents:{type:"array",items:{type:"object",properties:{displayName:{type:"string"},description:{type:"string"},type:{type:"string"},version:{type:"string"}},required:["displayName","description","type","version"]}},customApis:{type:"array",items:{type:"object",properties:{displayName:{type:"string"},description:{type:"string"},isPrivate:{type:"boolean"},isFunction:{type:"boolean"}},required:["displayName","description","isPrivate","isFunction"]}},environmentVariables:{type:"array",items:{type:"object",properties:{displayName:{type:"string"},description:{type:"string"},type:{type:"string"}},required:["displayName","description","type"]}},securityRoles:{type:"array",items:{type:"object",properties:{name:{type:"string"}}}},plugins:{type:"array",items:{type:"object",properties:{Name:{type:"string"}}}},mermaidERDiagramExpression:{type:"string"},mermaidSolutionOverviewExpression:{type:"string"},mermaidSolutionArchitectureExpressions:{type:"array",items:{type:"string"}},connectionReferences:{type:"array",items:{type:"object",properties:{LogicalName:{type:"string"},DisplayName:{type:"string"},ConnectorID:{type:"string"}}}},aiModels:{type:"array",items:{type:"object",properties:{Name:{type:"string"},Model:{type:"string"}}}},missingDependencies:{type:"array",items:{type:"object",properties:{Required:{type:"object",properties:{Type:{type:"string"},SchemaName:{type:"string"},DisplayName:{type:"string"},Solution:{type:"string"}}},Dependent:{type:"object",properties:{Type:{type:"string"},SchemaName:{type:"string"},DisplayName:{type:"string"}}}}}},agents:{type:"array",items:{type:"object",properties:{botLogicalName:{type:"string"},botDisplayName:{type:"string"},botXml:{type:"string"},botConfig:{type:"object"},authenticationmode:{type:"string"},isGenModeEnabled:{type:"boolean"},botComponents:{type:"array",items:{type:"object",properties:{componentType:{type:"string"},name:{type:"string"},botComponentXml:{type:"string"},data:{type:"object"},description:{type:"string"},isEnabled:{type:"boolean"}},required:["componentType","name"]}},topics:{type:"array",items:{type:"object",properties:{name:{type:"string"},rawXml:{type:"string"},rawYamlData:{type:"string"},modelDescription:{type:"string"},description:{type:"string"},triggerQueries:{type:"array",items:{type:"string"}},inputType:{type:"array",items:{type:"object",properties:{variableName:{type:"string"},displayName:{type:"string"},description:{type:"string"},type:{type:"string"}},required:["variableName"]}},outputType:{type:"array",items:{type:"object",properties:{variableName:{type:"string"},displayName:{type:"string"},description:{type:"string"},type:{type:"string"}},required:["variableName"]}},isEnabled:{type:"boolean"}},required:["name","isEnabled"]}},entities:{type:"array",items:{type:"object",properties:{name:{type:"string"},rawXml:{type:"string"},rawYamlData:{type:"string"},description:{type:"string"},kind:{type:"string"},pattern:{type:"string"},items:{type:"array",items:{type:"object",properties:{displayName:{type:"string"},synonyms:{type:"array",items:{type:"string"}}},required:["displayName"]}},isEnabled:{type:"boolean"}},required:["name","kind"]}},knowledge:{type:"array",items:{type:"object",properties:{name:{type:"string"},description:{type:"string"},isEnabled:{type:"boolean"},kind:{type:"string"},rawXml:{type:"string"},rawYamlData:{type:"string"},siteSearchKind:{type:"string"},site:{type:"string"},skillConfiguration:{type:"string"}},required:["name","isEnabled"]}},fileAttachments:{type:"array",items:{type:"object",properties:{name:{type:"string"},description:{type:"string"},isEnabled:{type:"boolean"},rawXml:{type:"string"},rawYamlData:{type:"string"}},required:["name","isEnabled"]}},globalVariables:{type:"array",items:{type:"object",properties:{name:{type:"string"},description:{type:"string"},isEnabled:{type:"boolean"},rawXml:{type:"string"},rawYamlData:{type:"string"},isExternalInitializationAllowed:{type:"boolean"},scope:{type:"string"},aIVisibility:{type:"string"},initializationTimeoutInMilliseconds:{type:"integer"}},required:["name","isEnabled"]}},actions:{type:"array",items:{type:"object",properties:{name:{type:"string"},rawXml:{type:"string"},rawYamlData:{type:"string"},description:{type:"string"},modelDisplayName:{type:"string"},modelDescription:{type:"string"},actionKind:{type:"string"},outputMode:{type:"string"},isEnabled:{type:"boolean"},inputs:{type:"array",items:{type:"object",properties:{kind:{type:"string"},propertyName:{type:"string"},name:{type:"string"},description:{type:"string"},value:{type:"string"},entity:{type:"string"},shouldPromptUser:{type:"boolean"}},required:["kind","propertyName"]}},outputs:{type:"array",items:{type:"object",properties:{propertyName:{type:"string"},description:{type:"string"}},required:["propertyName"]}}},required:["name","isEnabled"]}},externalTriggers:{type:"array",items:{type:"object",properties:{name:{type:"string"},rawXml:{type:"string"},rawYamlData:{type:"string"},description:{type:"string"},isEnabled:{type:"boolean"},externalTriggerSourceKind:{type:"string"},flowId:{type:"string"},flowName:{type:"string"},flowUrl:{type:"string"},triggerConnectionType:{type:"string"}},required:["name","isEnabled"]}},customGPT:{type:"array",items:{type:"object",properties:{name:{type:"string"},rawXml:{type:"string"},rawYamlData:{type:"string"},description:{type:"string"},isEnabled:{type:"boolean"},instructions:{type:"string"},conversationStarters:{type:"array",items:{type:"object",properties:{title:{type:"string"},text:{type:"string"}},required:["title","text"]}}},required:["name","isEnabled"]}}},required:["botLogicalName","botDisplayName"]}}},required:["solutionOverview","canvasApps","tables","workflows","codeComponents","customApis","environmentVariables","securityRoles","plugins","connectionReferences","aiModels","missingDependencies"]},SARIFLog:{$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{version:{type:"string"},runs:{type:"array",items:{type:"object",properties:{tool:{type:"object",properties:{driver:{type:"object",properties:{name:{type:"string"},informationUri:{type:"string",format:"uri"},rules:{type:"array",items:{type:"object",properties:{id:{type:"string"},name:{type:"string"},fullDescription:{type:"object",properties:{text:{type:"string"}}},help:{type:"object",properties:{text:{type:"string"}}},properties:{type:"object",properties:{tags:{type:"array",items:{type:"string"}}},additionalProperties:!0}},required:["id"]}}},required:["name","rules"]}},required:["driver"]},results:{type:"array",items:{type:"object",properties:{ruleId:{type:"string"},level:{type:"string"},message:{type:"object",properties:{text:{type:"string"}}},locations:{type:"array",items:{type:"object",properties:{physicalLocation:{type:"object",properties:{artifactLocation:{type:"object",properties:{uri:{type:"string"}}},region:{type:"object",properties:{startLine:{type:"integer"},startColumn:{type:"integer"}}}}}}}}},required:["ruleId","level","message"]}}},required:["tool","results"]}}},required:["version","runs"]}}}}class c{constructor(){this.inputEventValue="",this.patternDetails=[]}init(e,t,r,n){this.context=e,this.notifyOutputChanged=t,this.container=n,e.mode.trackContainerResize(!0),this.resetInitiateReview=this.resetInitiateReview.bind(this),this.onResultEvaluation=this.onResultEvaluation.bind(this),this.onDetailsExtraction=this.onDetailsExtraction.bind(this)}updateView(e){var t,r,i;console.info("Update View called"),this.initiateReview=!1;var o=parseInt(e.mode.allocatedWidth),a=parseInt(e.mode.allocatedHeight),l=null!==(t=e.parameters.InputEvent.raw)&&void 0!==t?t:"",c=e.parameters.SolutionFile.raw,u=null!==(r=e.parameters.SolutionName.raw)&&void 0!==r?r:"",p=this.inputEventValue!==l;this.eventstobeTriggered&&this.triggerEvents();var d=e.parameters.PatternDetails;c&&c.fileUrl&&c.fileUrl!==this.fileUrl&&(console.info("Received the uploaded file."),this.patternDetails=function(e){if(e.error||void 0===e.paging.totalResultCount)return[];var t={};return e.sortedRecordIds.map((r=>{var n=e.records[r],i=n.getValue("PatternID");return void 0!==t[i]?(t[i]++,i+="_".concat(t[i])):t[i]=1,{id:n.getRecordId(),key:i,text:n.getFormattedValue("PatternName"),clickable:!0,data:{patternID:n.getValue("PatternID"),patternName:n.getValue("PatternName"),description:n.getValue("PatternDescription"),recommendation:n.getValue("PatternRecommendation"),docLinks:n.getValue("PatternDocLink"),severity:n.getValue("PatternSeverity"),category:n.getValue("PatternCategory"),patternType:n.getValue("PatternType"),patternScore:n.getValue("PatternScore"),patternActive:n.getValue("PatternActive")}}}))}(d),this.fileUrl=c.fileUrl,this.initiateReview=!0);var f=e.parameters.CustomPromptResults.raw;if(console.log("rawCustomResults",JSON.stringify(f)),f){var h="string"==typeof f?JSON.parse(f):f;console.log("parsed",JSON.stringify(h));var m=Array.isArray(null==h?void 0:h.Data)?h.Data:[];console.log("dataArray",JSON.stringify(m)),m.length>0&&this.customPromptResults!==m&&(this.customPromptResults=m,this.initiateReview=!0,console.log("Received CustomPromptResults",JSON.stringify(m)))}return p&&l.startsWith("StartReview")&&u&&(this.inputEventValue=l,this.initiateReview=!0),this.generateSarif=e.parameters.GenerateSARIF.raw,n.createElement(s,{initiateReview:this.initiateReview,webapi:e.webAPI,width:o,height:a,chooseButtonTitle:null!==(i=e.parameters.ChooseButtonTitle.raw)&&void 0!==i?i:"Choose Solution",solutionName:u,isAuthoringMode:"{00000000-0000-0000-0000-000000000000}"===e.userSettings.userId,onResultEvaluation:this.onResultEvaluation,onDetailsExtraction:this.onDetailsExtraction,resetInitiateReview:this.resetInitiateReview,reviewSolution:e.parameters.ReviewSolution.raw,extractSolutionDetails:e.parameters.ExtractSolutionDetails.raw,solutionFile:e.parameters.SolutionFile.raw,hideUserInterface:e.parameters.HideUserInterface.raw,patternDetails:this.patternDetails,customPromptResults:this.customPromptResults})}resetInitiateReview(){this.initiateReview=!1}triggerEvents(){this.context.events.OnReviewComplete(),this.eventstobeTriggered=!1}onDetailsExtraction(e){e&&this.solutionDetails!==e&&(this.solutionDetails=e,this.eventstobeTriggered=!0,this.notifyOutputChanged())}onResultEvaluation(e){e&&this.result!==e&&(this.result=e,this.generateSarif&&(this.sarifLogs=function(e){var t=(e,t)=>{var r=new Map,n=[];return t.result.forEach((i=>{r.has(i.patternID)||r.set(i.patternID,{id:i.patternID,name:i.patternID,shortDescription:{text:i.description||"No description provided."},helpUri:Array.isArray(i.docLinks)?i.docLinks[0]:i.docLinks}),i.instanceValue&&Array.isArray(i.instanceValue)&&i.instanceValue.forEach((r=>{i.description;var o={startLine:1};if("PowerApps"===e){var a=r;if(a.Code&&a.FailedPowerFxCode){var s=a.Code,l=a.FailedPowerFxCode,c=s.indexOf(l);-1!==c&&(o={startLine:1,startColumn:c+1,endColumn:c+l.length+1,snippet:{text:s}}),"".concat(i.description,": ").concat(l)}}else if("PowerAutomate"===e){var u=r;"".concat(i.description,": ").concat(u)}else if("Copilot"===e){var p=r;"".concat(i.description,": ").concat(JSON.stringify(p))}n.push({ruleId:i.patternID,level:"Pass"===i.status?"note":"Fail"===i.status?"error":"warning",message:{text:i.description,markdown:"PowerApps"===e&&r.FailedPowerFxCode?"```powerfx\n".concat(r.FailedPowerFxCode,"\n```"):void 0},locations:[{physicalLocation:{artifactLocation:{uri:"".concat(e,"/").concat(t.name)+("PowerApps"===e?"/".concat(r.ScreenName,"/").concat(r.ControlName):"")},region:o}}],properties:{component:e,name:t.name,score:t.score}})}))})),{tool:{driver:{name:"".concat(e,": ").concat(t.displayName||t.name),informationUri:"https://github.com/microsoft/Power-CAT-Tools",rules:Array.from(r.values())}},properties:{componentType:e,componentName:t.displayName||t.name,componentScore:t.score},results:n}};return{version:"2.1.0",properties:{solutionScore:e.SolutionScore},$schema:"https://schemastore.azurewebsites.net/schemas/json/sarif-2.1.0-rtm.5.json",runs:[...e.PowerApps.items.map((e=>t("PowerApps",e))),...e.PowerAutomate.items.map((e=>t("PowerAutomate",e))),...e.Copilot.items.map((e=>t("Copilot",e)))]}}(e)),this.eventstobeTriggered=!0,this.notifyOutputChanged())}getOutputSchema(e){return t=this,r=void 0,i=function*(){return Promise.resolve(l.getReviewSchema())},new((n=void 0)||(n=Promise))((function(e,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i.throw(e))}catch(e){o(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(a,s)}l((i=i.apply(t,r||[])).next())}));var t,r,n,i}getOutputs(){return console.log({ReviewResults:this.result,SolutionDetails:this.solutionDetails,SARIFLogs:this.sarifLogs}),{ReviewResults:this.result,SolutionDetails:this.solutionDetails,SARIFLogs:this.sarifLogs}}destroy(){}}},3715:(e,t)=>{"use strict";function r(e,t){return void 0===t&&(t=Object),t&&"function"==typeof t.getOwnPropertyDescriptors&&(e=t.create(null,t.getOwnPropertyDescriptors(e))),t&&"function"==typeof t.freeze?t.freeze(e):e}function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var i=r({allowfullscreen:!0,async:!0,autofocus:!0,autoplay:!0,checked:!0,controls:!0,default:!0,defer:!0,disabled:!0,formnovalidate:!0,hidden:!0,ismap:!0,itemscope:!0,loop:!0,multiple:!0,muted:!0,nomodule:!0,novalidate:!0,open:!0,playsinline:!0,readonly:!0,required:!0,reversed:!0,selected:!0}),o=r({area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),a=r({script:!1,style:!1,textarea:!0,title:!0});function s(e){return e===l.HTML}var l=r({HTML:"text/html",XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),c=Object.keys(l).map((function(e){return l[e]})),u=r({HTML:"http://www.w3.org/1999/xhtml",SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});t.assign=function(e,t){if(null===e||"object"!=typeof e)throw new TypeError("target is not an object");for(var r in t)n(t,r)&&(e[r]=t[r]);return e},t.find=function(e,t,r){if(void 0===r&&(r=Array.prototype),e&&"function"==typeof r.find)return r.find.call(e,t);for(var i=0;i<e.length;i++)if(n(e,i)){var o=e[i];if(t.call(void 0,o,i,e))return o}},t.freeze=r,t.HTML_BOOLEAN_ATTRIBUTES=i,t.HTML_RAW_TEXT_ELEMENTS=a,t.HTML_VOID_ELEMENTS=o,t.hasDefaultHTMLNamespace=function(e){return s(e)||e===l.XML_XHTML_APPLICATION},t.hasOwn=n,t.isHTMLBooleanAttribute=function(e){return n(i,e.toLowerCase())},t.isHTMLRawTextElement=function(e){var t=e.toLowerCase();return n(a,t)&&!a[t]},t.isHTMLEscapableRawTextElement=function(e){var t=e.toLowerCase();return n(a,t)&&a[t]},t.isHTMLMimeType=s,t.isHTMLVoidElement=function(e){return n(o,e.toLowerCase())},t.isValidMimeType=function(e){return c.indexOf(e)>-1},t.MIME_TYPE=l,t.NAMESPACE=u},4248:function(e,t,r){"use strict";function n(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,l,"next",e)}function l(e){n(a,i,o,s,l,"throw",e)}s(void 0)}))}}var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.extractTriggerPhrases=function(e){var t;return(null==e||null===(t=e.beginDialog)||void 0===t||null===(t=t.intent)||void 0===t?void 0:t.triggerQueries)||[]},t.extractBotDisplayName=function(e,t){return l.apply(this,arguments)},t.getAuthenticationMode=function(e){return c.apply(this,arguments)},t.countConditionsInActions=function e(t){var r=0;for(var n of t)if("ConditionGroup"===n.kind&&n.conditions)for(var i of(r+=n.conditions.length,n.conditions))i.actions&&(r+=e(i.actions));else n.actions&&(r+=e(n.actions));return r},t.extractUniqueFlowIds=function e(t,r){t.forEach((t=>{"InvokeFlowAction"===t.kind&&t.flowId&&r.add(t.flowId),Object.keys(t).forEach((n=>{Array.isArray(t[n])&&e(t[n],r)}))}))},t.collectBeginDialogReferences=function e(t,r){for(var n of t)if("BeginDialog"===n.kind&&n.dialog&&r.add(n.dialog),Array.isArray(n.actions)&&e(n.actions,r),Array.isArray(n.conditions))for(var i of n.conditions)Array.isArray(i.actions)&&e(i.actions,r)},t.formatTopicName=function(e,t){var r=t.replace(/\s+/g,"");return"".concat(e,".topic.").concat(r)},t.mapAuthMode=function(e){switch(e){case"1":return"No Authentication";case"2":return"EntraID";case"3":return"Manual";default:return"Unknown"}},t.getBasePatternInfo=function(e,t){var r=Object.values(s.BotPatternInfo).find((t=>s.BotPatternDetails[t].patternID===e)),n=r?s.BotPatternDetails[r]:{patternName:e,description:"",recommendation:"",docLink:"",severity:"Medium",category:"Usage"};if(t&&t.length>0){var i=t.find((t=>t.data.patternID===e));if(i){var o=i.data;return{patternName:o.patternName&&o.patternName.trim().length>0?o.patternName:n.patternName,description:o.description&&o.description.trim().length>0?o.description:n.description,recommendation:o.recommendation&&o.recommendation.trim().length>0?o.recommendation:n.recommendation,docLinks:o.docLinks&&o.docLinks.toString().trim().length>0?o.docLinks:n.docLink,severity:o.severity&&o.severity.trim().length>0?o.severity:n.severity,category:o.category&&o.category.trim().length>0?o.category:n.category}}}return{patternName:n.patternName,description:n.description,recommendation:n.recommendation,docLinks:n.docLink,severity:n.severity,category:n.category}},t.getComponentStatus=u,t.isEndOfConversationTopic=function(e){if(!e||"CancelOtherTopics"!==e.startBehavior)return!1;var t=!1;return function e(r){if(r&&"object"==typeof r)for(var n of Object.keys(r)){var i=r[n];"conversationOutcome"!==n||"ResolvedImplied"!==i&&"ResolvedConfirmed"!==i||(t=!0),"object"==typeof i&&e(i)}}(e),t},t.xmlTag=p,t.toIOArray=d,t.toEntityItems=f,t.collectBots=h,t.collectComponents=g,t.buildAgents=v,t.extractAgentsDetails=function(e){return b.apply(this,arguments)};var a=o(r(1485)),s=r(7985);function l(){return(l=i((function*(e,t){var r="bots/".concat(t,"/bot.xml");if(e.files[r]){var n,i=yield null===(n=e.file(r))||void 0===n?void 0:n.async("string"),o=null==i?void 0:i.match(/<name>(.*?)<\/name>/);return o?o[1]:""}return""}))).apply(this,arguments)}function c(){return(c=i((function*(e){var t=null==e?void 0:e.match(/<authenticationmode>(.*?)<\/authenticationmode>/);return t?t[1]:""}))).apply(this,arguments)}function u(e){if(!e)return"1";var t=e.match(/<statecode>(.*?)<\/statecode>/);return t?t[1]:"0"}function p(e,t){var r,n;return null!==(r=null===(n=e.match(new RegExp("<".concat(t,">([\\s\\S]*?)<\\/").concat(t,">"),"i")))||void 0===n?void 0:n[1].trim())&&void 0!==r?r:null}function d(e){return e&&"object"==typeof e?Object.entries(e).map((e=>{var t,r,n,[i,o]=e;return{variableName:i,displayName:null!==(t=null==o?void 0:o.displayName)&&void 0!==t?t:"",description:null!==(r=null==o?void 0:o.description)&&void 0!==r?r:"",type:null!==(n=null==o?void 0:o.type)&&void 0!==n?n:""}})):[]}function f(e){return Array.isArray(e)?e.map((e=>{var t;return{displayName:null!==(t=null==e?void 0:e.displayName)&&void 0!==t?t:"",synonyms:Array.isArray(null==e?void 0:e.synonyms)?e.synonyms:[]}})):[]}function h(e){return m.apply(this,arguments)}function m(){return(m=i((function*(e){var t=new Map;for(var[r]of(Object.keys(e.files).forEach((e=>{if(e.startsWith("bots/")){var[,r,n]=e.split(/\/+/);n&&""!==n&&"bot.xml"===n&&t.set(r,{})}})),t)){var n,i,o,a,s,l,c,u,d,f="bots/".concat(r,"/bot.xml"),h="bots/".concat(r,"/configuration.json"),m=null!==(n=yield null===(i=e.file(f))||void 0===i?void 0:i.async("string"))&&void 0!==n?n:"",g=null!==(o=yield null===(a=e.file(h))||void 0===a?void 0:a.async("string"))&&void 0!==o?o:null,y=g?JSON.parse(g):null,v={botSchemaName:null!==(s=null===(l=m.match(/<bot[^>]+schemaname="([^"]+)"/i))||void 0===l?void 0:l[1])&&void 0!==s?s:r,botDisplayName:null!==(c=p(m,"name"))&&void 0!==c?c:r,authenticationmode:null!==(u=p(m,"authenticationmode"))&&void 0!==u?u:"",botXml:m,botConfig:y,isGenModeEnabled:!(null==y||null===(d=y.settings)||void 0===d||!d.GenerativeActionsEnabled)};t.set(v.botSchemaName,v)}return t}))).apply(this,arguments)}function g(e){return y.apply(this,arguments)}function y(){return(y=i((function*(e){var t=[];Object.keys(e.files).filter((e=>e.endsWith("/botcomponent.xml")&&e.startsWith("botcomponents/"))).forEach((e=>{t.push({})}));for(var r=0;r<t.length;r+=1){var n,i,o,l,c,d,f,h,m,g,y,v=Object.keys(e.files).filter((e=>e.endsWith("/botcomponent.xml")&&e.startsWith("botcomponents/")))[r];if(v){var b=v.slice(0,v.lastIndexOf("/")+1),w=null!==(n=yield null===(i=e.file(v))||void 0===i?void 0:i.async("string"))&&void 0!==n?n:"",E=null!==(o=yield null===(l=e.file("".concat(b,"data")))||void 0===l?void 0:l.async("string"))&&void 0!==o?o:null,N=null!==(c=null===(d=w.match(/<parentbotid>\s*<schemaname>([\s\S]*?)<\/schemaname>/i))||void 0===d?void 0:d[1].trim())&&void 0!==c?c:"UnknownBot",A=Number(null!==(f=p(w,"componenttype"))&&void 0!==f?f:-1),S=p(w,"name"),C=null===(h=w.match(/<botcomponent[^>]+schemaname="([^"]+)"/i))||void 0===h?void 0:h[1],_=C?null!==(m=C.split(".").pop())&&void 0!==m?m:C:"UnknownComponent",T=null;if(E)try{T=a.default.load(E)}catch(e){console.warn("YAML parsing failed for Component Type: "+A+" Component Name: "+S+" in Bot: "+N+"\n",e.message)}var D=(0,s.codeToLabel)(A,null===(g=T)||void 0===g?void 0:g.kind);t[r]={botSchemaName:N,componentType:D,name:null!=S?S:_,description:null!==(y=p(w,"description"))&&void 0!==y?y:"",isEnabled:"0"===u(w),rawXml:w,rawYaml:E,yamlObj:T}}}return t}))).apply(this,arguments)}function v(e,t){var r,n,i,o,a,s,l,c,u,p,h,m,g,y,v,b,w,E,N,A,S,C,_,T,D,I,x,P,k,O,R,L,F,M,U,B,j,z,V,q,H,W,G,Y,X,Z,Q,K,J,$,ee,te,re,ne,ie,oe=new Map;for(var ae of e.values())oe.set(ae.botSchemaName,{botLogicalName:ae.botSchemaName,botDisplayName:ae.botDisplayName,botXml:ae.botXml,botConfig:ae.botConfig,authenticationmode:ae.authenticationmode,isGenModeEnabled:ae.isGenModeEnabled,botComponents:[],topics:[],entities:[],knowledge:[],fileAttachments:[],globalVariables:[],actions:[],skills:[],customGPT:[],externalTriggers:[],copilotSettings:[],translations:[],unknowns:[]});for(var se of t){var le=oe.get(se.botSchemaName);if(le)switch(le.botComponents.push({componentType:se.componentType,name:se.name,botComponentXml:se.rawXml,data:se.yamlObj,description:se.description,isEnabled:se.isEnabled}),se.componentType){case"topic":le.topics.push({name:se.name,rawXml:se.rawXml,rawYamlData:se.rawYaml,modelDescription:null!==(r=null===(n=se.yamlObj)||void 0===n?void 0:n.modelDescription)&&void 0!==r?r:"",triggerQueries:null!==(i=null===(o=se.yamlObj)||void 0===o||null===(o=o.beginDialog)||void 0===o||null===(o=o.intent)||void 0===o?void 0:o.triggerQueries)&&void 0!==i?i:[],inputType:d(null===(a=se.yamlObj)||void 0===a||null===(a=a.inputType)||void 0===a?void 0:a.properties),outputType:d(null===(s=se.yamlObj)||void 0===s||null===(s=s.outputType)||void 0===s?void 0:s.properties),isEnabled:se.isEnabled,description:se.description});break;case"entity":le.entities.push({name:se.name,rawXml:se.rawXml,rawYamlData:se.rawYaml,description:se.description,kind:null!==(l=null===(c=se.yamlObj)||void 0===c?void 0:c.kind)&&void 0!==l?l:"",pattern:"RegexEntity"===(null===(u=se.yamlObj)||void 0===u?void 0:u.kind)&&null!==(p=null===(h=se.yamlObj)||void 0===h?void 0:h.pattern)&&void 0!==p?p:"",items:"ClosedListEntity"===(null===(m=se.yamlObj)||void 0===m?void 0:m.kind)?f(null===(g=se.yamlObj)||void 0===g?void 0:g.items):[],isEnabled:se.isEnabled});break;case"knowledge":le.knowledge.push({name:se.name,description:se.description,isEnabled:se.isEnabled,kind:null!==(y=null===(v=se.yamlObj)||void 0===v?void 0:v.kind)&&void 0!==y?y:"",rawXml:se.rawXml,rawYamlData:se.rawYaml,siteSearchKind:null!==(b=null===(w=se.yamlObj)||void 0===w||null===(w=w.source)||void 0===w?void 0:w.kind)&&void 0!==b?b:"",site:null!==(E=null===(N=se.yamlObj)||void 0===N||null===(N=N.source)||void 0===N?void 0:N.site)&&void 0!==E?E:"",skillConfiguration:null!==(A=null===(S=se.yamlObj)||void 0===S||null===(S=S.source)||void 0===S?void 0:S.skillConfiguration)&&void 0!==A?A:""});break;case"fileAttachment":le.fileAttachments.push({name:se.name,description:se.description,isEnabled:se.isEnabled,rawXml:se.rawXml,rawYamlData:se.rawYaml});break;case"globalVariable":le.globalVariables.push({name:null!==(C=null===(_=se.yamlObj)||void 0===_?void 0:_.name)&&void 0!==C?C:se.name,description:se.description,isEnabled:se.isEnabled,rawXml:se.rawXml,rawYamlData:se.rawYaml,isExternalInitializationAllowed:"boolean"==typeof(null===(T=se.yamlObj)||void 0===T?void 0:T.isExternalInitializationAllowed)?se.yamlObj.isExternalInitializationAllowed:null,scope:null!==(D=null===(I=se.yamlObj)||void 0===I?void 0:I.scope)&&void 0!==D?D:"",aIVisibility:null!==(x=null===(P=se.yamlObj)||void 0===P?void 0:P.aIVisibility)&&void 0!==x?x:"",initializationTimeoutInMilliseconds:"number"==typeof(null===(k=se.yamlObj)||void 0===k?void 0:k.initializationTimeoutInMilliseconds)?se.yamlObj.initializationTimeoutInMilliseconds:null});break;case"action":le.actions.push({name:se.name,rawXml:se.rawXml,rawYamlData:se.rawYaml,description:null!==(O=se.description)&&void 0!==O?O:"",modelDisplayName:null!==(R=null===(L=se.yamlObj)||void 0===L?void 0:L.modelDisplayName)&&void 0!==R?R:"",modelDescription:null!==(F=null===(M=se.yamlObj)||void 0===M?void 0:M.modelDescription)&&void 0!==F?F:"",inputs:Array.isArray(null===(U=se.yamlObj)||void 0===U?void 0:U.inputs)?se.yamlObj.inputs.map((e=>{var t,r,n,i,o,a;return{kind:null!==(t=e.kind)&&void 0!==t?t:"",propertyName:null!==(r=e.propertyName)&&void 0!==r?r:"",name:null!==(n=e.name)&&void 0!==n?n:"",description:null!==(i=e.description)&&void 0!==i?i:"",value:null!==(o=e.value)&&void 0!==o?o:"",entity:null!==(a=e.entity)&&void 0!==a?a:"",shouldPromptUser:e.shouldPromptUser}})):[],outputs:Array.isArray(null===(B=se.yamlObj)||void 0===B?void 0:B.outputs)?se.yamlObj.outputs.map((e=>{var t,r;return{propertyName:null!==(t=e.propertyName)&&void 0!==t?t:"",description:null!==(r=e.description)&&void 0!==r?r:""}})):[],actionKind:null!==(j=null===(z=se.yamlObj)||void 0===z||null===(z=z.action)||void 0===z?void 0:z.kind)&&void 0!==j?j:"",outputMode:null!==(V=null===(q=se.yamlObj)||void 0===q?void 0:q.outputMode)&&void 0!==V?V:"",isEnabled:se.isEnabled});break;case"skill":le.skills.push(se);break;case"customGPT":le.customGPT.push({name:se.name,rawXml:se.rawXml,rawYamlData:se.rawYaml,description:null!==(H=se.description)&&void 0!==H?H:"",isEnabled:se.isEnabled,instructions:null!==(W=null===(G=se.yamlObj)||void 0===G?void 0:G.instructions)&&void 0!==W?W:"",conversationStarters:Array.isArray(null===(Y=se.yamlObj)||void 0===Y?void 0:Y.conversationStarters)?se.yamlObj.conversationStarters.map((e=>{var t,r;return{title:null!==(t=null==e?void 0:e.title)&&void 0!==t?t:"",text:null!==(r=null==e?void 0:e.text)&&void 0!==r?r:""}})):[]});break;case"externalTrigger":le.externalTriggers.push({name:se.name,rawXml:se.rawXml,rawYamlData:se.rawYaml,description:null!==(X=se.description)&&void 0!==X?X:"",isEnabled:se.isEnabled,externalTriggerSourceKind:null!==(Z=null===(Q=se.yamlObj)||void 0===Q||null===(Q=Q.externalTriggerSource)||void 0===Q?void 0:Q.kind)&&void 0!==Z?Z:"",flowId:null!==(K=null===(J=se.yamlObj)||void 0===J||null===(J=J.externalTriggerSource)||void 0===J?void 0:J.flowId)&&void 0!==K?K:"",flowName:null!==($=null===(ee=se.yamlObj)||void 0===ee||null===(ee=ee.extensionData)||void 0===ee?void 0:ee.flowName)&&void 0!==$?$:"",flowUrl:null!==(te=null===(re=se.yamlObj)||void 0===re||null===(re=re.extensionData)||void 0===re?void 0:re.flowUrl)&&void 0!==te?te:"",triggerConnectionType:null!==(ne=null===(ie=se.yamlObj)||void 0===ie||null===(ie=ie.extensionData)||void 0===ie?void 0:ie.triggerConnectionType)&&void 0!==ne?ne:""});break;case"copilotSettings":le.copilotSettings.push(se);break;case"translations":le.translations.push(se);break;default:le.unknowns.push(se)}}return Array.from(oe.values())}function b(){return(b=i((function*(e){var t=v(yield h(e),yield g(e));return console.log("[AGENTS-LIST]",t),{agents:t}}))).apply(this,arguments)}},4573:(e,t,r)=>{"use strict";var n=r(9113),i=Object.prototype.hasOwnProperty,o=Object.prototype.toString;e.exports=new n("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,r,n,a,s,l=[],c=e;for(t=0,r=c.length;t<r;t+=1){if(n=c[t],s=!1,"[object Object]"!==o.call(n))return!1;for(a in n)if(i.call(n,a)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==l.indexOf(a))return!1;l.push(a)}return!0},construct:function(e){return null!==e?e:[]}})},4818:(e,t,r)=>{"use strict";var n=r(9444),i=r(6116),o=r(884),a=r(276),s=Object.prototype.hasOwnProperty,l=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,c=/[\x85\u2028\u2029]/,u=/[,\[\]\{\}]/,p=/^(?:!|!!|![a-z\-]+!)$/i,d=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function f(e){return Object.prototype.toString.call(e)}function h(e){return 10===e||13===e}function m(e){return 9===e||32===e}function g(e){return 9===e||32===e||10===e||13===e}function y(e){return 44===e||91===e||93===e||123===e||125===e}function v(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function b(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?" ":76===e?"\u2028":80===e?"\u2029":""}function w(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var E=new Array(256),N=new Array(256),A=0;A<256;A++)E[A]=b(A)?1:0,N[A]=b(A);function S(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||a,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function C(e,t){var r={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return r.snippet=o(r),new i(t,r)}function _(e,t){throw C(e,t)}function T(e,t){e.onWarning&&e.onWarning.call(null,C(e,t))}var D={YAML:function(e,t,r){var n,i,o;null!==e.version&&_(e,"duplication of %YAML directive"),1!==r.length&&_(e,"YAML directive accepts exactly one argument"),null===(n=/^([0-9]+)\.([0-9]+)$/.exec(r[0]))&&_(e,"ill-formed argument of the YAML directive"),i=parseInt(n[1],10),o=parseInt(n[2],10),1!==i&&_(e,"unacceptable YAML version of the document"),e.version=r[0],e.checkLineBreaks=o<2,1!==o&&2!==o&&T(e,"unsupported YAML version of the document")},TAG:function(e,t,r){var n,i;2!==r.length&&_(e,"TAG directive accepts exactly two arguments"),n=r[0],i=r[1],p.test(n)||_(e,"ill-formed tag handle (first argument) of the TAG directive"),s.call(e.tagMap,n)&&_(e,'there is a previously declared suffix for "'+n+'" tag handle'),d.test(i)||_(e,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch(t){_(e,"tag prefix is malformed: "+i)}e.tagMap[n]=i}};function I(e,t,r,n){var i,o,a,s;if(t<r){if(s=e.input.slice(t,r),n)for(i=0,o=s.length;i<o;i+=1)9===(a=s.charCodeAt(i))||32<=a&&a<=1114111||_(e,"expected valid JSON character");else l.test(s)&&_(e,"the stream contains non-printable characters");e.result+=s}}function x(e,t,r,i){var o,a,l,c;for(n.isObject(r)||_(e,"cannot merge mappings; the provided source object is unacceptable"),l=0,c=(o=Object.keys(r)).length;l<c;l+=1)a=o[l],s.call(t,a)||(t[a]=r[a],i[a]=!0)}function P(e,t,r,n,i,o,a,l,c){var u,p;if(Array.isArray(i))for(u=0,p=(i=Array.prototype.slice.call(i)).length;u<p;u+=1)Array.isArray(i[u])&&_(e,"nested arrays are not supported inside keys"),"object"==typeof i&&"[object Object]"===f(i[u])&&(i[u]="[object Object]");if("object"==typeof i&&"[object Object]"===f(i)&&(i="[object Object]"),i=String(i),null===t&&(t={}),"tag:yaml.org,2002:merge"===n)if(Array.isArray(o))for(u=0,p=o.length;u<p;u+=1)x(e,t,o[u],r);else x(e,t,o,r);else e.json||s.call(r,i)||!s.call(t,i)||(e.line=a||e.line,e.lineStart=l||e.lineStart,e.position=c||e.position,_(e,"duplicated mapping key")),"__proto__"===i?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:o}):t[i]=o,delete r[i];return t}function k(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):_(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function O(e,t,r){for(var n=0,i=e.input.charCodeAt(e.position);0!==i;){for(;m(i);)9===i&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&35===i)do{i=e.input.charCodeAt(++e.position)}while(10!==i&&13!==i&&0!==i);if(!h(i))break;for(k(e),i=e.input.charCodeAt(e.position),n++,e.lineIndent=0;32===i;)e.lineIndent++,i=e.input.charCodeAt(++e.position)}return-1!==r&&0!==n&&e.lineIndent<r&&T(e,"deficient indentation"),n}function R(e){var t,r=e.position;return!(45!==(t=e.input.charCodeAt(r))&&46!==t||t!==e.input.charCodeAt(r+1)||t!==e.input.charCodeAt(r+2)||(r+=3,0!==(t=e.input.charCodeAt(r))&&!g(t)))}function L(e,t){1===t?e.result+=" ":t>1&&(e.result+=n.repeat("\n",t-1))}function F(e,t){var r,n,i=e.tag,o=e.anchor,a=[],s=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=a),n=e.input.charCodeAt(e.position);0!==n&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,_(e,"tab characters must not be used in indentation")),45===n)&&g(e.input.charCodeAt(e.position+1));)if(s=!0,e.position++,O(e,!0,-1)&&e.lineIndent<=t)a.push(null),n=e.input.charCodeAt(e.position);else if(r=e.line,B(e,t,3,!1,!0),a.push(e.result),O(e,!0,-1),n=e.input.charCodeAt(e.position),(e.line===r||e.lineIndent>t)&&0!==n)_(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!s&&(e.tag=i,e.anchor=o,e.kind="sequence",e.result=a,!0)}function M(e){var t,r,n,i,o=!1,a=!1;if(33!==(i=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&_(e,"duplication of a tag property"),60===(i=e.input.charCodeAt(++e.position))?(o=!0,i=e.input.charCodeAt(++e.position)):33===i?(a=!0,r="!!",i=e.input.charCodeAt(++e.position)):r="!",t=e.position,o){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&62!==i);e.position<e.length?(n=e.input.slice(t,e.position),i=e.input.charCodeAt(++e.position)):_(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==i&&!g(i);)33===i&&(a?_(e,"tag suffix cannot contain exclamation marks"):(r=e.input.slice(t-1,e.position+1),p.test(r)||_(e,"named tag handle cannot contain such characters"),a=!0,t=e.position+1)),i=e.input.charCodeAt(++e.position);n=e.input.slice(t,e.position),u.test(n)&&_(e,"tag suffix cannot contain flow indicator characters")}n&&!d.test(n)&&_(e,"tag name cannot contain such characters: "+n);try{n=decodeURIComponent(n)}catch(t){_(e,"tag name is malformed: "+n)}return o?e.tag=n:s.call(e.tagMap,r)?e.tag=e.tagMap[r]+n:"!"===r?e.tag="!"+n:"!!"===r?e.tag="tag:yaml.org,2002:"+n:_(e,'undeclared tag handle "'+r+'"'),!0}function U(e){var t,r;if(38!==(r=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&_(e,"duplication of an anchor property"),r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!g(r)&&!y(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&_(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function B(e,t,r,i,o){var a,l,c,u,p,d,f,b,A,S=1,C=!1,T=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,a=l=c=4===r||3===r,i&&O(e,!0,-1)&&(C=!0,e.lineIndent>t?S=1:e.lineIndent===t?S=0:e.lineIndent<t&&(S=-1)),1===S)for(;M(e)||U(e);)O(e,!0,-1)?(C=!0,c=a,e.lineIndent>t?S=1:e.lineIndent===t?S=0:e.lineIndent<t&&(S=-1)):c=!1;if(c&&(c=C||o),1!==S&&4!==r||(b=1===r||2===r?t:t+1,A=e.position-e.lineStart,1===S?c&&(F(e,A)||function(e,t,r){var n,i,o,a,s,l,c,u=e.tag,p=e.anchor,d={},f=Object.create(null),h=null,y=null,v=null,b=!1,w=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=d),c=e.input.charCodeAt(e.position);0!==c;){if(b||-1===e.firstTabInLine||(e.position=e.firstTabInLine,_(e,"tab characters must not be used in indentation")),n=e.input.charCodeAt(e.position+1),o=e.line,63!==c&&58!==c||!g(n)){if(a=e.line,s=e.lineStart,l=e.position,!B(e,r,2,!1,!0))break;if(e.line===o){for(c=e.input.charCodeAt(e.position);m(c);)c=e.input.charCodeAt(++e.position);if(58===c)g(c=e.input.charCodeAt(++e.position))||_(e,"a whitespace character is expected after the key-value separator within a block mapping"),b&&(P(e,d,f,h,y,null,a,s,l),h=y=v=null),w=!0,b=!1,i=!1,h=e.tag,y=e.result;else{if(!w)return e.tag=u,e.anchor=p,!0;_(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!w)return e.tag=u,e.anchor=p,!0;_(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===c?(b&&(P(e,d,f,h,y,null,a,s,l),h=y=v=null),w=!0,b=!0,i=!0):b?(b=!1,i=!0):_(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,c=n;if((e.line===o||e.lineIndent>t)&&(b&&(a=e.line,s=e.lineStart,l=e.position),B(e,t,4,!0,i)&&(b?y=e.result:v=e.result),b||(P(e,d,f,h,y,v,a,s,l),h=y=v=null),O(e,!0,-1),c=e.input.charCodeAt(e.position)),(e.line===o||e.lineIndent>t)&&0!==c)_(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return b&&P(e,d,f,h,y,null,a,s,l),w&&(e.tag=u,e.anchor=p,e.kind="mapping",e.result=d),w}(e,A,b))||function(e,t){var r,n,i,o,a,s,l,c,u,p,d,f,h=!0,m=e.tag,y=e.anchor,v=Object.create(null);if(91===(f=e.input.charCodeAt(e.position)))a=93,c=!1,o=[];else{if(123!==f)return!1;a=125,c=!0,o={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=o),f=e.input.charCodeAt(++e.position);0!==f;){if(O(e,!0,t),(f=e.input.charCodeAt(e.position))===a)return e.position++,e.tag=m,e.anchor=y,e.kind=c?"mapping":"sequence",e.result=o,!0;h?44===f&&_(e,"expected the node content, but found ','"):_(e,"missed comma between flow collection entries"),d=null,s=l=!1,63===f&&g(e.input.charCodeAt(e.position+1))&&(s=l=!0,e.position++,O(e,!0,t)),r=e.line,n=e.lineStart,i=e.position,B(e,t,1,!1,!0),p=e.tag,u=e.result,O(e,!0,t),f=e.input.charCodeAt(e.position),!l&&e.line!==r||58!==f||(s=!0,f=e.input.charCodeAt(++e.position),O(e,!0,t),B(e,t,1,!1,!0),d=e.result),c?P(e,o,v,p,u,d,r,n,i):s?o.push(P(e,null,v,p,u,d,r,n,i)):o.push(u),O(e,!0,t),44===(f=e.input.charCodeAt(e.position))?(h=!0,f=e.input.charCodeAt(++e.position)):h=!1}_(e,"unexpected end of the stream within a flow collection")}(e,b)?T=!0:(l&&function(e,t){var r,i,o,a,s,l=1,c=!1,u=!1,p=t,d=0,f=!1;if(124===(a=e.input.charCodeAt(e.position)))i=!1;else{if(62!==a)return!1;i=!0}for(e.kind="scalar",e.result="";0!==a;)if(43===(a=e.input.charCodeAt(++e.position))||45===a)1===l?l=43===a?3:2:_(e,"repeat of a chomping mode identifier");else{if(!((o=48<=(s=a)&&s<=57?s-48:-1)>=0))break;0===o?_(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):u?_(e,"repeat of an indentation width identifier"):(p=t+o-1,u=!0)}if(m(a)){do{a=e.input.charCodeAt(++e.position)}while(m(a));if(35===a)do{a=e.input.charCodeAt(++e.position)}while(!h(a)&&0!==a)}for(;0!==a;){for(k(e),e.lineIndent=0,a=e.input.charCodeAt(e.position);(!u||e.lineIndent<p)&&32===a;)e.lineIndent++,a=e.input.charCodeAt(++e.position);if(!u&&e.lineIndent>p&&(p=e.lineIndent),h(a))d++;else{if(e.lineIndent<p){3===l?e.result+=n.repeat("\n",c?1+d:d):1===l&&c&&(e.result+="\n");break}for(i?m(a)?(f=!0,e.result+=n.repeat("\n",c?1+d:d)):f?(f=!1,e.result+=n.repeat("\n",d+1)):0===d?c&&(e.result+=" "):e.result+=n.repeat("\n",d):e.result+=n.repeat("\n",c?1+d:d),c=!0,u=!0,d=0,r=e.position;!h(a)&&0!==a;)a=e.input.charCodeAt(++e.position);I(e,r,e.position,!1)}}return!0}(e,b)||function(e,t){var r,n,i;if(39!==(r=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=i=e.position;0!==(r=e.input.charCodeAt(e.position));)if(39===r){if(I(e,n,e.position,!0),39!==(r=e.input.charCodeAt(++e.position)))return!0;n=e.position,e.position++,i=e.position}else h(r)?(I(e,n,i,!0),L(e,O(e,!1,t)),n=i=e.position):e.position===e.lineStart&&R(e)?_(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);_(e,"unexpected end of the stream within a single quoted scalar")}(e,b)||function(e,t){var r,n,i,o,a,s,l;if(34!==(s=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,r=n=e.position;0!==(s=e.input.charCodeAt(e.position));){if(34===s)return I(e,r,e.position,!0),e.position++,!0;if(92===s){if(I(e,r,e.position,!0),h(s=e.input.charCodeAt(++e.position)))O(e,!1,t);else if(s<256&&E[s])e.result+=N[s],e.position++;else if((a=120===(l=s)?2:117===l?4:85===l?8:0)>0){for(i=a,o=0;i>0;i--)(a=v(s=e.input.charCodeAt(++e.position)))>=0?o=(o<<4)+a:_(e,"expected hexadecimal character");e.result+=w(o),e.position++}else _(e,"unknown escape sequence");r=n=e.position}else h(s)?(I(e,r,n,!0),L(e,O(e,!1,t)),r=n=e.position):e.position===e.lineStart&&R(e)?_(e,"unexpected end of the document within a double quoted scalar"):(e.position++,n=e.position)}_(e,"unexpected end of the stream within a double quoted scalar")}(e,b)?T=!0:function(e){var t,r,n;if(42!==(n=e.input.charCodeAt(e.position)))return!1;for(n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!g(n)&&!y(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&_(e,"name of an alias node must contain at least one character"),r=e.input.slice(t,e.position),s.call(e.anchorMap,r)||_(e,'unidentified alias "'+r+'"'),e.result=e.anchorMap[r],O(e,!0,-1),!0}(e)?(T=!0,null===e.tag&&null===e.anchor||_(e,"alias node should not have any properties")):function(e,t,r){var n,i,o,a,s,l,c,u,p=e.kind,d=e.result;if(g(u=e.input.charCodeAt(e.position))||y(u)||35===u||38===u||42===u||33===u||124===u||62===u||39===u||34===u||37===u||64===u||96===u)return!1;if((63===u||45===u)&&(g(n=e.input.charCodeAt(e.position+1))||r&&y(n)))return!1;for(e.kind="scalar",e.result="",i=o=e.position,a=!1;0!==u;){if(58===u){if(g(n=e.input.charCodeAt(e.position+1))||r&&y(n))break}else if(35===u){if(g(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&R(e)||r&&y(u))break;if(h(u)){if(s=e.line,l=e.lineStart,c=e.lineIndent,O(e,!1,-1),e.lineIndent>=t){a=!0,u=e.input.charCodeAt(e.position);continue}e.position=o,e.line=s,e.lineStart=l,e.lineIndent=c;break}}a&&(I(e,i,o,!1),L(e,e.line-s),i=o=e.position,a=!1),m(u)||(o=e.position+1),u=e.input.charCodeAt(++e.position)}return I(e,i,o,!1),!!e.result||(e.kind=p,e.result=d,!1)}(e,b,1===r)&&(T=!0,null===e.tag&&(e.tag="?")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===S&&(T=c&&F(e,A))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&_(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),u=0,p=e.implicitTypes.length;u<p;u+=1)if((f=e.implicitTypes[u]).resolve(e.result)){e.result=f.construct(e.result),e.tag=f.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(s.call(e.typeMap[e.kind||"fallback"],e.tag))f=e.typeMap[e.kind||"fallback"][e.tag];else for(f=null,u=0,p=(d=e.typeMap.multi[e.kind||"fallback"]).length;u<p;u+=1)if(e.tag.slice(0,d[u].tag.length)===d[u].tag){f=d[u];break}f||_(e,"unknown tag !<"+e.tag+">"),null!==e.result&&f.kind!==e.kind&&_(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+f.kind+'", not "'+e.kind+'"'),f.resolve(e.result,e.tag)?(e.result=f.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):_(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||T}function j(e){var t,r,n,i,o=e.position,a=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(i=e.input.charCodeAt(e.position))&&(O(e,!0,-1),i=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==i));){for(a=!0,i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!g(i);)i=e.input.charCodeAt(++e.position);for(n=[],(r=e.input.slice(t,e.position)).length<1&&_(e,"directive name must not be less than one character in length");0!==i;){for(;m(i);)i=e.input.charCodeAt(++e.position);if(35===i){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&!h(i));break}if(h(i))break;for(t=e.position;0!==i&&!g(i);)i=e.input.charCodeAt(++e.position);n.push(e.input.slice(t,e.position))}0!==i&&k(e),s.call(D,r)?D[r](e,r,n):T(e,'unknown document directive "'+r+'"')}O(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,O(e,!0,-1)):a&&_(e,"directives end mark is expected"),B(e,e.lineIndent-1,4,!1,!0),O(e,!0,-1),e.checkLineBreaks&&c.test(e.input.slice(o,e.position))&&T(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&R(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,O(e,!0,-1)):e.position<e.length-1&&_(e,"end of the stream or a document separator is expected")}function z(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var r=new S(e,t),n=e.indexOf("\0");for(-1!==n&&(r.position=n,_(r,"null byte is not allowed in input")),r.input+="\0";32===r.input.charCodeAt(r.position);)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)j(r);return r.documents}e.exports.loadAll=function(e,t,r){null!==t&&"object"==typeof t&&void 0===r&&(r=t,t=null);var n=z(e,r);if("function"!=typeof t)return n;for(var i=0,o=n.length;i<o;i+=1)t(n[i])},e.exports.load=function(e,t){var r=z(e,t);if(0!==r.length){if(1===r.length)return r[0];throw new i("expected a single document in the stream, but found more")}}},4858:(e,t,r)=>{"use strict";var n=r(9113),i=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),o=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");e.exports=new n("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==i.exec(e)||null!==o.exec(e))},construct:function(e){var t,r,n,a,s,l,c,u,p=0,d=null;if(null===(t=i.exec(e))&&(t=o.exec(e)),null===t)throw new Error("Date resolve error");if(r=+t[1],n=+t[2]-1,a=+t[3],!t[4])return new Date(Date.UTC(r,n,a));if(s=+t[4],l=+t[5],c=+t[6],t[7]){for(p=t[7].slice(0,3);p.length<3;)p+="0";p=+p}return t[9]&&(d=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(d=-d)),u=new Date(Date.UTC(r,n,a,s,l,c,p)),d&&u.setTime(u.getTime()-d),u},instanceOf:Date,represent:function(e){return e.toISOString()}})},5091:(e,t,r)=>{"use strict";var n=r(3715),i=r(6747),o=r(9284),a=r(2112),s=r(7087),l=i.DOMImplementation,c=n.hasDefaultHTMLNamespace,u=n.isHTMLMimeType,p=n.isValidMimeType,d=n.MIME_TYPE,f=n.NAMESPACE,h=o.ParseError,m=s.XMLReader;function g(e){return e.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028\u2029]/g,"\n")}function y(e){if(void 0===(e=e||{}).locator&&(e.locator=!0),this.assign=e.assign||n.assign,this.domHandler=e.domHandler||v,this.onError=e.onError||e.errorHandler,e.errorHandler&&"function"!=typeof e.errorHandler)throw new TypeError("errorHandler object is no longer supported, switch to onError!");e.errorHandler&&e.errorHandler("warning","The `errorHandler` option has been deprecated, use `onError` instead!",this),this.normalizeLineEndings=e.normalizeLineEndings||g,this.locator=!!e.locator,this.xmlns=this.assign(Object.create(null),e.xmlns)}function v(e){var t=e||{};this.mimeType=t.mimeType||d.XML_APPLICATION,this.defaultNamespace=t.defaultNamespace||null,this.cdata=!1,this.currentElement=void 0,this.doc=void 0,this.locator=void 0,this.onError=t.onError}function b(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function w(e,t,r){return"string"==typeof e?e.substr(t,r):e.length>=t+r||t?new java.lang.String(e,t,r)+"":e}function E(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}y.prototype.parseFromString=function(e,t){if(!p(t))throw new TypeError('DOMParser.parseFromString: the provided mimeType "'+t+'" is not valid.');var r=this.assign(Object.create(null),this.xmlns),i=a.XML_ENTITIES,o=r[""]||null;c(t)?(i=a.HTML_ENTITIES,o=f.HTML):t===d.XML_SVG_IMAGE&&(o=f.SVG),r[""]=o,r.xml=r.xml||f.XML;var s=new this.domHandler({mimeType:t,defaultNamespace:o,onError:this.onError}),l=this.locator?{}:void 0;this.locator&&s.setDocumentLocator(l);var u=new m;return u.errorHandler=s,u.domBuilder=s,!n.isHTMLMimeType(t)&&"string"!=typeof e&&u.errorHandler.fatalError("source is not a string"),u.parse(this.normalizeLineEndings(String(e)),r,i),s.doc.documentElement||u.errorHandler.fatalError("missing root element"),s.doc},v.prototype={startDocument:function(){var e=new l;this.doc=u(this.mimeType)?e.createHTMLDocument(!1):e.createDocument(this.defaultNamespace,"")},startElement:function(e,t,r,n){var i=this.doc,o=i.createElementNS(e,r||t),a=n.length;E(this,o),this.currentElement=o,this.locator&&b(this.locator,o);for(var s=0;s<a;s++){e=n.getURI(s);var l=n.getValue(s),c=(r=n.getQName(s),i.createAttributeNS(e,r));this.locator&&b(n.getLocator(s),c),c.value=c.nodeValue=l,o.setAttributeNode(c)}},endElement:function(e,t,r){this.currentElement=this.currentElement.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var r=this.doc.createProcessingInstruction(e,t);this.locator&&b(this.locator,r),E(this,r)},ignorableWhitespace:function(e,t,r){},characters:function(e,t,r){if(e=w.apply(this,arguments)){if(this.cdata)var n=this.doc.createCDATASection(e);else n=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(e)&&this.doc.appendChild(n),this.locator&&b(this.locator,n)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){e&&(e.lineNumber=0),this.locator=e},comment:function(e,t,r){e=w.apply(this,arguments);var n=this.doc.createComment(e);this.locator&&b(this.locator,n),E(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,r,n){var i=this.doc.implementation;if(i&&i.createDocumentType){var o=i.createDocumentType(e,t,r,n);this.locator&&b(this.locator,o),E(this,o),this.doc.doctype=o}},reportError:function(e,t){if("function"==typeof this.onError)try{this.onError(e,t,this)}catch(r){throw new h("Reporting "+e+' "'+t+'" caused '+r,this.locator)}else console.error("[xmldom "+e+"]\t"+t,function(e){if(e)return"\n@#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}(this.locator))},warning:function(e){this.reportError("warning",e)},error:function(e){this.reportError("error",e)},fatalError:function(e){throw this.reportError("fatalError",e),new h(e,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(e){v.prototype[e]=function(){return null}})),t.__DOMHandler=v,t.DOMParser=y,t.normalizeLineEndings=g,t.onErrorStopParsing=function(e){if("error"===e)throw"onErrorStopParsing"},t.onWarningStopParsing=function(){throw"onWarningStopParsing"}},5265:(e,t,r)=>{"use strict";var n=r(9113),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";e.exports=new n("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,r,n=0,o=e.length,a=i;for(r=0;r<o;r++)if(!((t=a.indexOf(e.charAt(r)))>64)){if(t<0)return!1;n+=6}return n%8==0},construct:function(e){var t,r,n=e.replace(/[\r\n=]/g,""),o=n.length,a=i,s=0,l=[];for(t=0;t<o;t++)t%4==0&&t&&(l.push(s>>16&255),l.push(s>>8&255),l.push(255&s)),s=s<<6|a.indexOf(n.charAt(t));return 0==(r=o%4*6)?(l.push(s>>16&255),l.push(s>>8&255),l.push(255&s)):18===r?(l.push(s>>10&255),l.push(s>>2&255)):12===r&&l.push(s>>4&255),new Uint8Array(l)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,r,n="",o=0,a=e.length,s=i;for(t=0;t<a;t++)t%3==0&&t&&(n+=s[o>>18&63],n+=s[o>>12&63],n+=s[o>>6&63],n+=s[63&o]),o=(o<<8)+e[t];return 0==(r=a%3)?(n+=s[o>>18&63],n+=s[o>>12&63],n+=s[o>>6&63],n+=s[63&o]):2===r?(n+=s[o>>10&63],n+=s[o>>4&63],n+=s[o<<2&63],n+=s[64]):1===r&&(n+=s[o>>2&63],n+=s[o<<4&63],n+=s[64],n+=s[64]),n}})},5271:(e,t,r)=>{e.exports=function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[a]={exports:{}};t[a][0].call(c.exports,(function(e){return i(t[a][1][e]||e)}),c,c.exports,e,t,r,n)}return r[a].exports}for(var o=void 0,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){"use strict";var n=e("./utils"),i=e("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e){for(var t,r,i,a,s,l,c,u=[],p=0,d=e.length,f=d,h="string"!==n.getTypeOf(e);p<e.length;)f=d-p,i=h?(t=e[p++],r=p<d?e[p++]:0,p<d?e[p++]:0):(t=e.charCodeAt(p++),r=p<d?e.charCodeAt(p++):0,p<d?e.charCodeAt(p++):0),a=t>>2,s=(3&t)<<4|r>>4,l=1<f?(15&r)<<2|i>>6:64,c=2<f?63&i:64,u.push(o.charAt(a)+o.charAt(s)+o.charAt(l)+o.charAt(c));return u.join("")},r.decode=function(e){var t,r,n,a,s,l,c=0,u=0,p="data:";if(e.substr(0,5)===p)throw new Error("Invalid base64 input, it looks like a data url.");var d,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===o.charAt(64)&&f--,e.charAt(e.length-2)===o.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=i.uint8array?new Uint8Array(0|f):new Array(0|f);c<e.length;)t=o.indexOf(e.charAt(c++))<<2|(a=o.indexOf(e.charAt(c++)))>>4,r=(15&a)<<4|(s=o.indexOf(e.charAt(c++)))>>2,n=(3&s)<<6|(l=o.indexOf(e.charAt(c++))),d[u++]=t,64!==s&&(d[u++]=r),64!==l&&(d[u++]=n);return d}},{"./support":30,"./utils":32}],2:[function(e,t,r){"use strict";var n=e("./external"),i=e("./stream/DataWorker"),o=e("./stream/Crc32Probe"),a=e("./stream/DataLengthProbe");function s(e,t,r,n,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=n,this.compressedContent=i}s.prototype={getContentWorker:function(){var e=new i(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new i(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,r){return e.pipe(new o).pipe(new a("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new a("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,r){"use strict";var n=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,r){"use strict";var n=e("./utils"),i=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==n.getTypeOf(e)?function(e,t,r){var n=i,o=0+r;e^=-1;for(var a=0;a<o;a++)e=e>>>8^n[255&(e^t[a])];return~e}(0|t,e,e.length):function(e,t,r){var n=i,o=0+r;e^=-1;for(var a=0;a<o;a++)e=e>>>8^n[255&(e^t.charCodeAt(a))];return~e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){"use strict";var n;n="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:n}},{lie:37}],7:[function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),o=e("./utils"),a=e("./stream/GenericWorker"),s=n?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}r.magic="\b\0",o.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(s,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},r.compressWorker=function(e){return new l("Deflate",e)},r.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,r){"use strict";function n(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n}function i(e,t,r,i,a,u){var p,d,f=e.file,h=e.compression,m=u!==s.utf8encode,g=o.transformTo("string",u(f.name)),y=o.transformTo("string",s.utf8encode(f.name)),v=f.comment,b=o.transformTo("string",u(v)),w=o.transformTo("string",s.utf8encode(v)),E=y.length!==f.name.length,N=w.length!==v.length,A="",S="",C="",_=f.dir,T=f.date,D={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(D.crc32=e.crc32,D.compressedSize=e.compressedSize,D.uncompressedSize=e.uncompressedSize);var I=0;t&&(I|=8),m||!E&&!N||(I|=2048);var x=0,P=0;_&&(x|=16),"UNIX"===a?(P=798,x|=function(e,t){var r=e;return e||(r=t?16893:33204),(65535&r)<<16}(f.unixPermissions,_)):(P=20,x|=function(e){return 63&(e||0)}(f.dosPermissions)),p=T.getUTCHours(),p<<=6,p|=T.getUTCMinutes(),p<<=5,p|=T.getUTCSeconds()/2,d=T.getUTCFullYear()-1980,d<<=4,d|=T.getUTCMonth()+1,d<<=5,d|=T.getUTCDate(),E&&(S=n(1,1)+n(l(g),4)+y,A+="up"+n(S.length,2)+S),N&&(C=n(1,1)+n(l(b),4)+w,A+="uc"+n(C.length,2)+C);var k="";return k+="\n\0",k+=n(I,2),k+=h.magic,k+=n(p,2),k+=n(d,2),k+=n(D.crc32,4),k+=n(D.compressedSize,4),k+=n(D.uncompressedSize,4),k+=n(g.length,2),k+=n(A.length,2),{fileRecord:c.LOCAL_FILE_HEADER+k+g+A,dirRecord:c.CENTRAL_FILE_HEADER+n(P,2)+k+n(b.length,2)+"\0\0\0\0"+n(x,4)+n(i,4)+g+A+b}}var o=e("../utils"),a=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),c=e("../signature");function u(e,t,r,n){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(u,a),u.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,a.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-n-1))/r:100}}))},u.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=i(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},u.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,r=i(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),t)this.push({data:function(e){return c.DATA_DESCRIPTOR+n(e.crc32,4)+n(e.compressedSize,4)+n(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},u.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r=this.bytesWritten-e,i=function(e,t,r,i,a){var s=o.transformTo("string",a(i));return c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(e,2)+n(e,2)+n(t,4)+n(r,4)+n(s.length,2)+s}(this.dirRecords.length,r,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},u.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},u.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},u.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},u.prototype.error=function(e){var t=this._sources;if(!a.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},u.prototype.lock=function(){a.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=u},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,r){"use strict";var n=e("../compressions"),i=e("./ZipFileWorker");r.generateWorker=function(e,t,r){var o=new i(t.streamFiles,r,t.platform,t.encodeFileName),a=0;try{e.forEach((function(e,r){a++;var i=function(e,t){var r=e||t,i=n[r];if(!i)throw new Error(r+" is not a valid compression method !");return i}(r.options.compression,t.compression),s=r.options.compressionOptions||t.compressionOptions||{},l=r.dir,c=r.date;r._compressWorker(i,s).withStreamInfo("file",{name:e,dir:l,date:c,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(o)})),o.entriesCount=a}catch(e){o.error(e)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,r){"use strict";function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new n;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(e,t){return(new n).loadAsync(e,t)},n.external=e("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,r){"use strict";var n=e("./utils"),i=e("./external"),o=e("./utf8"),a=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new i.Promise((function(t,r){var n=e.decompressed.getContentWorker().pipe(new s);n.on("error",(function(e){r(e)})).on("end",(function(){n.streamInfo.crc32!==e.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var r=this;return t=n.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var r=new a(t);return r.load(e),r})).then((function(e){var r=[i.Promise.resolve(e)],n=e.files;if(t.checkCRC32)for(var o=0;o<n.length;o++)r.push(c(n[o]));return i.Promise.all(r)})).then((function(e){for(var i=e.shift(),o=i.files,a=0;a<o.length;a++){var s=o[a],l=s.fileNameStr,c=n.resolve(s.fileNameStr);r.file(c,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(r.file(c).unsafeOriginalName=l)}return i.zipComment.length&&(r.comment=i.zipComment),r}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,r){"use strict";var n=e("../utils"),i=e("../stream/GenericWorker");function o(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}n.inherits(o,i),o.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},o.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,r){"use strict";var n=e("readable-stream").Readable;function i(e,t,r){n.call(this,t),this._helper=e;var i=this;e.on("data",(function(e,t){i.push(e)||i._helper.pause(),r&&r(t)})).on("error",(function(e){i.emit("error",e)})).on("end",(function(){i.push(null)}))}e("../utils").inherits(i,n),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,r){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,r){"use strict";function n(e,t,r){var n,i=o.getTypeOf(t),s=o.extend(r||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=m(e)),s.createFolders&&(n=h(e))&&g.call(this,n,!0);var p="string"===i&&!1===s.binary&&!1===s.base64;r&&void 0!==r.binary||(s.binary=!p),(t instanceof c&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",i="string");var y;y=t instanceof c||t instanceof a?t:d.isNode&&d.isStream(t)?new f(e,t):o.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var v=new u(e,y,s);this.files[e]=v}var i=e("./utf8"),o=e("./utils"),a=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),u=e("./zipObject"),p=e("./generate"),d=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),h=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||n.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function y(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var v={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,n;for(t in this.files)n=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,n)},filter:function(e){var t=[];return this.forEach((function(r,n){e(r,n)&&t.push(n)})),t},file:function(e,t,r){if(1!==arguments.length)return e=this.root+e,n.call(this,e,t,r),this;if(y(e)){var i=e;return this.filter((function(e,t){return!t.dir&&i.test(e)}))}var o=this.files[this.root+e];return o&&!o.dir?o:null},folder:function(e){if(!e)return this;if(y(e))return this.filter((function(t,r){return r.dir&&e.test(t)}));var t=this.root+e,r=g.call(this,t),n=this.clone();return n.root=r.name,n},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter((function(t,r){return r.name.slice(0,e.length)===e})),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=o.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");o.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var n=r.comment||this.comment||"";t=p.generateWorker(this,r,n)}catch(e){(t=new a("error")).error(e)}return new s(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=v},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,r){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,r){"use strict";var n=e("./DataReader");function i(e){n.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,n),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;0<=o;--o)if(this.data[o]===t&&this.data[o+1]===r&&this.data[o+2]===n&&this.data[o+3]===i)return o-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.readData(4);return t===o[0]&&r===o[1]&&n===o[2]&&i===o[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,r){"use strict";var n=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,r){"use strict";var n=e("./Uint8ArrayReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,r){"use strict";var n=e("./DataReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,r){"use strict";var n=e("./ArrayReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,r){"use strict";var n=e("../utils"),i=e("../support"),o=e("./ArrayReader"),a=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=n.getTypeOf(e);return n.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new s(e):i.uint8array?new l(n.transformTo("uint8array",e)):new o(n.transformTo("array",e)):new a(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,r){"use strict";r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,r){"use strict";var n=e("./GenericWorker"),i=e("../utils");function o(e){n.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(o,n),o.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,r){"use strict";var n=e("./GenericWorker"),i=e("../crc32");function o(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(o,n),o.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./GenericWorker");function o(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}n.inherits(o,i),o.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./GenericWorker");function o(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=n.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}n.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,r){"use strict";function n(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=n},{}],29:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./ConvertWorker"),o=e("./GenericWorker"),a=e("../base64"),s=e("../support"),l=e("../external"),c=null;if(s.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function u(e,t,r){var a=t;switch(t){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=t,this._mimeType=r,n.checkSupport(a),this._worker=e.pipe(new i(a)),e.lock()}catch(e){this._worker=new o("error"),this._worker.error(e)}}u.prototype={accumulate:function(e){return function(e,t){return new l.Promise((function(r,i){var o=[],s=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",(function(e,r){o.push(e),t&&t(r)})).on("error",(function(e){o=[],i(e)})).on("end",(function(){try{var e=function(e,t,r){switch(e){case"blob":return n.newBlob(n.transformTo("arraybuffer",t),r);case"base64":return a.encode(t);default:return n.transformTo(e,t)}}(l,function(e,t){var r,n=0,i=null,o=0;for(r=0;r<t.length;r++)o+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(o),r=0;r<t.length;r++)i.set(t[r],n),n+=t[r].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,o),c);r(e)}catch(e){i(e)}o=[]})).resume()}))}(this,e)},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,(function(e){t.call(r,e.data,e.meta)})):this._worker.on(e,(function(){n.delay(t,arguments,r)})),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(n.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,r){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof Buffer,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=0===new Blob([n],{type:"application/zip"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(n),r.blob=0===i.getBlob("application/zip").size}catch(e){r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch(e){r.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,r){"use strict";for(var n=e("./utils"),i=e("./support"),o=e("./nodejsUtils"),a=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){a.call(this,"utf-8 decode"),this.leftOver=null}function u(){a.call(this,"utf-8 encode")}s[254]=s[254]=1,r.utf8encode=function(e){return i.nodebuffer?o.newBufferFrom(e,"utf-8"):function(e){var t,r,n,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),o=a=0;a<l;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),r<128?t[a++]=r:(r<2048?t[a++]=192|r>>>6:(r<65536?t[a++]=224|r>>>12:(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63),t[a++]=128|r>>>6&63),t[a++]=128|63&r);return t}(e)},r.utf8decode=function(e){return i.nodebuffer?n.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,r,i,o,a=e.length,l=new Array(2*a);for(t=r=0;t<a;)if((i=e[t++])<128)l[r++]=i;else if(4<(o=s[i]))l[r++]=65533,t+=o-1;else{for(i&=2===o?31:3===o?15:7;1<o&&t<a;)i=i<<6|63&e[t++],o--;1<o?l[r++]=65533:i<65536?l[r++]=i:(i-=65536,l[r++]=55296|i>>10&1023,l[r++]=56320|1023&i)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),n.applyFromCharCode(l)}(e=n.transformTo(i.uint8array?"uint8array":"array",e))},n.inherits(c,a),c.prototype.processChunk=function(e){var t=n.transformTo(i.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var o=t;(t=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),t.set(o,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var a=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+s[e[r]]>t?r:t}(t),l=t;a!==t.length&&(i.uint8array?(l=t.subarray(0,a),this.leftOver=t.subarray(a,t.length)):(l=t.slice(0,a),this.leftOver=t.slice(a,t.length))),this.push({data:r.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=c,n.inherits(u,a),u.prototype.processChunk=function(e){this.push({data:r.utf8encode(e.data),meta:e.meta})},r.Utf8EncodeWorker=u},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,r){"use strict";var n=e("./support"),i=e("./base64"),o=e("./nodejsUtils"),a=e("./external");function s(e){return e}function l(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}e("setimmediate"),r.newBlob=function(e,t){r.checkSupport("blob");try{return new Blob([e],{type:t})}catch(r){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(e),n.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,r){var n=[],i=0,o=e.length;if(o<=r)return String.fromCharCode.apply(null,e);for(;i<o;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+r,o)))):n.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+r,o)))),i+=r;return n.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(e){return!1}}()}};function u(e){var t=65536,n=r.getTypeOf(e),i=!0;if("uint8array"===n?i=c.applyCanBeUsed.uint8array:"nodebuffer"===n&&(i=c.applyCanBeUsed.nodebuffer),i)for(;1<t;)try{return c.stringifyByChunk(e,n,t)}catch(e){t=Math.floor(t/2)}return c.stringifyByChar(e)}function p(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}r.applyFromCharCode=u;var d={};d.string={string:s,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return d.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,o.allocBuffer(e.length))}},d.array={string:u,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(e)}},d.arraybuffer={string:function(e){return u(new Uint8Array(e))},array:function(e){return p(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return o.newBufferFrom(new Uint8Array(e))}},d.uint8array={string:u,array:function(e){return p(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return o.newBufferFrom(e)}},d.nodebuffer={string:u,array:function(e){return p(e,new Array(e.length))},arraybuffer:function(e){return d.nodebuffer.uint8array(e).buffer},uint8array:function(e){return p(e,new Uint8Array(e.length))},nodebuffer:s},r.transformTo=function(e,t){if(t=t||"",!e)return t;r.checkSupport(e);var n=r.getTypeOf(t);return d[n][e](t)},r.resolve=function(e){for(var t=e.split("/"),r=[],n=0;n<t.length;n++){var i=t[n];"."===i||""===i&&0!==n&&n!==t.length-1||(".."===i?r.pop():r.push(i))}return r.join("/")},r.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":n.nodebuffer&&o.isBuffer(e)?"nodebuffer":n.uint8array&&e instanceof Uint8Array?"uint8array":n.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(e){if(!n[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},r.delay=function(e,t,r){setImmediate((function(){e.apply(r||null,t||[])}))},r.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r},r.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},r.prepareContent=function(e,t,o,s,c){return a.Promise.resolve(t).then((function(e){return n.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new a.Promise((function(t,r){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(e){r(e.target.error)},n.readAsArrayBuffer(e)})):e})).then((function(t){var u=r.getTypeOf(t);return u?("arraybuffer"===u?t=r.transformTo("uint8array",t):"string"===u&&(c?t=i.decode(t):o&&!0!==s&&(t=function(e){return l(e,n.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):a.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),i=e("./utils"),o=e("./signature"),a=e("./zipEntry"),s=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",r=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=t-r;if(0<n)this.isSignature(t,o.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){this.reader=n(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),i=e("./utils"),o=e("./compressedObject"),a=e("./crc32"),s=e("./utf8"),l=e("./compressions"),c=e("./support");function u(e,t){this.options=e,this.loadOptions=t}u.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,n,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[t]={id:t,length:r,value:n};e.setIndex(i)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var o=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=n(e.value);return 1!==t.readInt(1)||a(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=n(e.value);return 1!==t.readInt(1)||a(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=u},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,r){"use strict";function n(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var i=e("./stream/StreamHelper"),o=e("./stream/DataWorker"),a=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");n.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var o=!this._dataBinary;o&&!n&&(t=t.pipe(new a.Utf8EncodeWorker)),!o&&n&&(t=t.pipe(new a.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new i(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new a.Utf8EncodeWorker)),s.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new o(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},p=0;p<c.length;p++)n.prototype[c[p]]=u;t.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){(function(e){"use strict";var r,n,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var o=0,a=new i(u),s=e.document.createTextNode("");a.observe(s,{characterData:!0}),r=function(){s.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};else{var l=new e.MessageChannel;l.port1.onmessage=u,r=function(){l.port2.postMessage(0)}}var c=[];function u(){var e,t;n=!0;for(var r=c.length;r;){for(t=c,c=[],e=-1;++e<r;)t[e]();r=c.length}n=!1}t.exports=function(e){1!==c.push(e)||n||r()}}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,r){"use strict";var n=e("immediate");function i(){}var o={},a=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&f(this,e)}function u(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function p(e,t,r){n((function(){var n;try{n=t(r)}catch(n){return o.reject(e,n)}n===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,n)}))}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var r=!1;function n(t){r||(r=!0,o.reject(e,t))}function i(t){r||(r=!0,o.resolve(e,t))}var a=h((function(){t(i,n)}));"error"===a.status&&n(a.value)}function h(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){throw r}))}))},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===a)return this;var r=new this.constructor(i);return this.state!==l?p(r,this.state===s?e:t,this.outcome):this.queue.push(new u(r,e,t)),r},u.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){p(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){o.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){p(this.promise,this.onRejected,e)},o.resolve=function(e,t){var r=h(d,t);if("error"===r.status)return o.reject(e,r.value);var n=r.value;if(n)f(e,n);else{e.state=s,e.outcome=t;for(var i=-1,a=e.queue.length;++i<a;)e.queue[i].callFulfilled(t)}return e},o.reject=function(e,t){e.state=a,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:o.resolve(new this(i),e)},c.reject=function(e){var t=new this(i);return o.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var a=new Array(r),s=0,l=-1,c=new this(i);++l<r;)u(e[l],l);return c;function u(e,i){t.resolve(e).then((function(e){a[i]=e,++s!==r||n||(n=!0,o.resolve(c,a))}),(function(e){n||(n=!0,o.reject(c,e))}))}},c.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,r=!1;if(!t)return this.resolve([]);for(var n,a=-1,s=new this(i);++a<t;)n=e[a],this.resolve(n).then((function(e){r||(r=!0,o.resolve(s,e))}),(function(e){r||(r=!0,o.reject(s,e))}));return s}},{immediate:36}],38:[function(e,t,r){"use strict";var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,r){"use strict";var n=e("./zlib/deflate"),i=e("./utils/common"),o=e("./utils/strings"),a=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString;function c(e){if(!(this instanceof c))return new c(e);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==r)throw new Error(a[r]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){var u;if(u="string"==typeof t.dictionary?o.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(r=n.deflateSetDictionary(this.strm,u)))throw new Error(a[r]);this._dict_set=!0}}function u(e,t){var r=new c(t);if(r.push(e,!0),r.err)throw r.msg||a[r.err];return r.result}c.prototype.push=function(e,t){var r,a,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=o.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(c),s.next_out=0,s.avail_out=c),1!==(r=n.deflate(s,a))&&0!==r)return this.onEnd(r),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(o.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==r);return 4===a?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,0===r):2!==a||(this.onEnd(0),!(s.avail_out=0))},c.prototype.onData=function(e){this.chunks.push(e)},c.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=c,r.deflate=u,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,u(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,r){"use strict";var n=e("./zlib/inflate"),i=e("./utils/common"),o=e("./utils/strings"),a=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),u=Object.prototype.toString;function p(e){if(!(this instanceof p))return new p(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==a.Z_OK)throw new Error(s[r]);this.header=new c,n.inflateGetHeader(this.strm,this.header)}function d(e,t){var r=new p(t);if(r.push(e,!0),r.err)throw r.msg||s[r.err];return r.result}p.prototype.push=function(e,t){var r,s,l,c,p,d,f=this.strm,h=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?f.input=o.binstring2buf(e):"[object ArrayBuffer]"===u.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(h),f.next_out=0,f.avail_out=h),(r=n.inflate(f,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&m&&(d="string"==typeof m?o.string2buf(m):"[object ArrayBuffer]"===u.call(m)?new Uint8Array(m):m,r=n.inflateSetDictionary(this.strm,d)),r===a.Z_BUF_ERROR&&!0===g&&(r=a.Z_OK,g=!1),r!==a.Z_STREAM_END&&r!==a.Z_OK)return this.onEnd(r),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&r!==a.Z_STREAM_END&&(0!==f.avail_in||s!==a.Z_FINISH&&s!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(f.output,f.next_out),c=f.next_out-l,p=o.buf2string(f.output,l),f.next_out=c,f.avail_out=h-c,c&&i.arraySet(f.output,f.output,l,c,0),this.onData(p)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(g=!0)}while((0<f.avail_in||0===f.avail_out)&&r!==a.Z_STREAM_END);return r===a.Z_STREAM_END&&(s=a.Z_FINISH),s===a.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===a.Z_OK):s!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),!(f.avail_out=0))},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=p,r.inflate=d,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,d(e,t)},r.ungzip=d},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(t=n=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),t=i=0,r=e.length;t<r;t++)o=e[t],a.set(o,i),i+=o.length;return a}},o={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(n)},{}],42:[function(e,t,r){"use strict";var n=e("./common"),i=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var a=new n.Buf8(256),s=0;s<256;s++)a[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r}a[254]=a[254]=1,r.string2buf=function(e){var t,r,i,o,a,s=e.length,l=0;for(o=0;o<s;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(l),o=a=0;a<l;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(i-56320),o++),r<128?t[a++]=r:(r<2048?t[a++]=192|r>>>6:(r<65536?t[a++]=224|r>>>12:(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63),t[a++]=128|r>>>6&63),t[a++]=128|63&r);return t},r.buf2binstring=function(e){return l(e,e.length)},r.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,i=t.length;r<i;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,n,i,o,s=t||e.length,c=new Array(2*s);for(r=n=0;r<s;)if((i=e[r++])<128)c[n++]=i;else if(4<(o=a[i]))c[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;1<o&&r<s;)i=i<<6|63&e[r++],o--;1<o?c[n++]=65533:i<65536?c[n++]=i:(i-=65536,c[n++]=55296|i>>10&1023,c[n++]=56320|1023&i)}return l(c,n)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+a[e[r]]>t?r:t}},{"./common":41}],43:[function(e,t,r){"use strict";t.exports=function(e,t,r,n){for(var i=65535&e,o=e>>>16&65535,a=0;0!==r;){for(r-=a=2e3<r?2e3:r;o=o+(i=i+t[n++]|0)|0,--a;);i%=65521,o%=65521}return i|o<<16}},{}],44:[function(e,t,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,r){"use strict";var n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,i){var o=n,a=i+r;e^=-1;for(var s=i;s<a;s++)e=e>>>8^o[255&(e^t[s])];return~e}},{}],46:[function(e,t,r){"use strict";var n,i=e("../utils/common"),o=e("./trees"),a=e("./adler32"),s=e("./crc32"),l=e("./messages"),c=-2,u=258,p=262,d=113;function f(e,t){return e.msg=l[t],t}function h(e){return(e<<1)-(4<e?9:0)}function m(e){for(var t=e.length;0<=--t;)e[t]=0}function g(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(i.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function y(e,t){o._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,g(e.strm)}function v(e,t){e.pending_buf[e.pending++]=t}function b(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function w(e,t){var r,n,i=e.max_chain_length,o=e.strstart,a=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-p?e.strstart-(e.w_size-p):0,c=e.window,d=e.w_mask,f=e.prev,h=e.strstart+u,m=c[o+a-1],g=c[o+a];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(r=t)+a]===g&&c[r+a-1]===m&&c[r]===c[o]&&c[++r]===c[o+1]){o+=2,r++;do{}while(c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&o<h);if(n=u-(h-o),o=h-u,a<n){if(e.match_start=t,s<=(a=n))break;m=c[o+a-1],g=c[o+a]}}}while((t=f[t&d])>l&&0!=--i);return a<=e.lookahead?a:e.lookahead}function E(e){var t,r,n,o,l,c,u,d,f,h,m=e.w_size;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-p)){for(i.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=r=e.hash_size;n=e.head[--t],e.head[t]=m<=n?n-m:0,--r;);for(t=r=m;n=e.prev[--t],e.prev[t]=m<=n?n-m:0,--r;);o+=m}if(0===e.strm.avail_in)break;if(c=e.strm,u=e.window,d=e.strstart+e.lookahead,h=void 0,(f=o)<(h=c.avail_in)&&(h=f),r=0===h?0:(c.avail_in-=h,i.arraySet(u,c.input,c.next_in,h,d),1===c.state.wrap?c.adler=a(c.adler,u,h,d):2===c.state.wrap&&(c.adler=s(c.adler,u,h,d)),c.next_in+=h,c.total_in+=h,h),e.lookahead+=r,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<p&&0!==e.strm.avail_in)}function N(e,t){for(var r,n;;){if(e.lookahead<p){if(E(e),e.lookahead<p&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-p&&(e.match_length=w(e,r)),e.match_length>=3)if(n=o._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function A(e,t){for(var r,n,i;;){if(e.lookahead<p){if(E(e),e.lookahead<p&&0===t)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-p&&(e.match_length=w(e,r),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-3,n=o._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(y(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=o._tr_tally(e,0,e.window[e.strstart-1]))&&y(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=o._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function S(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function C(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),m(this.dyn_ltree),m(this.dyn_dtree),m(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),m(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),m(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:d,e.adler=2===t.wrap?0:1,t.last_flush=0,o._tr_init(t),0):f(e,c)}function T(e){var t=_(e);return 0===t&&function(e){e.window_size=2*e.w_size,m(e.head),e.max_lazy_match=n[e.level].max_lazy,e.good_match=n[e.level].good_length,e.nice_match=n[e.level].nice_length,e.max_chain_length=n[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0}(e.state),t}function D(e,t,r,n,o,a){if(!e)return c;var s=1;if(-1===t&&(t=6),n<0?(s=0,n=-n):15<n&&(s=2,n-=16),o<1||9<o||8!==r||n<8||15<n||t<0||9<t||a<0||4<a)return f(e,c);8===n&&(n=9);var l=new C;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=r,T(e)}n=[new S(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(E(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,y(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-p&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(y(e,!1),e.strm.avail_out),1)})),new S(4,4,8,4,N),new S(4,5,16,8,N),new S(4,6,32,32,N),new S(4,4,16,16,A),new S(8,16,32,32,A),new S(8,16,128,128,A),new S(8,32,128,256,A),new S(32,128,258,1024,A),new S(32,258,258,4096,A)],r.deflateInit=function(e,t){return D(e,t,8,15,8,0)},r.deflateInit2=D,r.deflateReset=T,r.deflateResetKeep=_,r.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?c:(e.state.gzhead=t,0):c},r.deflate=function(e,t){var r,i,a,l;if(!e||!e.state||5<t||t<0)return e?f(e,c):c;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&4!==t)return f(e,0===e.avail_out?-5:c);if(i.strm=e,r=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,v(i,31),v(i,139),v(i,8),i.gzhead?(v(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),v(i,255&i.gzhead.time),v(i,i.gzhead.time>>8&255),v(i,i.gzhead.time>>16&255),v(i,i.gzhead.time>>24&255),v(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),v(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(v(i,255&i.gzhead.extra.length),v(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(v(i,0),v(i,0),v(i,0),v(i,0),v(i,0),v(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),v(i,3),i.status=d);else{var p=8+(i.w_bits-8<<4)<<8;p|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(p|=32),p+=31-p%31,i.status=d,b(i,p),0!==i.strstart&&(b(i,e.adler>>>16),b(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),g(e),a=i.pending,i.pending!==i.pending_buf_size));)v(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),g(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,v(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),g(e),a=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,v(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>a&&(e.adler=s(e.adler,i.pending_buf,i.pending-a,a)),0===l&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&g(e),i.pending+2<=i.pending_buf_size&&(v(i,255&e.adler),v(i,e.adler>>8&255),e.adler=0,i.status=d)):i.status=d),0!==i.pending){if(g(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&h(t)<=h(r)&&4!==t)return f(e,-5);if(666===i.status&&0!==e.avail_in)return f(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&666!==i.status){var w=2===i.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(E(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var r,n,i,a,s=e.window;;){if(e.lookahead<=u){if(E(e),e.lookahead<=u&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(n=s[i=e.strstart-1])===s[++i]&&n===s[++i]&&n===s[++i]){a=e.strstart+u;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<a);e.match_length=u-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=o._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=o._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(i,t):n[i.level].func(i,t);if(3!==w&&4!==w||(i.status=666),1===w||3===w)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===w&&(1===t?o._tr_align(i):5!==t&&(o._tr_stored_block(i,0,0,!1),3===t&&(m(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),g(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(v(i,255&e.adler),v(i,e.adler>>8&255),v(i,e.adler>>16&255),v(i,e.adler>>24&255),v(i,255&e.total_in),v(i,e.total_in>>8&255),v(i,e.total_in>>16&255),v(i,e.total_in>>24&255)):(b(i,e.adler>>>16),b(i,65535&e.adler)),g(e),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?0:1)},r.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&t!==d&&666!==t?f(e,c):(e.state=null,t===d?f(e,-3):0):c},r.deflateSetDictionary=function(e,t){var r,n,o,s,l,u,p,d,f=t.length;if(!e||!e.state)return c;if(2===(s=(r=e.state).wrap)||1===s&&42!==r.status||r.lookahead)return c;for(1===s&&(e.adler=a(e.adler,t,f,0)),r.wrap=0,f>=r.w_size&&(0===s&&(m(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new i.Buf8(r.w_size),i.arraySet(d,t,f-r.w_size,r.w_size,0),t=d,f=r.w_size),l=e.avail_in,u=e.next_in,p=e.input,e.avail_in=f,e.next_in=0,e.input=t,E(r);r.lookahead>=3;){for(n=r.strstart,o=r.lookahead-2;r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+3-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++,--o;);r.strstart=n,r.lookahead=2,E(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=u,e.input=p,e.avail_in=l,r.wrap=s,0},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,r){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n,i,o,a,s,l,c,u,p,d,f,h,m,g,y,v,b,w,E,N,A,S,C,_;r=e.state,n=e.next_in,C=e.input,i=n+(e.avail_in-5),o=e.next_out,_=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),l=r.dmax,c=r.wsize,u=r.whave,p=r.wnext,d=r.window,f=r.hold,h=r.bits,m=r.lencode,g=r.distcode,y=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{h<15&&(f+=C[n++]<<h,h+=8,f+=C[n++]<<h,h+=8),b=m[f&y];t:for(;;){if(f>>>=w=b>>>24,h-=w,0==(w=b>>>16&255))_[o++]=65535&b;else{if(!(16&w)){if(!(64&w)){b=m[(65535&b)+(f&(1<<w)-1)];continue t}if(32&w){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}E=65535&b,(w&=15)&&(h<w&&(f+=C[n++]<<h,h+=8),E+=f&(1<<w)-1,f>>>=w,h-=w),h<15&&(f+=C[n++]<<h,h+=8,f+=C[n++]<<h,h+=8),b=g[f&v];r:for(;;){if(f>>>=w=b>>>24,h-=w,!(16&(w=b>>>16&255))){if(!(64&w)){b=g[(65535&b)+(f&(1<<w)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(N=65535&b,h<(w&=15)&&(f+=C[n++]<<h,(h+=8)<w&&(f+=C[n++]<<h,h+=8)),l<(N+=f&(1<<w)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(f>>>=w,h-=w,(w=o-a)<N){if(u<(w=N-w)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(S=d,(A=0)===p){if(A+=c-w,w<E){for(E-=w;_[o++]=d[A++],--w;);A=o-N,S=_}}else if(p<w){if(A+=c+p-w,(w-=p)<E){for(E-=w;_[o++]=d[A++],--w;);if(A=0,p<E){for(E-=w=p;_[o++]=d[A++],--w;);A=o-N,S=_}}}else if(A+=p-w,w<E){for(E-=w;_[o++]=d[A++],--w;);A=o-N,S=_}for(;2<E;)_[o++]=S[A++],_[o++]=S[A++],_[o++]=S[A++],E-=3;E&&(_[o++]=S[A++],1<E&&(_[o++]=S[A++]))}else{for(A=o-N;_[o++]=_[A++],_[o++]=_[A++],_[o++]=_[A++],2<(E-=3););E&&(_[o++]=_[A++],1<E&&(_[o++]=_[A++]))}break}}break}}while(n<i&&o<s);n-=E=h>>3,f&=(1<<(h-=E<<3))-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<s?s-o+257:257-(o-s),r.hold=f,r.bits=h}},{}],49:[function(e,t,r){"use strict";var n=e("../utils/common"),i=e("./adler32"),o=e("./crc32"),a=e("./inffast"),s=e("./inftrees"),l=-2;function c(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function u(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function p(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(852),t.distcode=t.distdyn=new n.Buf32(592),t.sane=1,t.back=-1,0):l}function d(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,p(e)):l}function f(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?l:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,d(e))):l}function h(e,t){var r,n;return e?(n=new u,(e.state=n).window=null,0!==(r=f(e,t))&&(e.state=null),r):l}var m,g,y=!0;function v(e){if(y){var t;for(m=new n.Buf32(512),g=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,m,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,g,0,e.work,{bits:5}),y=!1}e.lencode=m,e.lenbits=9,e.distcode=g,e.distbits=5}function b(e,t,r,i){var o,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new n.Buf8(a.wsize)),i>=a.wsize?(n.arraySet(a.window,t,r-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):(i<(o=a.wsize-a.wnext)&&(o=i),n.arraySet(a.window,t,r-i,o,a.wnext),(i-=o)?(n.arraySet(a.window,t,r-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0}r.inflateReset=d,r.inflateReset2=f,r.inflateResetKeep=p,r.inflateInit=function(e){return h(e,15)},r.inflateInit2=h,r.inflate=function(e,t){var r,u,p,d,f,h,m,g,y,w,E,N,A,S,C,_,T,D,I,x,P,k,O,R,L=0,F=new n.Buf8(4),M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;12===(r=e.state).mode&&(r.mode=13),f=e.next_out,p=e.output,m=e.avail_out,d=e.next_in,u=e.input,h=e.avail_in,g=r.hold,y=r.bits,w=h,E=m,k=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;y<16;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}if(2&r.wrap&&35615===g){F[r.check=0]=255&g,F[1]=g>>>8&255,r.check=o(r.check,F,2,0),y=g=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&g)){e.msg="unknown compression method",r.mode=30;break}if(y-=4,P=8+(15&(g>>>=4)),0===r.wbits)r.wbits=P;else if(P>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<P,e.adler=r.check=1,r.mode=512&g?10:12,y=g=0;break;case 2:for(;y<16;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}if(r.flags=g,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=g>>8&1),512&r.flags&&(F[0]=255&g,F[1]=g>>>8&255,r.check=o(r.check,F,2,0)),y=g=0,r.mode=3;case 3:for(;y<32;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}r.head&&(r.head.time=g),512&r.flags&&(F[0]=255&g,F[1]=g>>>8&255,F[2]=g>>>16&255,F[3]=g>>>24&255,r.check=o(r.check,F,4,0)),y=g=0,r.mode=4;case 4:for(;y<16;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}r.head&&(r.head.xflags=255&g,r.head.os=g>>8),512&r.flags&&(F[0]=255&g,F[1]=g>>>8&255,r.check=o(r.check,F,2,0)),y=g=0,r.mode=5;case 5:if(1024&r.flags){for(;y<16;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}r.length=g,r.head&&(r.head.extra_len=g),512&r.flags&&(F[0]=255&g,F[1]=g>>>8&255,r.check=o(r.check,F,2,0)),y=g=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(h<(N=r.length)&&(N=h),N&&(r.head&&(P=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,u,d,N,P)),512&r.flags&&(r.check=o(r.check,u,N,d)),h-=N,d+=N,r.length-=N),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===h)break e;for(N=0;P=u[d+N++],r.head&&P&&r.length<65536&&(r.head.name+=String.fromCharCode(P)),P&&N<h;);if(512&r.flags&&(r.check=o(r.check,u,N,d)),h-=N,d+=N,P)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===h)break e;for(N=0;P=u[d+N++],r.head&&P&&r.length<65536&&(r.head.comment+=String.fromCharCode(P)),P&&N<h;);if(512&r.flags&&(r.check=o(r.check,u,N,d)),h-=N,d+=N,P)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;y<16;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}if(g!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}y=g=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;y<32;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}e.adler=r.check=c(g),y=g=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=f,e.avail_out=m,e.next_in=d,e.avail_in=h,r.hold=g,r.bits=y,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){g>>>=7&y,y-=7&y,r.mode=27;break}for(;y<3;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}switch(r.last=1&g,y-=1,3&(g>>>=1)){case 0:r.mode=14;break;case 1:if(v(r),r.mode=20,6!==t)break;g>>>=2,y-=2;break e;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}g>>>=2,y-=2;break;case 14:for(g>>>=7&y,y-=7&y;y<32;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&g,y=g=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(N=r.length){if(h<N&&(N=h),m<N&&(N=m),0===N)break e;n.arraySet(p,u,d,N,f),h-=N,d+=N,m-=N,f+=N,r.length-=N;break}r.mode=12;break;case 17:for(;y<14;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}if(r.nlen=257+(31&g),g>>>=5,y-=5,r.ndist=1+(31&g),g>>>=5,y-=5,r.ncode=4+(15&g),g>>>=4,y-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;y<3;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}r.lens[M[r.have++]]=7&g,g>>>=3,y-=3}for(;r.have<19;)r.lens[M[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,O={bits:r.lenbits},k=s(0,r.lens,0,19,r.lencode,0,r.work,O),r.lenbits=O.bits,k){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;_=(L=r.lencode[g&(1<<r.lenbits)-1])>>>16&255,T=65535&L,!((C=L>>>24)<=y);){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}if(T<16)g>>>=C,y-=C,r.lens[r.have++]=T;else{if(16===T){for(R=C+2;y<R;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}if(g>>>=C,y-=C,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}P=r.lens[r.have-1],N=3+(3&g),g>>>=2,y-=2}else if(17===T){for(R=C+3;y<R;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}y-=C,P=0,N=3+(7&(g>>>=C)),g>>>=3,y-=3}else{for(R=C+7;y<R;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}y-=C,P=0,N=11+(127&(g>>>=C)),g>>>=7,y-=7}if(r.have+N>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;N--;)r.lens[r.have++]=P}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,O={bits:r.lenbits},k=s(1,r.lens,0,r.nlen,r.lencode,0,r.work,O),r.lenbits=O.bits,k){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,O={bits:r.distbits},k=s(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,O),r.distbits=O.bits,k){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=h&&258<=m){e.next_out=f,e.avail_out=m,e.next_in=d,e.avail_in=h,r.hold=g,r.bits=y,a(e,E),f=e.next_out,p=e.output,m=e.avail_out,d=e.next_in,u=e.input,h=e.avail_in,g=r.hold,y=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;_=(L=r.lencode[g&(1<<r.lenbits)-1])>>>16&255,T=65535&L,!((C=L>>>24)<=y);){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}if(_&&!(240&_)){for(D=C,I=_,x=T;_=(L=r.lencode[x+((g&(1<<D+I)-1)>>D)])>>>16&255,T=65535&L,!(D+(C=L>>>24)<=y);){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}g>>>=D,y-=D,r.back+=D}if(g>>>=C,y-=C,r.back+=C,r.length=T,0===_){r.mode=26;break}if(32&_){r.back=-1,r.mode=12;break}if(64&_){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&_,r.mode=22;case 22:if(r.extra){for(R=r.extra;y<R;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}r.length+=g&(1<<r.extra)-1,g>>>=r.extra,y-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;_=(L=r.distcode[g&(1<<r.distbits)-1])>>>16&255,T=65535&L,!((C=L>>>24)<=y);){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}if(!(240&_)){for(D=C,I=_,x=T;_=(L=r.distcode[x+((g&(1<<D+I)-1)>>D)])>>>16&255,T=65535&L,!(D+(C=L>>>24)<=y);){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}g>>>=D,y-=D,r.back+=D}if(g>>>=C,y-=C,r.back+=C,64&_){e.msg="invalid distance code",r.mode=30;break}r.offset=T,r.extra=15&_,r.mode=24;case 24:if(r.extra){for(R=r.extra;y<R;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}r.offset+=g&(1<<r.extra)-1,g>>>=r.extra,y-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===m)break e;if(N=E-m,r.offset>N){if((N=r.offset-N)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}A=N>r.wnext?(N-=r.wnext,r.wsize-N):r.wnext-N,N>r.length&&(N=r.length),S=r.window}else S=p,A=f-r.offset,N=r.length;for(m<N&&(N=m),m-=N,r.length-=N;p[f++]=S[A++],--N;);0===r.length&&(r.mode=21);break;case 26:if(0===m)break e;p[f++]=r.length,m--,r.mode=21;break;case 27:if(r.wrap){for(;y<32;){if(0===h)break e;h--,g|=u[d++]<<y,y+=8}if(E-=m,e.total_out+=E,r.total+=E,E&&(e.adler=r.check=r.flags?o(r.check,p,E,f-E):i(r.check,p,E,f-E)),E=m,(r.flags?g:c(g))!==r.check){e.msg="incorrect data check",r.mode=30;break}y=g=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;y<32;){if(0===h)break e;h--,g+=u[d++]<<y,y+=8}if(g!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}y=g=0}r.mode=29;case 29:k=1;break e;case 30:k=-3;break e;case 31:return-4;default:return l}return e.next_out=f,e.avail_out=m,e.next_in=d,e.avail_in=h,r.hold=g,r.bits=y,(r.wsize||E!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&b(e,e.output,e.next_out,E-e.avail_out)?(r.mode=31,-4):(w-=e.avail_in,E-=e.avail_out,e.total_in+=w,e.total_out+=E,r.total+=E,r.wrap&&E&&(e.adler=r.check=r.flags?o(r.check,p,E,e.next_out-E):i(r.check,p,E,e.next_out-E)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==w&&0===E||4===t)&&0===k&&(k=-5),k)},r.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},r.inflateGetHeader=function(e,t){var r;return e&&e.state&&2&(r=e.state).wrap?((r.head=t).done=!1,0):l},r.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?l:11===r.mode&&i(1,t,n,0)!==r.check?-3:b(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,0):l},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,r){"use strict";var n=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,l,c,u,p,d){var f,h,m,g,y,v,b,w,E,N=d.bits,A=0,S=0,C=0,_=0,T=0,D=0,I=0,x=0,P=0,k=0,O=null,R=0,L=new n.Buf16(16),F=new n.Buf16(16),M=null,U=0;for(A=0;A<=15;A++)L[A]=0;for(S=0;S<l;S++)L[t[r+S]]++;for(T=N,_=15;1<=_&&0===L[_];_--);if(_<T&&(T=_),0===_)return c[u++]=20971520,c[u++]=20971520,d.bits=1,0;for(C=1;C<_&&0===L[C];C++);for(T<C&&(T=C),A=x=1;A<=15;A++)if(x<<=1,(x-=L[A])<0)return-1;if(0<x&&(0===e||1!==_))return-1;for(F[1]=0,A=1;A<15;A++)F[A+1]=F[A]+L[A];for(S=0;S<l;S++)0!==t[r+S]&&(p[F[t[r+S]]++]=S);if(v=0===e?(O=M=p,19):1===e?(O=i,R-=257,M=o,U-=257,256):(O=a,M=s,-1),A=C,y=u,I=S=k=0,m=-1,g=(P=1<<(D=T))-1,1===e&&852<P||2===e&&592<P)return 1;for(;;){for(b=A-I,E=p[S]<v?(w=0,p[S]):p[S]>v?(w=M[U+p[S]],O[R+p[S]]):(w=96,0),f=1<<A-I,C=h=1<<D;c[y+(k>>I)+(h-=f)]=b<<24|w<<16|E,0!==h;);for(f=1<<A-1;k&f;)f>>=1;if(0!==f?(k&=f-1,k+=f):k=0,S++,0==--L[A]){if(A===_)break;A=t[r+p[S]]}if(T<A&&(k&g)!==m){for(0===I&&(I=T),y+=C,x=1<<(D=A-I);D+I<_&&!((x-=L[D+I])<=0);)D++,x<<=1;if(P+=1<<D,1===e&&852<P||2===e&&592<P)return 1;c[m=k&g]=T<<24|D<<16|y-u}}return 0!==k&&(c[y+k]=A-I<<24|64<<16),d.bits=T,0}},{"../utils/common":41}],51:[function(e,t,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,r){"use strict";var n=e("../utils/common");function i(e){for(var t=e.length;0<=--t;)e[t]=0}var o=256,a=286,s=30,l=15,c=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],u=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],p=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],d=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array(576);i(f);var h=new Array(60);i(h);var m=new Array(512);i(m);var g=new Array(256);i(g);var y=new Array(29);i(y);var v,b,w,E=new Array(s);function N(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function A(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function S(e){return e<256?m[e]:m[256+(e>>>7)]}function C(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function _(e,t,r){e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,C(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function T(e,t,r){_(e,r[2*t],r[2*t+1])}function D(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1}function I(e,t,r){var n,i,o=new Array(16),a=0;for(n=1;n<=l;n++)o[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=D(o[s]++,s))}}function x(e){var t;for(t=0;t<a;t++)e.dyn_ltree[2*t]=0;for(t=0;t<s;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function P(e){8<e.bi_valid?C(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function k(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function O(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&k(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!k(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function R(e,t,r){var n,i,a,s,l=0;if(0!==e.last_lit)for(;n=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],i=e.pending_buf[e.l_buf+l],l++,0===n?T(e,i,t):(T(e,(a=g[i])+o+1,t),0!==(s=c[a])&&_(e,i-=y[a],s),T(e,a=S(--n),r),0!==(s=u[a])&&_(e,n-=E[a],s)),l<e.last_lit;);T(e,256,t)}function L(e,t){var r,n,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<c;r++)0!==o[2*r]?(e.heap[++e.heap_len]=u=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)o[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=u,r=e.heap_len>>1;1<=r;r--)O(e,o,r);for(i=c;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],O(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,O(e,o,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,o,a,s,c=t.dyn_tree,u=t.max_code,p=t.stat_desc.static_tree,d=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(o=0;o<=l;o++)e.bl_count[o]=0;for(c[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)m<(o=c[2*c[2*(n=e.heap[r])+1]+1]+1)&&(o=m,g++),c[2*n+1]=o,u<n||(e.bl_count[o]++,a=0,h<=n&&(a=f[n-h]),s=c[2*n],e.opt_len+=s*(o+a),d&&(e.static_len+=s*(p[2*n+1]+a)));if(0!==g){do{for(o=m-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[m]--,g-=2}while(0<g);for(o=m;0!==o;o--)for(n=e.bl_count[o];0!==n;)u<(i=e.heap[--r])||(c[2*i+1]!==o&&(e.opt_len+=(o-c[2*i+1])*c[2*i],c[2*i+1]=o),n--)}}(e,t),I(o,u,e.bl_count)}function F(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++s<l&&i===a||(s<c?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=i,c=(s=0)===a?(l=138,3):i===a?(l=6,3):(l=7,4))}function M(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,c=4;for(0===a&&(l=138,c=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++s<l&&i===a)){if(s<c)for(;T(e,i,e.bl_tree),0!=--s;);else 0!==i?(i!==o&&(T(e,i,e.bl_tree),s--),T(e,16,e.bl_tree),_(e,s-3,2)):s<=10?(T(e,17,e.bl_tree),_(e,s-3,3)):(T(e,18,e.bl_tree),_(e,s-11,7));o=i,c=(s=0)===a?(l=138,3):i===a?(l=6,3):(l=7,4)}}i(E);var U=!1;function B(e,t,r,i){_(e,0+(i?1:0),3),function(e,t,r){P(e),C(e,r),C(e,~r),n.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r)}r._tr_init=function(e){U||(function(){var e,t,r,n,i,o=new Array(16);for(n=r=0;n<28;n++)for(y[n]=r,e=0;e<1<<c[n];e++)g[r++]=n;for(g[r-1]=n,n=i=0;n<16;n++)for(E[n]=i,e=0;e<1<<u[n];e++)m[i++]=n;for(i>>=7;n<s;n++)for(E[n]=i<<7,e=0;e<1<<u[n]-7;e++)m[256+i++]=n;for(t=0;t<=l;t++)o[t]=0;for(e=0;e<=143;)f[2*e+1]=8,e++,o[8]++;for(;e<=255;)f[2*e+1]=9,e++,o[9]++;for(;e<=279;)f[2*e+1]=7,e++,o[7]++;for(;e<=287;)f[2*e+1]=8,e++,o[8]++;for(I(f,287,o),e=0;e<s;e++)h[2*e+1]=5,h[2*e]=D(e,5);v=new N(f,c,257,a,l),b=new N(h,u,0,s,l),w=new N(new Array(0),p,0,19,7)}(),U=!0),e.l_desc=new A(e.dyn_ltree,v),e.d_desc=new A(e.dyn_dtree,b),e.bl_desc=new A(e.bl_tree,w),e.bi_buf=0,e.bi_valid=0,x(e)},r._tr_stored_block=B,r._tr_flush_block=function(e,t,r,n){var i,a,s=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<o;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),L(e,e.l_desc),L(e,e.d_desc),s=function(e){var t;for(F(e,e.dyn_ltree,e.l_desc.max_code),F(e,e.dyn_dtree,e.d_desc.max_code),L(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*d[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=i&&(i=a)):i=a=r+5,r+4<=i&&-1!==t?B(e,t,r,n):4===e.strategy||a===i?(_(e,2+(n?1:0),3),R(e,f,h)):(_(e,4+(n?1:0),3),function(e,t,r,n){var i;for(_(e,t-257,5),_(e,r-1,5),_(e,n-4,4),i=0;i<n;i++)_(e,e.bl_tree[2*d[i]+1],3);M(e,e.dyn_ltree,t-1),M(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),R(e,e.dyn_ltree,e.dyn_dtree)),x(e),n&&P(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(g[r]+o+1)]++,e.dyn_dtree[2*S(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){_(e,2,3),T(e,256,f),function(e){16===e.bi_valid?(C(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,r){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,n){(function(e){!function(e){"use strict";if(!e.setImmediate){var t,r,n,i,o=1,a={},s=!1,l=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,t="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick((function(){p(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(i="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",d,!1):e.attachEvent("onmessage",d),function(t){e.postMessage(i+t,"*")}):e.MessageChannel?((n=new MessageChannel).port1.onmessage=function(e){p(e.data)},function(e){n.port2.postMessage(e)}):l&&"onreadystatechange"in l.createElement("script")?(r=l.documentElement,function(e){var t=l.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):function(e){setTimeout(p,0,e)},c.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var r=new Array(arguments.length-1),n=0;n<r.length;n++)r[n]=arguments[n+1];var i={callback:e,args:r};return a[o]=i,t(o),o++},c.clearImmediate=u}function u(e){delete a[e]}function p(e){if(s)setTimeout(p,0,e);else{var t=a[e];if(t){s=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(undefined,r)}}(t)}finally{u(e),s=!1}}}}function d(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&p(+t.data.slice(i.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},5483:(e,t,r)=>{"use strict";var n=r(3715);t.assign=n.assign,t.hasDefaultHTMLNamespace=n.hasDefaultHTMLNamespace,t.isHTMLMimeType=n.isHTMLMimeType,t.isValidMimeType=n.isValidMimeType,t.MIME_TYPE=n.MIME_TYPE,t.NAMESPACE=n.NAMESPACE;var i=r(9284);t.DOMException=i.DOMException,t.DOMExceptionName=i.DOMExceptionName,t.ExceptionCode=i.ExceptionCode,t.ParseError=i.ParseError;var o=r(6747);t.Attr=o.Attr,t.CDATASection=o.CDATASection,t.CharacterData=o.CharacterData,t.Comment=o.Comment,t.Document=o.Document,t.DocumentFragment=o.DocumentFragment,t.DocumentType=o.DocumentType,t.DOMImplementation=o.DOMImplementation,t.Element=o.Element,t.Entity=o.Entity,t.EntityReference=o.EntityReference,t.LiveNodeList=o.LiveNodeList,t.NamedNodeMap=o.NamedNodeMap,t.Node=o.Node,t.NodeList=o.NodeList,t.Notation=o.Notation,t.ProcessingInstruction=o.ProcessingInstruction,t.Text=o.Text,t.XMLSerializer=o.XMLSerializer;var a=r(5091);t.DOMParser=a.DOMParser,t.normalizeLineEndings=a.normalizeLineEndings,t.onErrorStopParsing=a.onErrorStopParsing,t.onWarningStopParsing=a.onWarningStopParsing},5525:function(e,t,r){"use strict";var n;e=r.nmd(e);var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.logError=function(e,t){e instanceof Error?c.error("".concat(t,": ").concat(e.message)):c.error("".concat(t,": Unknown error"))};var o=i(r(2591)),a="undefined"!=typeof process&&null!=(null===(n=process)||void 0===n||null===(n=n.versions)||void 0===n?void 0:n.node),s=a&&!0,l=a&&(r.c[r.s]===e||"true"===process.env.PP_REVIEW_CLI),c=(0,o.default)(l?{level:"info"}:s?{level:"error",browser:{asObject:!0}}:{level:"debug",transport:{target:"pino-pretty",options:{colorize:!0,translateTime:!0,ignore:"pid,hostname"}}});t.default=c},5693:(e,t,r)=>{"use strict";var n=r(9113);e.exports=new n("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}})},5696:(e,t,r)=>{"use strict";var n=r(9444),i=r(6116),o=r(276),a=Object.prototype.toString,s=Object.prototype.hasOwnProperty,l=65279,c={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},u=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],p=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function d(e){var t,r,o;if(t=e.toString(16).toUpperCase(),e<=255)r="x",o=2;else if(e<=65535)r="u",o=4;else{if(!(e<=4294967295))throw new i("code point within a string may not be greater than 0xFFFFFFFF");r="U",o=8}return"\\"+r+n.repeat("0",o-t.length)+t}function f(e){this.schema=e.schema||o,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=n.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=function(e,t){var r,n,i,o,a,l,c;if(null===t)return{};for(r={},i=0,o=(n=Object.keys(t)).length;i<o;i+=1)a=n[i],l=String(t[a]),"!!"===a.slice(0,2)&&(a="tag:yaml.org,2002:"+a.slice(2)),(c=e.compiledTypeMap.fallback[a])&&s.call(c.styleAliases,l)&&(l=c.styleAliases[l]),r[a]=l;return r}(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType='"'===e.quotingType?2:1,this.forceQuotes=e.forceQuotes||!1,this.replacer="function"==typeof e.replacer?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function h(e,t){for(var r,i=n.repeat(" ",t),o=0,a=-1,s="",l=e.length;o<l;)-1===(a=e.indexOf("\n",o))?(r=e.slice(o),o=l):(r=e.slice(o,a+1),o=a+1),r.length&&"\n"!==r&&(s+=i),s+=r;return s}function m(e,t){return"\n"+n.repeat(" ",e.indent*t)}function g(e){return 32===e||9===e}function y(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&e!==l||65536<=e&&e<=1114111}function v(e){return y(e)&&e!==l&&13!==e&&10!==e}function b(e,t,r){var n=v(e),i=n&&!g(e);return(r?n:n&&44!==e&&91!==e&&93!==e&&123!==e&&125!==e)&&35!==e&&!(58===t&&!i)||v(t)&&!g(t)&&35===e||58===t&&i}function w(e,t){var r,n=e.charCodeAt(t);return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1))>=56320&&r<=57343?1024*(n-55296)+r-56320+65536:n}function E(e){return/^\n* /.test(e)}function N(e,t,r,n,o){e.dump=function(){if(0===t.length)return 2===e.quotingType?'""':"''";if(!e.noCompatMode&&(-1!==u.indexOf(t)||p.test(t)))return 2===e.quotingType?'"'+t+'"':"'"+t+"'";var a=e.indent*Math.max(1,r),s=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-a),f=n||e.flowLevel>-1&&r>=e.flowLevel;switch(function(e,t,r,n,i,o,a,s){var c,u,p=0,d=null,f=!1,h=!1,m=-1!==n,v=-1,N=y(u=w(e,0))&&u!==l&&!g(u)&&45!==u&&63!==u&&58!==u&&44!==u&&91!==u&&93!==u&&123!==u&&125!==u&&35!==u&&38!==u&&42!==u&&33!==u&&124!==u&&61!==u&&62!==u&&39!==u&&34!==u&&37!==u&&64!==u&&96!==u&&function(e){return!g(e)&&58!==e}(w(e,e.length-1));if(t||a)for(c=0;c<e.length;p>=65536?c+=2:c++){if(!y(p=w(e,c)))return 5;N=N&&b(p,d,s),d=p}else{for(c=0;c<e.length;p>=65536?c+=2:c++){if(10===(p=w(e,c)))f=!0,m&&(h=h||c-v-1>n&&" "!==e[v+1],v=c);else if(!y(p))return 5;N=N&&b(p,d,s),d=p}h=h||m&&c-v-1>n&&" "!==e[v+1]}return f||h?r>9&&E(e)?5:a?2===o?5:2:h?4:3:!N||a||i(e)?2===o?5:2:1}(t,f,e.indent,s,(function(t){return function(e,t){var r,n;for(r=0,n=e.implicitTypes.length;r<n;r+=1)if(e.implicitTypes[r].resolve(t))return!0;return!1}(e,t)}),e.quotingType,e.forceQuotes&&!n,o)){case 1:return t;case 2:return"'"+t.replace(/'/g,"''")+"'";case 3:return"|"+A(t,e.indent)+S(h(t,a));case 4:return">"+A(t,e.indent)+S(h(function(e,t){for(var r,n,i,o=/(\n+)([^\n]*)/g,a=(i=-1!==(i=e.indexOf("\n"))?i:e.length,o.lastIndex=i,C(e.slice(0,i),t)),s="\n"===e[0]||" "===e[0];n=o.exec(e);){var l=n[1],c=n[2];r=" "===c[0],a+=l+(s||r||""===c?"":"\n")+C(c,t),s=r}return a}(t,s),a));case 5:return'"'+function(e){for(var t,r="",n=0,i=0;i<e.length;n>=65536?i+=2:i++)n=w(e,i),!(t=c[n])&&y(n)?(r+=e[i],n>=65536&&(r+=e[i+1])):r+=t||d(n);return r}(t)+'"';default:throw new i("impossible error: invalid scalar style")}}()}function A(e,t){var r=E(e)?String(t):"",n="\n"===e[e.length-1];return r+(!n||"\n"!==e[e.length-2]&&"\n"!==e?n?"":"-":"+")+"\n"}function S(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function C(e,t){if(""===e||" "===e[0])return e;for(var r,n,i=/ [^ ]/g,o=0,a=0,s=0,l="";r=i.exec(e);)(s=r.index)-o>t&&(n=a>o?a:s,l+="\n"+e.slice(o,n),o=n+1),a=s;return l+="\n",e.length-o>t&&a>o?l+=e.slice(o,a)+"\n"+e.slice(a+1):l+=e.slice(o),l.slice(1)}function _(e,t,r,n){var i,o,a,s="",l=e.tag;for(i=0,o=r.length;i<o;i+=1)a=r[i],e.replacer&&(a=e.replacer.call(r,String(i),a)),(D(e,t+1,a,!0,!0,!1,!0)||void 0===a&&D(e,t+1,null,!0,!0,!1,!0))&&(n&&""===s||(s+=m(e,t)),e.dump&&10===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=l,e.dump=s||"[]"}function T(e,t,r){var n,o,l,c,u,p;for(l=0,c=(o=r?e.explicitTypes:e.implicitTypes).length;l<c;l+=1)if(((u=o[l]).instanceOf||u.predicate)&&(!u.instanceOf||"object"==typeof t&&t instanceof u.instanceOf)&&(!u.predicate||u.predicate(t))){if(r?u.multi&&u.representName?e.tag=u.representName(t):e.tag=u.tag:e.tag="?",u.represent){if(p=e.styleMap[u.tag]||u.defaultStyle,"[object Function]"===a.call(u.represent))n=u.represent(t,p);else{if(!s.call(u.represent,p))throw new i("!<"+u.tag+'> tag resolver accepts not "'+p+'" style');n=u.represent[p](t,p)}e.dump=n}return!0}return!1}function D(e,t,r,n,o,s,l){e.tag=null,e.dump=r,T(e,r,!1)||T(e,r,!0);var c,u=a.call(e.dump),p=n;n&&(n=e.flowLevel<0||e.flowLevel>t);var d,f,h="[object Object]"===u||"[object Array]"===u;if(h&&(f=-1!==(d=e.duplicates.indexOf(r))),(null!==e.tag&&"?"!==e.tag||f||2!==e.indent&&t>0)&&(o=!1),f&&e.usedDuplicates[d])e.dump="*ref_"+d;else{if(h&&f&&!e.usedDuplicates[d]&&(e.usedDuplicates[d]=!0),"[object Object]"===u)n&&0!==Object.keys(e.dump).length?(function(e,t,r,n){var o,a,s,l,c,u,p="",d=e.tag,f=Object.keys(r);if(!0===e.sortKeys)f.sort();else if("function"==typeof e.sortKeys)f.sort(e.sortKeys);else if(e.sortKeys)throw new i("sortKeys must be a boolean or a function");for(o=0,a=f.length;o<a;o+=1)u="",n&&""===p||(u+=m(e,t)),l=r[s=f[o]],e.replacer&&(l=e.replacer.call(r,s,l)),D(e,t+1,s,!0,!0,!0)&&((c=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&10===e.dump.charCodeAt(0)?u+="?":u+="? "),u+=e.dump,c&&(u+=m(e,t)),D(e,t+1,l,!0,c)&&(e.dump&&10===e.dump.charCodeAt(0)?u+=":":u+=": ",p+=u+=e.dump));e.tag=d,e.dump=p||"{}"}(e,t,e.dump,o),f&&(e.dump="&ref_"+d+e.dump)):(function(e,t,r){var n,i,o,a,s,l="",c=e.tag,u=Object.keys(r);for(n=0,i=u.length;n<i;n+=1)s="",""!==l&&(s+=", "),e.condenseFlow&&(s+='"'),a=r[o=u[n]],e.replacer&&(a=e.replacer.call(r,o,a)),D(e,t,o,!1,!1)&&(e.dump.length>1024&&(s+="? "),s+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),D(e,t,a,!1,!1)&&(l+=s+=e.dump));e.tag=c,e.dump="{"+l+"}"}(e,t,e.dump),f&&(e.dump="&ref_"+d+" "+e.dump));else if("[object Array]"===u)n&&0!==e.dump.length?(e.noArrayIndent&&!l&&t>0?_(e,t-1,e.dump,o):_(e,t,e.dump,o),f&&(e.dump="&ref_"+d+e.dump)):(function(e,t,r){var n,i,o,a="",s=e.tag;for(n=0,i=r.length;n<i;n+=1)o=r[n],e.replacer&&(o=e.replacer.call(r,String(n),o)),(D(e,t,o,!1,!1)||void 0===o&&D(e,t,null,!1,!1))&&(""!==a&&(a+=","+(e.condenseFlow?"":" ")),a+=e.dump);e.tag=s,e.dump="["+a+"]"}(e,t,e.dump),f&&(e.dump="&ref_"+d+" "+e.dump));else{if("[object String]"!==u){if("[object Undefined]"===u)return!1;if(e.skipInvalid)return!1;throw new i("unacceptable kind of an object to dump "+u)}"?"!==e.tag&&N(e,e.dump,t,s,p)}null!==e.tag&&"?"!==e.tag&&(c=encodeURI("!"===e.tag[0]?e.tag.slice(1):e.tag).replace(/!/g,"%21"),c="!"===e.tag[0]?"!"+c:"tag:yaml.org,2002:"===c.slice(0,18)?"!!"+c.slice(18):"!<"+c+">",e.dump=c+" "+e.dump)}return!0}function I(e,t){var r,n,i=[],o=[];for(x(e,i,o),r=0,n=o.length;r<n;r+=1)t.duplicates.push(i[o[r]]);t.usedDuplicates=new Array(n)}function x(e,t,r){var n,i,o;if(null!==e&&"object"==typeof e)if(-1!==(i=t.indexOf(e)))-1===r.indexOf(i)&&r.push(i);else if(t.push(e),Array.isArray(e))for(i=0,o=e.length;i<o;i+=1)x(e[i],t,r);else for(i=0,o=(n=Object.keys(e)).length;i<o;i+=1)x(e[n[i]],t,r)}e.exports.dump=function(e,t){var r=new f(t=t||{});r.noRefs||I(e,r);var n=e;return r.replacer&&(n=r.replacer.call({"":n},"",n)),D(r,0,n,!0,!0)?r.dump+"\n":""}},5809:(e,t,r)=>{"use strict";var n=r(9113);e.exports=new n("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"})},6012:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safeParseXml=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"application/xml",r=e.replace(/^\uFEFF/,"").trimStart(),i=new n.DOMParser;try{return i.parseFromString(r,t)}catch(e){return console.error("❌ XML parsing failed."),console.error("Preview:",r.slice(0,200)),null}};var n=r(5483)},6116:e=>{"use strict";function t(e,t){var r="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(r+='in "'+e.mark.name+'" '),r+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(r+="\n\n"+e.mark.snippet),n+" "+r):n}function r(e,r){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=r,this.message=t(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r.prototype.toString=function(e){return this.name+": "+t(this,e)},e.exports=r},6379:(e,t,r)=>{"use strict";var n=r(9444),i=r(9113);function o(e){return 48<=e&&e<=55}function a(e){return 48<=e&&e<=57}e.exports=new i("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,r,n=e.length,i=0,s=!1;if(!n)return!1;if("-"!==(t=e[i])&&"+"!==t||(t=e[++i]),"0"===t){if(i+1===n)return!0;if("b"===(t=e[++i])){for(i++;i<n;i++)if("_"!==(t=e[i])){if("0"!==t&&"1"!==t)return!1;s=!0}return s&&"_"!==t}if("x"===t){for(i++;i<n;i++)if("_"!==(t=e[i])){if(!(48<=(r=e.charCodeAt(i))&&r<=57||65<=r&&r<=70||97<=r&&r<=102))return!1;s=!0}return s&&"_"!==t}if("o"===t){for(i++;i<n;i++)if("_"!==(t=e[i])){if(!o(e.charCodeAt(i)))return!1;s=!0}return s&&"_"!==t}}if("_"===t)return!1;for(;i<n;i++)if("_"!==(t=e[i])){if(!a(e.charCodeAt(i)))return!1;s=!0}return!(!s||"_"===t)},construct:function(e){var t,r=e,n=1;if(-1!==r.indexOf("_")&&(r=r.replace(/_/g,"")),"-"!==(t=r[0])&&"+"!==t||("-"===t&&(n=-1),t=(r=r.slice(1))[0]),"0"===r)return 0;if("0"===t){if("b"===r[1])return n*parseInt(r.slice(2),2);if("x"===r[1])return n*parseInt(r.slice(2),16);if("o"===r[1])return n*parseInt(r.slice(2),8)}return n*parseInt(r,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!n.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}})},6402:(e,t,r)=>{"use strict";var n=r(9113),i=Object.prototype.hasOwnProperty;e.exports=new n("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,r=e;for(t in r)if(i.call(r,t)&&null!==r[t])return!1;return!0},construct:function(e){return null!==e?e:{}}})},6442:(e,t,r)=>{"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}Object.defineProperty(t,"__esModule",{value:!0}),t.reviewCopilotComponents=function(e,t){return u.apply(this,arguments)};var s=r(4248),l=r(7905),c=r(7985);function u(){var e;return e=function*(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];try{var{agents:n}=yield(0,s.extractAgentsDetails)(e),o=Array.isArray(r)?r:[],a=p(o,(e=>e.AgentLogicalName)),u=[],d=0,f=0,h=[c.BotPatternDetails[c.BotPatternInfo.EvaluateTopicDescription].patternID,c.BotPatternDetails[c.BotPatternInfo.EvaluateTopicInputOutputVariableDescription].patternID,c.BotPatternDetails[c.BotPatternInfo.EvaluateKnowledgeDescription].patternID,c.BotPatternDetails[c.BotPatternInfo.EvaluateActionDescription].patternID],m=new Set(o.filter((e=>h.includes(e.PatternId)&&-1===Number(e.Score))).map((e=>e.PatternId))),g=function*(e){var r,n=e.botComponents.filter((e=>"topic"===e.componentType)),o=e.botComponents.filter((e=>"entity"===e.componentType)),g=e.botComponents.filter((e=>"knowledge"===e.componentType)),y=new Set;e.botXml||y.add("botXml"),n.some((e=>null==e.data))&&y.add("topic"),o.some((e=>null==e.data))&&y.add("entity"),g.some((e=>null==e.data))&&y.add("knowledge");var v=e.isGenModeEnabled,b=[{fn:()=>(0,l.patternCheckTriggerPhraseCount)(n),patternID:c.BotPatternDetails[c.BotPatternInfo.TriggerPhraseCount].patternID,patternName:c.BotPatternDetails[c.BotPatternInfo.TriggerPhraseCount].patternName,mode:"classic",componentsUsed:["topic"]},{fn:()=>(0,l.patternCheckSingleWordPhrases)(n),patternID:c.BotPatternDetails[c.BotPatternInfo.SingleWordPhrases].patternID,patternName:c.BotPatternDetails[c.BotPatternInfo.SingleWordPhrases].patternName,mode:"classic",componentsUsed:["topic"]},{fn:()=>(0,l.patternCheckLongPhrases)(n),patternID:c.BotPatternDetails[c.BotPatternInfo.LongPhrases].patternID,patternName:c.BotPatternDetails[c.BotPatternInfo.LongPhrases].patternName,mode:"classic",componentsUsed:["topic"]},{fn:()=>(0,l.patternCheckConditionCount)(n),patternID:c.BotPatternDetails[c.BotPatternInfo.ConditionCount].patternID,patternName:c.BotPatternDetails[c.BotPatternInfo.ConditionCount].patternName,mode:"classic/genmode",componentsUsed:["topic"]},{fn:()=>(0,l.patternCheckFlowCount)(n),patternID:c.BotPatternDetails[c.BotPatternInfo.FlowCount].patternID,patternName:c.BotPatternDetails[c.BotPatternInfo.FlowCount].patternName,mode:"classic/genmode",componentsUsed:["topic"]},{fn:()=>(0,l.patternCheckSharePointAuthMode)({botXml:e.botXml,botComponents:{knowledge:g}}),patternID:c.BotPatternDetails[c.BotPatternInfo.SharePointAuthMode].patternID,patternName:c.BotPatternDetails[c.BotPatternInfo.SharePointAuthMode].patternName,mode:"classic/genmode",componentsUsed:["botXml","knowledge"]},{fn:()=>(0,l.patternCheckUnusedTopics)(n,e.botLogicalName),patternID:c.BotPatternDetails[c.BotPatternInfo.UnusedTopics].patternID,patternName:c.BotPatternDetails[c.BotPatternInfo.UnusedTopics].patternName,mode:"classic",componentsUsed:["topic"]},{fn:()=>(0,l.patternCheckSynonymsQuality)(o),patternID:c.BotPatternDetails[c.BotPatternInfo.SynonymsQuality].patternID,patternName:c.BotPatternDetails[c.BotPatternInfo.SynonymsQuality].patternName,mode:"classic/genmode",componentsUsed:["entity"]},{fn:()=>(0,l.patternCheckDuplicateRegexEntities)(o),patternID:c.BotPatternDetails[c.BotPatternInfo.DuplicateRegexEntities].patternID,patternName:c.BotPatternDetails[c.BotPatternInfo.DuplicateRegexEntities].patternName,mode:"classic/genmode",componentsUsed:["entity"]},{fn:()=>(0,l.patternCheckEndOfConversationUsage)(n,e.botLogicalName),patternID:c.BotPatternDetails[c.BotPatternInfo.EndOfConversationReference].patternID,patternName:c.BotPatternDetails[c.BotPatternInfo.EndOfConversationReference].patternName,mode:"classic/genmode",componentsUsed:["topic"]}],w=[],E=0,N=0;for(var A of b){var S=(0,s.getBasePatternInfo)(A.patternID,t);if(A.componentsUsed.some((e=>y.has(e))))w.push(i(i({},S),{},{patternID:A.patternID,status:"Skipped",instanceValue:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0}],failureReason:"Skipped – component parse failure (".concat(A.componentsUsed.join(", "),")")})),N++;else{var C="classic"===A.mode||"classic/genmode"===A.mode,_="genmode"===A.mode||"classic/genmode"===A.mode;if(v&&!_||!v&&!C)w.push(i(i({},S),{},{patternID:A.patternID,status:"NotExecuted",instanceValue:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0}],failureReason:"Pattern not executed for mode ".concat(v?"gen":"classic",".")}));else{var T=yield A.fn();w.push(T),N++,"Pass"===T.status?E++:"Warning"===T.status&&(E+=.5)}}}var D=p(null!==(r=a[e.botLogicalName])&&void 0!==r?r:[],(e=>e.PatternId)),I=function*(r){var o,a,l,u,p,d=D[r]||[];if(r===c.BotPatternDetails[c.BotPatternInfo.EvaluateKnowledgeDescription].patternID&&((null===(o=e.knowledge)||void 0===o?void 0:o.length)||0)+((null===(a=e.fileAttachments)||void 0===a?void 0:a.length)||0)>0&&((null===(l=e.knowledge)||void 0===l?void 0:l.length)||0)+((null===(u=e.fileAttachments)||void 0===u?void 0:u.length)||0)<25){var f=(0,s.getBasePatternInfo)(r,t);return w.push(i(i({},f),{},{patternID:r,status:"NotExecuted",instanceValue:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0}],failureReason:""})),0}if(m.has(r)){var h=(0,s.getBasePatternInfo)(r,t);if(e.isGenModeEnabled){var y=!1;switch(r){case c.BotPatternDetails[c.BotPatternInfo.EvaluateTopicDescription].patternID:y=n.length>0;break;case c.BotPatternDetails[c.BotPatternInfo.EvaluateTopicInputOutputVariableDescription].patternID:y=e.topics.reduce(((e,t)=>{var r,n;return e+(((null===(r=t.inputType)||void 0===r?void 0:r.length)||0)+((null===(n=t.outputType)||void 0===n?void 0:n.length)||0))}),0)>0;break;case c.BotPatternDetails[c.BotPatternInfo.EvaluateKnowledgeDescription].patternID:var v;y=g.length+((null===(v=e.fileAttachments)||void 0===v?void 0:v.length)||0)>0;break;case c.BotPatternDetails[c.BotPatternInfo.EvaluateActionDescription].patternID:y=((null===(p=e.actions)||void 0===p?void 0:p.length)||0)>0}y?(w.push(i(i({},h),{},{patternID:r,status:"Skipped",instanceValue:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0}],failureReason:""})),N++):(w.push(i(i({},h),{},{patternID:r,status:"Pass",instanceValue:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0}],failureReason:""})),N++,E++)}else w.push(i(i({},h),{},{patternID:r,status:"NotExecuted",instanceValue:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0}],failureReason:""}));return 0}if(0===d.length){var b=(0,s.getBasePatternInfo)(r,t);return e.isGenModeEnabled?(w.push(i(i({},b),{},{patternID:r,status:"Pass",instanceValue:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0}],failureReason:""})),N++,E++):w.push(i(i({},b),{},{patternID:r,status:"NotExecuted",instanceValue:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0}],failureReason:""})),0}var A=d.filter((e=>(Number(e.Score)||0)<.7)),S=0===A.length?"Pass":"Fail",C=(0,s.getBasePatternInfo)(r,t);w.push(i(i({},C),{},{patternID:r,status:S,instanceValue:(()=>{switch(r){case c.BotPatternDetails[c.BotPatternInfo.EvaluateTopicDescription].patternID:return[{Topic:A.map((e=>{var t;return{TopicName:e.TopicName,ModelDescription:null!==(t=e.ModelDescription)&&void 0!==t?t:"",Score:Number(e.Score)}}))}];case c.BotPatternDetails[c.BotPatternInfo.EvaluateTopicInputOutputVariableDescription].patternID:return[{Topic:A.map((e=>{var t;return{TopicName:e.TopicName,VariableName:e.VariableName,VariableDisplayName:e.VariableDisplayName,VariableDescription:null!==(t=e.Description)&&void 0!==t?t:"",VariableType:e.VariableType,Score:Number(e.Score)}}))}];case c.BotPatternDetails[c.BotPatternInfo.EvaluateKnowledgeDescription].patternID:return[{KnowledgeSource:A.map((e=>{var t;return{KnowledgeName:e.KnowledgeName,Description:null!==(t=e.Description)&&void 0!==t?t:"",Score:Number(e.Score)}}))}];case c.BotPatternDetails[c.BotPatternInfo.EvaluateActionDescription].patternID:return[{Actions:A.map((e=>{var t;return{ActionName:e.ActionName,ModelDescription:null!==(t=e.ModelDescription)&&void 0!==t?t:"",Score:Number(e.Score)}}))}];default:return[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0}]}})(),failureReason:"Pass"===S?"":"".concat(A.length," item(s) failed.")})),N++,"Pass"===S&&E++};for(var x of h)yield*I(x);d+=E,f+=N;var P=0===N?"0%":Math.round(E/N*100).toString()+"%";u.push({name:e.botLogicalName,displayName:e.botDisplayName,result:w,score:P})};for(var y of n)yield*g(y);var v=0===f?"0%":Math.round(d/f*100).toString()+"%";return{items:u,totalBots:u.length,totalScore:v}}catch(e){return console.error("[Copilot Agents REVIEW-FAILED]",e),{items:[],totalBots:0,totalScore:"0%"}}},u=function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){a(o,n,i,s,l,"next",e)}function l(e){a(o,n,i,s,l,"throw",e)}s(void 0)}))},u.apply(this,arguments)}function p(e,t){return e.reduce(((e,r)=>{var n=t(r);return(e[n]||(e[n]=[])).push(r),e}),{})}},6599:(e,t,r)=>{"use strict";var n=r(9113),i=Object.prototype.toString;e.exports=new n("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,r,n,o,a,s=e;for(a=new Array(s.length),t=0,r=s.length;t<r;t+=1){if(n=s[t],"[object Object]"!==i.call(n))return!1;if(1!==(o=Object.keys(n)).length)return!1;a[t]=[o[0],n[o[0]]]}return!0},construct:function(e){if(null===e)return[];var t,r,n,i,o,a=e;for(o=new Array(a.length),t=0,r=a.length;t<r;t+=1)n=a[t],i=Object.keys(n),o[t]=[i[0],n[i[0]]];return o}})},6747:(e,t,r)=>{"use strict";var n=r(3715),i=n.find,o=n.hasDefaultHTMLNamespace,a=n.hasOwn,s=n.isHTMLMimeType,l=n.isHTMLRawTextElement,c=n.isHTMLVoidElement,u=n.MIME_TYPE,p=n.NAMESPACE,d=Symbol(),f=r(9284),h=f.DOMException,m=f.DOMExceptionName,g=r(3114);function y(e){if(e!==d)throw new TypeError("Illegal constructor")}function v(e){return""!==e}function b(e,t){return a(e,t)||(e[t]=!0),e}function w(e){if(!e)return[];var t=function(e){return e?e.split(/[\t\n\f\r ]+/).filter(v):[]}(e);return Object.keys(t.reduce(b,{}))}function E(e){if(!g.QName_exact.test(e))throw new h(h.INVALID_CHARACTER_ERR,'invalid character in qualified name "'+e+'"')}function N(e,t){E(t),e=e||null;var r=null,i=t;if(t.indexOf(":")>=0){var o=t.split(":");r=o[0],i=o[1]}if(null!==r&&null===e)throw new h(h.NAMESPACE_ERR,"prefix is non-null and namespace is null");if("xml"===r&&e!==n.NAMESPACE.XML)throw new h(h.NAMESPACE_ERR,'prefix is "xml" and namespace is not the XML namespace');if(("xmlns"===r||"xmlns"===t)&&e!==n.NAMESPACE.XMLNS)throw new h(h.NAMESPACE_ERR,'either qualifiedName or prefix is "xmlns" and namespace is not the XMLNS namespace');if(e===n.NAMESPACE.XMLNS&&"xmlns"!==r&&"xmlns"!==t)throw new h(h.NAMESPACE_ERR,'namespace is the XMLNS namespace and neither qualifiedName nor prefix is "xmlns"');return[e,r,i]}function A(e,t){for(var r in e)a(e,r)&&(t[r]=e[r])}function S(e,t){var r=e.prototype;if(!(r instanceof t)){function n(){}n.prototype=t.prototype,A(r,n=new n),e.prototype=r=n}r.constructor!=e&&("function"!=typeof e&&console.error("unknown Class:"+e),r.constructor=e)}var C={},_=C.ELEMENT_NODE=1,T=C.ATTRIBUTE_NODE=2,D=C.TEXT_NODE=3,I=C.CDATA_SECTION_NODE=4,x=C.ENTITY_REFERENCE_NODE=5,P=C.ENTITY_NODE=6,k=C.PROCESSING_INSTRUCTION_NODE=7,O=C.COMMENT_NODE=8,R=C.DOCUMENT_NODE=9,L=C.DOCUMENT_TYPE_NODE=10,F=C.DOCUMENT_FRAGMENT_NODE=11,M=C.NOTATION_NODE=12,U=n.freeze({DOCUMENT_POSITION_DISCONNECTED:1,DOCUMENT_POSITION_PRECEDING:2,DOCUMENT_POSITION_FOLLOWING:4,DOCUMENT_POSITION_CONTAINS:8,DOCUMENT_POSITION_CONTAINED_BY:16,DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC:32});function B(e,t){if(t.length<e.length)return B(t,e);var r=null;for(var n in e){if(e[n]!==t[n])return r;r=e[n]}return r}function j(e){return e.guid||(e.guid=Math.random()),e.guid}function z(){}function V(e,t){this._node=e,this._refresh=t,q(this)}function q(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var r=e._refresh(e._node);if(De(e,"length",r.length),!e.$$length||r.length<e.$$length)for(var n=r.length;n in e;n++)a(e,n)&&delete e[n];A(r,e),e._inc=t}}function H(){}function W(e,t){for(var r=0;r<e.length;){if(e[r]===t)return r;r++}}function G(e,t,r){var n=W(t,r);if(n>=0){for(var i=t.length-1;n<=i;)t[n]=t[++n];if(t.length=i,e){var o=e.ownerDocument;o&&J(o,e,r),r.ownerElement=null}}}function Y(){}function X(e){y(e)}function Z(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function Q(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(Q(e,t))return!0}while(e=e.nextSibling)}function K(e,t){y(e);var r=t||{};this.ownerDocument=this,this.contentType=r.contentType||u.XML_APPLICATION,this.type=s(this.contentType)?"html":"xml"}function J(e,t,r,n){e&&e._inc++,r.namespaceURI===p.XMLNS&&delete t._nsMap[r.prefix?r.localName:""]}function $(e,t,r){if(e&&e._inc){e._inc++;var n=t.childNodes;if(r&&!r.nextSibling)n[n.length++]=r;else{for(var i=t.firstChild,o=0;i;)n[o++]=i,i=i.nextSibling;n.length=o,delete n[n.length]}}}function ee(e,t){if(e!==t.parentNode)throw new h(h.NOT_FOUND_ERR,"child's parent is not parent");var r=t.previousSibling,n=t.nextSibling;return r?r.nextSibling=n:e.firstChild=n,n?n.previousSibling=r:e.lastChild=r,$(e.ownerDocument,e),t.parentNode=null,t.previousSibling=null,t.nextSibling=null,t}function te(e){return e&&e.nodeType===X.DOCUMENT_TYPE_NODE}function re(e){return e&&e.nodeType===X.ELEMENT_NODE}function ne(e){return e&&e.nodeType===X.TEXT_NODE}function ie(e,t){var r=e.childNodes||[];if(i(r,re)||te(t))return!1;var n=i(r,te);return!(t&&n&&r.indexOf(n)>r.indexOf(t))}function oe(e,t){var r=e.childNodes||[];if(i(r,(function(e){return re(e)&&e!==t})))return!1;var n=i(r,te);return!(t&&n&&r.indexOf(n)>r.indexOf(t))}function ae(e,t,r){var n=e.childNodes||[],o=t.childNodes||[];if(t.nodeType===X.DOCUMENT_FRAGMENT_NODE){var a=o.filter(re);if(a.length>1||i(o,ne))throw new h(h.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(1===a.length&&!ie(e,r))throw new h(h.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(re(t)&&!ie(e,r))throw new h(h.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(te(t)){if(i(n,te))throw new h(h.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var s=i(n,re);if(r&&n.indexOf(s)<n.indexOf(r))throw new h(h.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element");if(!r&&s)throw new h(h.HIERARCHY_REQUEST_ERR,"Doctype can not be appended since element is present")}}function se(e,t,r){var n=e.childNodes||[],o=t.childNodes||[];if(t.nodeType===X.DOCUMENT_FRAGMENT_NODE){var a=o.filter(re);if(a.length>1||i(o,ne))throw new h(h.HIERARCHY_REQUEST_ERR,"More than one element or text in fragment");if(1===a.length&&!oe(e,r))throw new h(h.HIERARCHY_REQUEST_ERR,"Element in fragment can not be inserted before doctype")}if(re(t)&&!oe(e,r))throw new h(h.HIERARCHY_REQUEST_ERR,"Only one element can be added and only after doctype");if(te(t)){function l(e){return te(e)&&e!==r}if(i(n,l))throw new h(h.HIERARCHY_REQUEST_ERR,"Only one doctype is allowed");var s=i(n,re);if(r&&n.indexOf(s)<n.indexOf(r))throw new h(h.HIERARCHY_REQUEST_ERR,"Doctype can only be inserted before an element")}}function le(e,t,r,n){(function(e,t,r){if(!function(e){return e&&(e.nodeType===X.DOCUMENT_NODE||e.nodeType===X.DOCUMENT_FRAGMENT_NODE||e.nodeType===X.ELEMENT_NODE)}(e))throw new h(h.HIERARCHY_REQUEST_ERR,"Unexpected parent node type "+e.nodeType);if(r&&r.parentNode!==e)throw new h(h.NOT_FOUND_ERR,"child not in parent");if(!function(e){return e&&(e.nodeType===X.CDATA_SECTION_NODE||e.nodeType===X.COMMENT_NODE||e.nodeType===X.DOCUMENT_FRAGMENT_NODE||e.nodeType===X.DOCUMENT_TYPE_NODE||e.nodeType===X.ELEMENT_NODE||e.nodeType===X.PROCESSING_INSTRUCTION_NODE||e.nodeType===X.TEXT_NODE)}(t)||te(t)&&e.nodeType!==X.DOCUMENT_NODE)throw new h(h.HIERARCHY_REQUEST_ERR,"Unexpected node type "+t.nodeType+" for parent node type "+e.nodeType)})(e,t,r),e.nodeType===X.DOCUMENT_NODE&&(n||ae)(e,t,r);var i=t.parentNode;if(i&&i.removeChild(t),t.nodeType===F){var o=t.firstChild;if(null==o)return t;var a=t.lastChild}else o=a=t;var s=r?r.previousSibling:e.lastChild;o.previousSibling=s,a.nextSibling=r,s?s.nextSibling=o:e.firstChild=o,null==r?e.lastChild=a:r.previousSibling=a;do{o.parentNode=e}while(o!==a&&(o=o.nextSibling));return $(e.ownerDocument||e,e,t),t.nodeType==F&&(t.firstChild=t.lastChild=null),t}function ce(e){y(e),this._nsMap=Object.create(null)}function ue(e){y(e),this.namespaceURI=null,this.prefix=null,this.ownerElement=null}function pe(e){y(e)}function de(e){y(e)}function fe(e){y(e)}function he(e){y(e)}function me(e){y(e)}function ge(e){y(e)}function ye(e){y(e)}function ve(e){y(e)}function be(e){y(e)}function we(e){y(e)}function Ee(){}function Ne(e){var t=[],r=this.nodeType===R&&this.documentElement||this,n=r.prefix,i=r.namespaceURI;if(i&&null==n&&null==(n=r.lookupPrefix(i)))var o=[{namespace:i,prefix:null}];return Ce(this,t,e,o),t.join("")}function Ae(e,t,r){var n=e.prefix||"",i=e.namespaceURI;if(!i)return!1;if("xml"===n&&i===p.XML||i===p.XMLNS)return!1;for(var o=r.length;o--;){var a=r[o];if(a.prefix===n)return a.namespace!==i}return!0}function Se(e,t,r){e.push(" ",t,'="',r.replace(/[<>&"\t\n\r]/g,Z),'"')}function Ce(e,t,r,n){n||(n=[]);var i="html"===(e.nodeType===R?e:e.ownerDocument).type;if(r){if(!(e=r(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case _:var o=e.attributes,a=o.length,s=e.firstChild,u=e.tagName,d=u;if(!i&&!e.prefix&&e.namespaceURI){for(var f,h=0;h<o.length;h++)if("xmlns"===o.item(h).name){f=o.item(h).value;break}if(!f)for(var m=n.length-1;m>=0;m--)if(""===(y=n[m]).prefix&&y.namespace===e.namespaceURI){f=y.namespace;break}if(f!==e.namespaceURI)for(m=n.length-1;m>=0;m--){var y;if((y=n[m]).namespace===e.namespaceURI){y.prefix&&(d=y.prefix+":"+u);break}}}t.push("<",d);for(var v=0;v<a;v++)"xmlns"==(b=o.item(v)).prefix?n.push({prefix:b.localName,namespace:b.value}):"xmlns"==b.nodeName&&n.push({prefix:"",namespace:b.value});for(v=0;v<a;v++){var b,w,E;Ae(b=o.item(v),0,n)&&(Se(t,(w=b.prefix||"")?"xmlns:"+w:"xmlns",E=b.namespaceURI),n.push({prefix:w,namespace:E})),Ce(b,t,r,n)}u===d&&Ae(e,0,n)&&(Se(t,(w=e.prefix||"")?"xmlns:"+w:"xmlns",E=e.namespaceURI),n.push({prefix:w,namespace:E}));var N=!s;if(N&&(i||e.namespaceURI===p.HTML)&&(N=c(u)),N)t.push("/>");else{if(t.push(">"),i&&l(u))for(;s;)s.data?t.push(s.data):Ce(s,t,r,n.slice()),s=s.nextSibling;else for(;s;)Ce(s,t,r,n.slice()),s=s.nextSibling;t.push("</",d,">")}return;case R:case F:for(s=e.firstChild;s;)Ce(s,t,r,n.slice()),s=s.nextSibling;return;case T:return Se(t,e.name,e.value);case D:return t.push(e.data.replace(/[<&>]/g,Z));case I:return t.push(g.CDATA_START,e.data,g.CDATA_END);case O:return t.push(g.COMMENT_START,e.data,g.COMMENT_END);case L:var A=e.publicId,S=e.systemId;return t.push(g.DOCTYPE_DECL_START," ",e.name),A?(t.push(" ",g.PUBLIC," ",A),S&&"."!==S&&t.push(" ",S)):S&&"."!==S&&t.push(" ",g.SYSTEM," ",S),e.internalSubset&&t.push(" [",e.internalSubset,"]"),void t.push(">");case k:return t.push("<?",e.target," ",e.data,"?>");case x:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function _e(e,t,r){var n;switch(t.nodeType){case _:(n=t.cloneNode(!1)).ownerDocument=e;case F:break;case T:r=!0}if(n||(n=t.cloneNode(!1)),n.ownerDocument=e,n.parentNode=null,r)for(var i=t.firstChild;i;)n.appendChild(_e(e,i,r)),i=i.nextSibling;return n}function Te(e,t,r){var n=new t.constructor(d);for(var i in t)if(a(t,i)){var o=t[i];"object"!=typeof o&&o!=n[i]&&(n[i]=o)}switch(t.childNodes&&(n.childNodes=new z),n.ownerDocument=e,n.nodeType){case _:var s=t.attributes,l=n.attributes=new H,c=s.length;l._ownerElement=n;for(var u=0;u<c;u++)n.setAttributeNode(Te(e,s.item(u),!0));break;case T:r=!0}if(r)for(var p=t.firstChild;p;)n.appendChild(Te(e,p,r)),p=p.nextSibling;return n}function De(e,t,r){e[t]=r}z.prototype={length:0,item:function(e){return e>=0&&e<this.length?this[e]:null},toString:function(e){for(var t=[],r=0;r<this.length;r++)Ce(this[r],t,e);return t.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}},z.prototype[Symbol.iterator]=function(){var e=this,t=0;return{next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0}},return:function(){return{done:!0}}}},V.prototype.item=function(e){return q(this),this[e]||null},S(V,z),H.prototype={length:0,item:z.prototype.item,getNamedItem:function(e){this._ownerElement&&this._ownerElement._isInHTMLDocumentAndNamespace()&&(e=e.toLowerCase());for(var t=0;t<this.length;){var r=this[t];if(r.nodeName===e)return r;t++}return null},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!==this._ownerElement)throw new h(h.INUSE_ATTRIBUTE_ERR);var r=this.getNamedItemNS(e.namespaceURI,e.localName);return r===e?e:(function(e,t,r,n){if(n?t[W(t,n)]=r:(t[t.length]=r,t.length++),e){r.ownerElement=e;var i=e.ownerDocument;i&&(n&&J(i,e,n),function(e,t,r){e&&e._inc++,r.namespaceURI===p.XMLNS&&(t._nsMap[r.prefix?r.localName:""]=r.value)}(i,e,r))}}(this._ownerElement,this,e,r),r)},setNamedItemNS:function(e){return this.setNamedItem(e)},removeNamedItem:function(e){var t=this.getNamedItem(e);if(!t)throw new h(h.NOT_FOUND_ERR,e);return G(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var r=this.getNamedItemNS(e,t);if(!r)throw new h(h.NOT_FOUND_ERR,e?e+" : "+t:t);return G(this._ownerElement,this,r),r},getNamedItemNS:function(e,t){e||(e=null);for(var r=0;r<this.length;){var n=this[r];if(n.localName===t&&n.namespaceURI===e)return n;r++}return null}},H.prototype[Symbol.iterator]=function(){var e=this,t=0;return{next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0}},return:function(){return{done:!0}}}},Y.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,r){var n=u.XML_APPLICATION;e===p.HTML?n=u.XML_XHTML_APPLICATION:e===p.SVG&&(n=u.XML_SVG_IMAGE);var i=new K(d,{contentType:n});if(i.implementation=this,i.childNodes=new z,i.doctype=r||null,r&&i.appendChild(r),t){var o=i.createElementNS(e,t);i.appendChild(o)}return i},createDocumentType:function(e,t,r,n){E(e);var i=new me(d);return i.name=e,i.nodeName=e,i.publicId=t||"",i.systemId=r||"",i.internalSubset=n||"",i.childNodes=new z,i},createHTMLDocument:function(e){var t=new K(d,{contentType:u.HTML});if(t.implementation=this,t.childNodes=new z,!1!==e){t.doctype=this.createDocumentType("html"),t.doctype.ownerDocument=t,t.appendChild(t.doctype);var r=t.createElement("html");t.appendChild(r);var n=t.createElement("head");if(r.appendChild(n),"string"==typeof e){var i=t.createElement("title");i.appendChild(t.createTextNode(e)),n.appendChild(i)}r.appendChild(t.createElement("body"))}return t}},X.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,parentNode:null,get parentElement(){return this.parentNode&&this.parentNode.nodeType===this.ELEMENT_NODE?this.parentNode:null},childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,baseURI:"about:blank",get isConnected(){var e=this.getRootNode();return e&&e.nodeType===e.DOCUMENT_NODE},contains:function(e){if(!e)return!1;var t=e;do{if(this===t)return!0;t=e.parentNode}while(t);return!1},getRootNode:function(e){var t=this;do{if(!t.parentNode)return t;t=t.parentNode}while(t)},isEqualNode:function(e){if(!e)return!1;if(this.nodeType!==e.nodeType)return!1;switch(this.nodeType){case this.DOCUMENT_TYPE_NODE:if(this.name!==e.name)return!1;if(this.publicId!==e.publicId)return!1;if(this.systemId!==e.systemId)return!1;break;case this.ELEMENT_NODE:if(this.namespaceURI!==e.namespaceURI)return!1;if(this.prefix!==e.prefix)return!1;if(this.localName!==e.localName)return!1;if(this.attributes.length!==e.attributes.length)return!1;for(var t=0;t<this.attributes.length;t++){var r=this.attributes.item(t);if(!r.isEqualNode(e.getAttributeNodeNS(r.namespaceURI,r.localName)))return!1}break;case this.ATTRIBUTE_NODE:if(this.namespaceURI!==e.namespaceURI)return!1;if(this.localName!==e.localName)return!1;if(this.value!==e.value)return!1;break;case this.PROCESSING_INSTRUCTION_NODE:if(this.target!==e.target||this.data!==e.data)return!1;break;case this.TEXT_NODE:case this.COMMENT_NODE:if(this.data!==e.data)return!1}if(this.childNodes.length!==e.childNodes.length)return!1;for(t=0;t<this.childNodes.length;t++)if(!this.childNodes[t].isEqualNode(e.childNodes[t]))return!1;return!0},isSameNode:function(e){return this===e},insertBefore:function(e,t){return le(this,e,t)},replaceChild:function(e,t){le(this,e,t,se),t&&this.removeChild(t)},removeChild:function(e){return ee(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return Te(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==D&&e.nodeType==D?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},lookupPrefix:function(e){for(var t=this;t;){var r=t._nsMap;if(r)for(var n in r)if(a(r,n)&&r[n]===e)return n;t=t.nodeType==T?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var r=t._nsMap;if(r&&a(r,e))return r[e];t=t.nodeType==T?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)},compareDocumentPosition:function(e){if(this===e)return 0;var t=e,r=this,n=null,i=null;if(t instanceof ue&&(t=(n=t).ownerElement),r instanceof ue&&(r=(i=r).ownerElement,n&&t&&r===t))for(var o,a=0;o=r.attributes[a];a++){if(o===n)return U.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+U.DOCUMENT_POSITION_PRECEDING;if(o===i)return U.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+U.DOCUMENT_POSITION_FOLLOWING}if(!t||!r||r.ownerDocument!==t.ownerDocument)return U.DOCUMENT_POSITION_DISCONNECTED+U.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC+(j(r.ownerDocument)>j(t.ownerDocument)?U.DOCUMENT_POSITION_FOLLOWING:U.DOCUMENT_POSITION_PRECEDING);if(i&&t===r)return U.DOCUMENT_POSITION_CONTAINS+U.DOCUMENT_POSITION_PRECEDING;if(n&&t===r)return U.DOCUMENT_POSITION_CONTAINED_BY+U.DOCUMENT_POSITION_FOLLOWING;for(var s=[],l=t.parentNode;l;){if(!i&&l===r)return U.DOCUMENT_POSITION_CONTAINED_BY+U.DOCUMENT_POSITION_FOLLOWING;s.push(l),l=l.parentNode}s.reverse();for(var c=[],u=r.parentNode;u;){if(!n&&u===t)return U.DOCUMENT_POSITION_CONTAINS+U.DOCUMENT_POSITION_PRECEDING;c.push(u),u=u.parentNode}c.reverse();var p=B(s,c);for(var d in p.childNodes){var f=p.childNodes[d];if(f===r)return U.DOCUMENT_POSITION_FOLLOWING;if(f===t)return U.DOCUMENT_POSITION_PRECEDING;if(c.indexOf(f)>=0)return U.DOCUMENT_POSITION_FOLLOWING;if(s.indexOf(f)>=0)return U.DOCUMENT_POSITION_PRECEDING}return 0}},A(C,X),A(C,X.prototype),A(U,X),A(U,X.prototype),K.prototype={implementation:null,nodeName:"#document",nodeType:R,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType===F){for(var r=e.firstChild;r;){var n=r.nextSibling;this.insertBefore(r,t),r=n}return e}return le(this,e,t),e.ownerDocument=this,null===this.documentElement&&e.nodeType===_&&(this.documentElement=e),e},removeChild:function(e){var t=ee(this,e);return t===this.documentElement&&(this.documentElement=null),t},replaceChild:function(e,t){le(this,e,t,se),e.ownerDocument=this,t&&this.removeChild(t),re(e)&&(this.documentElement=e)},importNode:function(e,t){return _e(this,e,t)},getElementById:function(e){var t=null;return Q(this.documentElement,(function(r){if(r.nodeType==_&&r.getAttribute("id")==e)return t=r,!0})),t},createElement:function(e){var t=new ce(d);return t.ownerDocument=this,"html"===this.type&&(e=e.toLowerCase()),o(this.contentType)&&(t.namespaceURI=p.HTML),t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new z,(t.attributes=new H)._ownerElement=t,t},createDocumentFragment:function(){var e=new be(d);return e.ownerDocument=this,e.childNodes=new z,e},createTextNode:function(e){var t=new de(d);return t.ownerDocument=this,t.childNodes=new z,t.appendData(e),t},createComment:function(e){var t=new fe(d);return t.ownerDocument=this,t.childNodes=new z,t.appendData(e),t},createCDATASection:function(e){var t=new he(d);return t.ownerDocument=this,t.childNodes=new z,t.appendData(e),t},createProcessingInstruction:function(e,t){var r=new we(d);return r.ownerDocument=this,r.childNodes=new z,r.nodeName=r.target=e,r.nodeValue=r.data=t,r},createAttribute:function(e){if(!g.QName_exact.test(e))throw new h(h.INVALID_CHARACTER_ERR,'invalid character in name "'+e+'"');return"html"===this.type&&(e=e.toLowerCase()),this._createAttribute(e)},_createAttribute:function(e){var t=new ue(d);return t.ownerDocument=this,t.childNodes=new z,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){if(!g.Name.test(e))throw new h(h.INVALID_CHARACTER_ERR,'not a valid xml name "'+e+'"');if("html"===this.type)throw new h("document is an html document",m.NotSupportedError);var t=new ve(d);return t.ownerDocument=this,t.childNodes=new z,t.nodeName=e,t},createElementNS:function(e,t){var r=N(e,t),n=new ce(d),i=n.attributes=new H;return n.childNodes=new z,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=r[0],n.prefix=r[1],n.localName=r[2],i._ownerElement=n,n},createAttributeNS:function(e,t){var r=N(e,t),n=new ue(d);return n.ownerDocument=this,n.childNodes=new z,n.nodeName=t,n.name=t,n.specified=!0,n.namespaceURI=r[0],n.prefix=r[1],n.localName=r[2],n}},S(K,X),ce.prototype={nodeType:_,attributes:null,getQualifiedName:function(){return this.prefix?this.prefix+":"+this.localName:this.localName},_isInHTMLDocumentAndNamespace:function(){return"html"===this.ownerDocument.type&&this.namespaceURI===p.HTML},hasAttributes:function(){return!(!this.attributes||!this.attributes.length)},hasAttribute:function(e){return!!this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t?t.value:null},getAttributeNode:function(e){return this._isInHTMLDocumentAndNamespace()&&(e=e.toLowerCase()),this.attributes.getNamedItem(e)},setAttribute:function(e,t){this._isInHTMLDocumentAndNamespace()&&(e=e.toLowerCase());var r=this.getAttributeNode(e);r?r.value=r.nodeValue=""+t:((r=this.ownerDocument._createAttribute(e)).value=r.nodeValue=""+t,this.setAttributeNode(r))},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);r&&this.removeAttributeNode(r)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var r=this.getAttributeNodeNS(e,t);return r?r.value:null},setAttributeNS:function(e,t,r){var n=N(e,t)[2],i=this.getAttributeNodeNS(e,n);i?i.value=i.nodeValue=""+r:((i=this.ownerDocument.createAttributeNS(e,t)).value=i.nodeValue=""+r,this.setAttributeNode(i))},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByClassName:function(e){var t=w(e);return new V(this,(function(r){var n=[];return t.length>0&&Q(r,(function(i){if(i!==r&&i.nodeType===_){var o=i.getAttribute("class");if(o){var a=e===o;if(!a){var s=w(o);a=t.every((l=s,function(e){return l&&-1!==l.indexOf(e)}))}a&&n.push(i)}}var l})),n}))},getElementsByTagName:function(e){var t="html"===(this.nodeType===R?this:this.ownerDocument).type,r=e.toLowerCase();return new V(this,(function(n){var i=[];return Q(n,(function(o){o!==n&&o.nodeType===_&&("*"===e||o.getQualifiedName()===(t&&o.namespaceURI===p.HTML?r:e))&&i.push(o)})),i}))},getElementsByTagNameNS:function(e,t){return new V(this,(function(r){var n=[];return Q(r,(function(i){i===r||i.nodeType!==_||"*"!==e&&i.namespaceURI!==e||"*"!==t&&i.localName!=t||n.push(i)})),n}))}},K.prototype.getElementsByClassName=ce.prototype.getElementsByClassName,K.prototype.getElementsByTagName=ce.prototype.getElementsByTagName,K.prototype.getElementsByTagNameNS=ce.prototype.getElementsByTagNameNS,S(ce,X),ue.prototype.nodeType=T,S(ue,X),pe.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,r){r=this.data.substring(0,e)+r+this.data.substring(e+t),this.nodeValue=this.data=r,this.length=r.length}},S(pe,X),de.prototype={nodeName:"#text",nodeType:D,splitText:function(e){var t=this.data,r=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var n=this.ownerDocument.createTextNode(r);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}},S(de,pe),fe.prototype={nodeName:"#comment",nodeType:O},S(fe,pe),he.prototype={nodeName:"#cdata-section",nodeType:I},S(he,de),me.prototype.nodeType=L,S(me,X),ge.prototype.nodeType=M,S(ge,X),ye.prototype.nodeType=P,S(ye,X),ve.prototype.nodeType=x,S(ve,X),be.prototype.nodeName="#document-fragment",be.prototype.nodeType=F,S(be,X),we.prototype.nodeType=k,S(we,pe),Ee.prototype.serializeToString=function(e,t){return Ne.call(e,t)},X.prototype.toString=Ne;try{if(Object.defineProperty){function Ie(e){switch(e.nodeType){case _:case F:var t=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&t.push(Ie(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}}Object.defineProperty(V.prototype,"length",{get:function(){return q(this),this.$$length}}),Object.defineProperty(X.prototype,"textContent",{get:function(){return Ie(this)},set:function(e){switch(this.nodeType){case _:case F:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),De=function(e,t,r){e["$$"+t]=r}}}catch(xe){}t._updateLiveList=q,t.Attr=ue,t.CDATASection=he,t.CharacterData=pe,t.Comment=fe,t.Document=K,t.DocumentFragment=be,t.DocumentType=me,t.DOMImplementation=Y,t.Element=ce,t.Entity=ye,t.EntityReference=ve,t.LiveNodeList=V,t.NamedNodeMap=H,t.Node=X,t.NodeList=z,t.Notation=ge,t.Text=de,t.ProcessingInstruction=we,t.XMLSerializer=Ee},6944:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t,r){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){a(o,n,i,s,l,"next",e)}function l(e){a(o,n,i,s,l,"throw",e)}s(void 0)}))}}var l,c=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),u=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),p=this&&this.__importStar||(l=function(e){return l=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},l(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=l(e),n=0;n<r.length;n++)"default"!==r[n]&&c(t,e,r[n]);return u(t,e),t}),d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateTablesJSON=void 0,t.getAppDescription=function(e){return P.apply(this,arguments)},t.extractSolutionDetail=function(e,t,r){return k.apply(this,arguments)};var f=d(r(5271)),h=r(7985),m=p(r(5525)),g=r(1630),y=r(3067),v=r(9734),b=r(5483),w=d(r(8124)),E=r(6012),N=r(4248),A="application/xml",S={0:"Workflow",1:"Dialog",2:"Business Rule",3:"Action",4:"Business Process Flow",5:"Modern Flow",6:"Desktop Flow",7:"AI Flow"};function C(){return(C=s((function*(e){var t=[],r=[];try{var n=e.file("customizations.xml");if(!n)return m.default.error("No customizations.xml file found in the solution."),{mappings:t,mermaidExpressions:r};var i=yield n.async("string"),o=(new b.DOMParser,(0,E.safeParseXml)(i));if(!o)throw new Error("Failed to parse XML");return w.default.select("//CanvasApps/CanvasApp",o).filter((e=>1===e.nodeType)).forEach(((e,n)=>{var i=w.default.select1("Name",e),o=w.default.select1("DisplayName",e),a=(null==i?void 0:i.textContent)||"App_".concat(n),s=(null==o?void 0:o.textContent)||a,l=[],c=[],u=w.default.select1("ConnectionReferences",e),p=(null==u?void 0:u.textContent)||"";try{var d=JSON.parse(p);Object.values(d).forEach((e=>{var t,r;null!==(t=e.id)&&void 0!==t&&t.includes("shared_logicflows")&&null!==(r=e.parameterHints)&&void 0!==r&&null!==(r=r.workflowDisplayName)&&void 0!==r&&r.value&&l.push(e.parameterHints.workflowDisplayName.value)}))}catch(e){console.warn("Failed to parse ConnectionReferences JSON:",e)}var f=w.default.select1("DatabaseReferences",e),h=(null==f?void 0:f.textContent)||"";try{var m=JSON.parse(h);Object.values(m).forEach((e=>{e.dataSources&&Object.values(e.dataSources).forEach((e=>{e.entitySetName&&c.push(e.entitySetName)}))}))}catch(e){console.warn("Failed to parse DatabaseReferences JSON:",e)}t.push({appName:a,displayName:s,flows:l,tables:c}),r.push(function(e,t,r,n,i){var o="---\nconfig:\n  look: handDrawn\n---\n";return o+="%%{init: {'theme': 'neutral'}}%%\n\n",o+="graph TB;\n",o+="    classDef CanvasApps fill:#e7bfcf, stroke-width:0px,font-size: 24px;\n\n",o+='    subgraph Solution["'.concat(t,'"]\n'),o+="        style Solution stroke-width:0px\n",o+='        subgraph AppCluster["PowerApps"]\n',o+="            style AppCluster fill:#f5f5f5,stroke-width:0px;\n",o+="            App".concat(i,'["').concat(t,'"]:::CanvasApps\n'),o+="        end\n\n",r.length>0&&(o+='        subgraph FlowCluster["Power Automate"]\n',o+="            style FlowCluster fill:#edf5fa,stroke-width:0px;\n",r.forEach(((e,t)=>{o+="            Flow".concat(i,"_").concat(t,'["').concat(e,'"]\n')})),o+="        end\n\n",r.forEach(((e,t)=>{o+="        App".concat(i," --\x3e|depends on| Flow").concat(i,"_").concat(t,"\n")}))),n.length>0&&(o+='        subgraph TableCluster["Dataverse Tables"]\n',o+="            style TableCluster fill:#edfaf1,stroke-width:0px;\n",n.forEach(((e,t)=>{o+="            Table".concat(i,"_").concat(t,'["').concat(e,'"]\n')})),o+="        end\n\n",n.forEach(((e,t)=>{o+="        App".concat(i," --\x3e|depends on| Table").concat(i,"_").concat(t,"\n")}))),o+="    end\n"}(0,s,l,c,n))})),{mappings:t,mermaidExpressions:r}}catch(e){return m.default.error("Error processing customizations.xml:",e),{mappings:t,mermaidExpressions:r}}}))).apply(this,arguments)}function _(){return(_=s((function*(e){var t=e.file("solution.xml");if(t){var r,n,i,o=yield t.async("string"),a=(new b.DOMParser).parseFromString(o,A),s=(null===(r=a.getElementsByTagName("UniqueName")[0])||void 0===r?void 0:r.textContent)||"",l=w.default.select1("//LocalizedNames/LocalizedName",a),c=(null==l?void 0:l.getAttribute("description"))||"",u=w.default.select1("//Descriptions/Description",a);return{displayName:c,uniqueName:s,description:(null==u?void 0:u.getAttribute("description"))||"",version:(null===(n=a.getElementsByTagName("Version")[0])||void 0===n?void 0:n.textContent)||"",solutionType:"0"===(null===(i=a.getElementsByTagName("Managed")[0])||void 0===i?void 0:i.textContent)?"Unmanaged":"Managed"}}return console.error("solution.xml file not found."),null}))).apply(this,arguments)}function T(){return(T=s((function*(e){var t=e.file("AppCheckerResult.sarif");if(t)try{var r=yield t.async("string");return JSON.parse(r)}catch(e){(0,m.logError)(e,"Error parsing AppCheckerResult.sarif")}}))).apply(this,arguments)}function D(){return(D=s((function*(e){var t=e.folder("Src"),r={};if(t){var n=Object.keys(t.files).filter((e=>e.endsWith(".pa.yaml")&&!t.files[e].dir));for(var i of n){var o=e.file(i);if(o){var a,s=yield o.async("string"),l=null===(a=i.split(/[/\\]/).pop())||void 0===a?void 0:a.replace(".pa.yaml","");console.log(l),l&&(r[l]={screenName:l,screenYaml:s},console.log("Processed File: ".concat(i,", Screen: ").concat(l)))}else console.error("File not found: ".concat(i))}}else console.error("Src folder not found inside the .msapp file.");return r}))).apply(this,arguments)}function I(){return I=s((function*(e,t){try{var r=yield e.async("arraybuffer"),n=yield f.default.loadAsync(r),i=(0,v.createMsApp)();yield Promise.all([(0,y.readPropertiesFile)(n,i)]);var o=i.appSettings.Name.toLowerCase().endsWith(".msapp")?decodeURI(i.appSettings.Name.substring(0,i.appSettings.Name.length-6)).replace(/%2B/g," ").replace(/%2b/g,"+")||i.appSettings.Name||"Unknown App Name":i.appSettings.Name,a=i.appSettings.AppDescription||"",s=yield function(e){return D.apply(this,arguments)}(n),l=yield function(e){return T.apply(this,arguments)}(n),c={appName:o,appDescription:a,screens:Object.values(s),sarifLog:l};t.push(c)}catch(t){console.error("Error processing app ".concat(e.name,":"),t)}})),I.apply(this,arguments)}function x(){return x=s((function*(e){var t=e.folder("CanvasApps"),r={canvasApps:[]};if(!t)return console.error("No CanvasApps folder found in the solution."),r;var n=[];return t.forEach(((e,t)=>{e.endsWith(".msapp")&&n.push(function(e,t){return I.apply(this,arguments)}(t,r.canvasApps))})),yield Promise.all(n),r})),x.apply(this,arguments)}function P(){return(P=s((function*(e){var t=e.file("Properties.json");if(!t)return m.default.error("Properties.json file not found in the .msapp file."),"";try{var r=yield t.async("string");return JSON.parse(r).AppDescription}catch(e){return(0,m.logError)(e,"Error parsing Properties.json"),""}}))).apply(this,arguments)}function k(){return k=s((function*(e,r,n){try{var o;if(r){var a={SolutionName:r,Managed:!1,getMetadata:()=>({boundParameter:null,parameterTypes:{SolutionName:{typeName:"Edm.String",structuralProperty:1},Managed:{typeName:"Edm.Boolean",structuralProperty:1}},operationType:0,operationName:"ExportSolution"})};try{var s=yield n.execute(a),l=yield s.json();if(null==l||!l.ExportSolutionFile)return void console.error("No solution found or failed to export the solution.");var c=(q=l.ExportSolutionFile,W="function"==typeof atob?atob(q):Buffer.from(q,"base64").toString("binary"),Uint8Array.from(W,(e=>e.charCodeAt(0)))),u=new f.default;o=yield u.loadAsync(new File([new Blob([c.buffer],{type:"application/zip"})],r))}catch(e){return void(e instanceof Error?console.error("Error exporting the solution:",e.message,e.stack):console.error("Unknown error occurred during solution export:",e))}}else if(e){var p=new f.default;o=yield p.loadAsync(e)}if(o){var d=yield function(e){return x.apply(this,arguments)}(o),h=yield function(e){return _.apply(this,arguments)}(o),m=yield function(e){return U.apply(this,arguments)}(o),g=yield function(e){return B.apply(this,arguments)}(o),y=yield function(e){return j.apply(this,arguments)}(o),v=yield function(e){return H.apply(this,arguments)}(o),b={roles:[]};yield function(e,t){return F.apply(this,arguments)}(o,b);var w={plugins:[]};yield function(e,t){return M.apply(this,arguments)}(o,w);var E={connectionReferences:[]};yield function(e,t){return L.apply(this,arguments)}(o,E);var A={aiModels:[]};yield function(e,t){return R.apply(this,arguments)}(o,A);var S,T={missingDependencies:[]};yield function(e,t){return O.apply(this,arguments)}(o,T);try{S=yield(0,t.generateTablesJSON)(o)}catch(e){S={tables:[]}}var{mappings:D,mermaidExpressions:I}=yield function(e){return C.apply(this,arguments)}(o),{agents:P}=yield(0,N.extractAgentsDetails)(o),k={solutionOverview:h,canvasApps:d.canvasApps,tables:S.tables,workflows:m.workflows,codeComponents:g.codeComponents,customApis:y.customApis,environmentVariables:v.environmentVariables,securityRoles:b.roles,plugins:w.plugins,connectionReferences:E.connectionReferences,aiModels:A.aiModels,missingDependencies:T.missingDependencies,agents:P},z=function(e){var{solutionOverview:t,canvasApps:r,workflows:n,tables:i}=e,o="%%{init: {'theme': 'base', 'themeVariables': {\n    'primaryColor': '#ffffff',\n    'primaryBorderColor': '#333333',\n    'clusterBkg': '#EBAED5',   /* PowerApps */\n    'clusterBorder': '#D38EBB',\n    'secondaryClusterBkg': '#72BDFD',  /* Power Automate */\n    'secondaryClusterBorder': '#5595DA',\n    'tertiaryClusterBkg': '#107C10', /* Dataverse */\n    'tertiaryClusterBorder': '#0E6A0E',\n    'fontFamily': 'Arial'\n}}}%%\n\n";o+='graph TB;\n    Solution["🎁 <b>Solution: '.concat(t.displayName,'</b>"]\n\n');var a=(e,t,r,n,i)=>{var o="    subgraph ".concat(t,'Cluster["').concat(r,'"]\n');o+="        style ".concat(t,"Cluster fill:").concat(n,",stroke:").concat(i,",stroke-width:2px;\n"),e.slice(0,3).forEach(((e,r)=>{var n=e.appName||e.displayName||e.name||e.SchemaName||"Unnamed";o+="        ".concat(t).concat(r,'["').concat(n,'"]\n')}));var a=e.length-3;return a>0&&(o+="        ".concat(t,'More["📄 ... +').concat(a,' more"]\n')),o+="    end\n",o+="    Solution --\x3e|Contains| ".concat(t,"Cluster\n\n")};return r.length&&(o+=a(r,"App","PowerApps","#b45792","#D38EBB")),n.length&&(o+=a(n,"Flow","Power Automate","#72BDFD","#5595DA")),i.length&&(o+=a(i,"Table","Dataverse Tables","#107C10","#0E6A0E")),o}(k),V=function(e){var{tables:t}=e,r="erDiagram\n";return t.forEach((e=>{r+="    ".concat(e.SchemaName," {\n"),e.Fields.forEach((e=>{r+="        ".concat(e.DataType," ").concat(e.Name,"\n")})),r+="    }\n"})),t.forEach((e=>{e.Relationships.OneToMany.forEach((e=>{r+="    ".concat(e.ReferencingEntity," ||--o| ").concat(e.ReferencedEntity,' : "').concat(e.SchemaName,'"\n')})),e.Relationships.ManyToMany.forEach((e=>{r+="    ".concat(e.Entity1LogicalName," }|--|{ ").concat(e.Entity2LogicalName,' : "').concat(e.SchemaName,'"\n')})),e.Relationships.ManyToOne.forEach((e=>{r+="    ".concat(e.ReferencedEntity," o|--|| ").concat(e.ReferencedEntity,' : "').concat(e.SchemaName,'"\n')}))})),r}(k);return console.log("Extracted Solution Details:",i({mermaidSolutionOverviewExpression:z,mermaidERDiagram:V,mermaidSolutionArchitectureExpressions:I},k)),i({mermaidSolutionOverviewExpression:z,mermaidERDiagramExpression:V,mermaidSolutionArchitectureExpressions:I},k)}throw new Error("Invalid solution ZIP file.")}catch(e){e instanceof Error?console.error("An error occurred during review:",e.message,e.stack):console.error("Unknown error during review:",e)}var q,W})),k.apply(this,arguments)}function O(){return(O=s((function*(e,t){try{var r=e.file("solution.xml");if(!r)return void console.error("No solution.xml found in the solution.");var n=yield r.async("string"),i=(new b.DOMParser,(0,E.safeParseXml)(n));if(!i)return;var o=w.default.select("//SolutionManifest/MissingDependencies/MissingDependency",i).filter((e=>1===e.nodeType));for(var a of o){var s=w.default.select1("Required",a),l=w.default.select1("Dependent",a),c=parseInt((null==s?void 0:s.getAttribute("type"))||"0",10),u=parseInt((null==l?void 0:l.getAttribute("type"))||"0",10);t.missingDependencies.push({Required:{Type:g.typeMap[c]||"",SchemaName:(null==s?void 0:s.getAttribute("schemaName"))||"",DisplayName:(null==s?void 0:s.getAttribute("displayName"))||"",Solution:(null==s?void 0:s.getAttribute("solution"))||""},Dependent:{Type:g.typeMap[u]||"",SchemaName:(null==l?void 0:l.getAttribute("schemaName"))||"",DisplayName:(null==l?void 0:l.getAttribute("displayName"))||""}})}}catch(e){console.error("Error processing missing dependencies:",e)}}))).apply(this,arguments)}function R(){return(R=s((function*(e,t){try{var r=e.file("customizations.xml");if(!r)return;var n=yield r.async("string"),i=(new b.DOMParser,(0,E.safeParseXml)(n));if(!i)return;w.default.select("//AIModels/AIModel",i).filter((e=>1===e.nodeType)).forEach((e=>{var r=w.default.select1("string(msdyn_name)",e),n=w.default.select1("string(AIConfigurations/AIConfiguration/msdyn_customconfiguration)",e),i="";if(n)try{var o,a=JSON.parse(n);i=(null==a||null===(o=a.modelParameters)||void 0===o?void 0:o.modelType)||""}catch(e){console.warn("Failed to parse msdyn_customconfiguration JSON:",e)}t.aiModels.push({Name:r,Model:i})}))}catch(e){console.error("Error processing AI models from customizations.xml:",e)}}))).apply(this,arguments)}function L(){return(L=s((function*(e,t){try{var r=e.file(h.customizationFileName);if(!r)return;var n=yield r.async("string"),i=(0,E.safeParseXml)(n);if(!i)return;w.default.select("//connectionreferences/connectionreference",i).filter((e=>1===e.nodeType)).forEach((e=>{var t=e.getAttribute("connectionreferencelogicalname")||"",r=w.default.select1("connectionreferencedisplayname",e),n=w.default.select1("connectorid",e),i=(null==r?void 0:r.textContent)||"",o=(null==n?void 0:n.textContent)||"";console.log({logicalName:t,displayName:i,connectorID:o})}))}catch(e){console.error("Error processing connection references:",e)}}))).apply(this,arguments)}function F(){return(F=s((function*(e,t){try{var r=e.file(h.customizationFileName);if(!r)return;var n=yield r.async("string"),i=(new b.DOMParser,(0,E.safeParseXml)(n));if(!i)return;w.default.select("//Roles/Role",i).filter((e=>1===e.nodeType)).forEach((e=>{e.getAttribute("id");var r=e.getAttribute("name")||"";t.roles.push({name:r})}))}catch(e){console.error("Error processing security roles:",e)}}))).apply(this,arguments)}function M(){return(M=s((function*(e,t){try{var r=e.file(h.customizationFileName);if(!r)return;var n=yield r.async("string"),i=(0,E.safeParseXml)(n);if(!i)return;w.default.select("//SolutionPluginAssemblies/PluginAssembly",i).filter((e=>1===e.nodeType)).forEach((e=>{w.default.select("PluginTypes/PluginType",e).filter((e=>1===e.nodeType)).forEach((e=>{var r=e.getAttribute("Name")||"";t.plugins.push({Name:r})}))}))}catch(e){console.error("Error processing plugins from customizations.xml:",e)}}))).apply(this,arguments)}function U(){return(U=s((function*(e){var t={workflows:[]},r=e.file("customizations.xml");if(!r)return console.error("No customizations.xml file found in the solution."),t;console.log("customizations.xml file found. Parsing XML...");var n,i=yield r.async("string"),o=new b.DOMParser;try{n=o.parseFromString(i,A)}catch(e){return console.error("Failed to parse customizations.xml content:",e),t}var a=w.default.select1("//ImportExportXml/Workflows",n);if(!a)return console.error("No Workflows node found in the customizations.xml file."),t;var s=w.default.select("Workflow",a),l=Array.from(s);for(var c of l)try{var u,p,d,f,h,m=null!==(u=c.getAttribute("Name"))&&void 0!==u?u:"None",g=null!==(p=null===(d=w.default.select1("PrimaryEntity",c))||void 0===d?void 0:d.textContent)&&void 0!==p?p:"None",y=null!==(f=null===(h=w.default.select1("Category",c))||void 0===h?void 0:h.textContent)&&void 0!==f?f:"0",v=parseInt(y,10),E={name:m,primaryEntity:g,category:S[v],json:void 0};if(5===v){var N,C,_=null!==(N=null===(C=w.default.select1("JsonFileName",c))||void 0===C?void 0:C.textContent)&&void 0!==N?N:"";if(_){_=_.startsWith("/")?_.slice(1):_;var T=e.file(_);if(T)try{var D=yield T.async("string");E.json=D}catch(e){console.error("Failed to read or parse JSON from ".concat(_,":"),e)}else console.warn("JSON file ".concat(_," referenced but not found in the zip."))}else console.warn("No JsonFileName specified for workflow with category 5.")}t.workflows.push(E)}catch(e){console.error("Error processing workflow node:",e)}return 0===t.workflows.length?console.warn("No workflows processed. The solution may not contain valid workflows."):console.log("Successfully processed ".concat(t.workflows.length," workflows.")),t}))).apply(this,arguments)}function B(){return(B=s((function*(e){var t={codeComponents:[]},r=e.folder("Controls");if(!r)return t;var n=[];return r.forEach(((e,r)=>{e.endsWith("ControlManifest.xml")&&n.push(s((function*(){try{var n,i,o,a,s=yield r.async("string"),l=(new b.DOMParser).parseFromString(s,A),c=w.default.select1("//control",l),u=null!==(n=null==c?void 0:c.getAttribute("display-name-key"))&&void 0!==n?n:"",p=null!==(i=null==c?void 0:c.getAttribute("description-key"))&&void 0!==i?i:"",d=null!==(o=null==c?void 0:c.getAttribute("control-type"))&&void 0!==o?o:"",f=null!==(a=null==c?void 0:c.getAttribute("version"))&&void 0!==a?a:"";t.codeComponents.push({displayName:u,description:p,type:d,version:f})}catch(t){console.error("Error processing ControlManifest.xml in ".concat(e,":"),t)}}))())})),yield Promise.all(n),t}))).apply(this,arguments)}function j(){return j=s((function*(e){var t={customApis:[]},r=e.folder("customapis");if(!r)return console.error("No customapis folder found in the solution."),t;var n=[];return r.forEach(((r,i)=>{!i.dir&&r.endsWith("customapi.xml")?n.push(V(i,r,t)):i.dir&&n.push(function(e,t,r,n){return z.apply(this,arguments)}(r,i,e,t))})),yield Promise.all(n),console.log("Successfully processed ".concat(t.customApis.length," custom APIs.")),t})),j.apply(this,arguments)}function z(){return(z=s((function*(e,t,r,n){var i=r.folder(e);if(i){var o=i.file("customapi.xml");o?yield V(o,e,n):console.error("customapi.xml not found in ".concat(e,". Skipping this folder."))}}))).apply(this,arguments)}function V(e,t,r){return q.apply(this,arguments)}function q(){return(q=s((function*(e,t,r){try{var n,i,o=yield e.async("string"),a=(new b.DOMParser).parseFromString(o,A),s=w.default.select1("//customapi/displayname",a),l=w.default.select1("//customapi/description",a),c=w.default.select1("//customapi/isprivate",a),u=w.default.select1("//customapi/isfunction",a),p=null!==(n=null==s?void 0:s.getAttribute("default"))&&void 0!==n?n:"",d=null!==(i=null==l?void 0:l.getAttribute("default"))&&void 0!==i?i:"",f="1"===(null==c?void 0:c.textContent),h="1"===(null==u?void 0:u.textContent);r.customApis.push({displayName:p,description:d,isPrivate:f,isFunction:h})}catch(e){console.error("Error processing customapi.xml in ".concat(t,":"),e)}}))).apply(this,arguments)}function H(){return H=s((function*(e){var t={environmentVariables:[]},r=e.folder("environmentvariabledefinitions");if(!r)return console.error("No environmentvariabledefinitions folder found in the solution."),t;var n=[];return r.forEach(((r,i)=>{i.dir?n.push(function(e,t,r,n){return W.apply(this,arguments)}(r,i,e,t)):r.endsWith("environmentvariabledefinition.xml")&&n.push(G(i,r,t))})),yield Promise.all(n),t})),H.apply(this,arguments)}function W(){return(W=s((function*(e,t,r,n){var i=r.folder(e);if(i){var o=i.file("environmentvariabledefinition.xml");o?yield G(o,e,n):console.error("environmentvariabledefinition.xml not found in ".concat(e,". Skipping this folder."))}}))).apply(this,arguments)}function G(e,t,r){return Y.apply(this,arguments)}function Y(){return(Y=s((function*(e,t,r){try{var n,i,o,a,s=yield e.async("string"),l=(new b.DOMParser).parseFromString(s,A),c=w.default.select1("//environmentvariabledefinition/displayname",l),u=w.default.select1("//environmentvariabledefinition/displayname/label",l),p=w.default.select1("//environmentvariabledefinition/type",l),d=null!==(n=null==c?void 0:c.getAttribute("default"))&&void 0!==n?n:"",f=null!==(i=null==u?void 0:u.getAttribute("description"))&&void 0!==i?i:"",h=null!==(a={1e8:"String",100000001:"Number",100000002:"Boolean",100000003:"JSON",100000004:"Data Source",100000005:"Secret"}[null!==(o=null==p?void 0:p.textContent)&&void 0!==o?o:""])&&void 0!==a?a:"Unknown";r.environmentVariables.push({displayName:d,description:f,type:h})}catch(e){console.error("Error processing environmentvariabledefinition.xml in ".concat(t,":"),e)}}))).apply(this,arguments)}function X(){return(X=s((function*(e,t){var r={OneToMany:[],ManyToOne:[],ManyToMany:[]};try{var n=w.default.select("//EntityRelationships/EntityRelationship",e);for(var i of n)if(1===i.nodeType){var o=i,a=w.default.select1("string(ReferencingEntityName)",o),s=w.default.select1("string(ReferencedEntityName)",o),l=w.default.select1("string(FirstEntityName)",o),c=w.default.select1("string(SecondEntityName)",o),u="string"==typeof a?a:void 0,p="string"==typeof s?s:void 0,d="string"==typeof l?l:void 0,f="string"==typeof c?c:void 0;Z(o,u,p,t,r),Q(o,u,p,t,r),K(o,d,f,t,r)}0===r.OneToMany.length&&0===r.ManyToOne.length&&0===r.ManyToMany.length&&console.warn("No relationships found for schema: ".concat(t))}catch(e){console.error("Error parsing relationships for schema: ".concat(t),e)}return r}))).apply(this,arguments)}function Z(e,t,r,n,i){var o;if("OneToMany"===w.default.select1("string(EntityRelationshipType)",e)&&t===n&&null!==(o=null==r?void 0:r.includes("_"))&&void 0!==o&&o){var a=e.getAttribute("Name")||"",s=w.default.select1("string(ReferencingAttributeName)",e)||"";i.OneToMany.push({SchemaName:a,ReferencingEntity:t||"",ReferencingAttribute:s,ReferencedEntity:r||""})}}function Q(e,t,r,n,i){if("ManyToOne"===w.default.select1("string(EntityRelationshipType)",e)&&r===n&&(null!=t&&t.includes("_")||null!=r&&r.includes("_"))){var o=e.getAttribute("Name")||"",a=w.default.select1("string(ReferencingAttributeName)",e)||"";i.ManyToOne.push({SchemaName:o,ReferencedEntity:r||"",ReferencingAttribute:a})}}function K(e,t,r,n,i){if("ManyToMany"===w.default.select1("string(EntityRelationshipType)",e)&&(t===n||r===n)&&(null!=t&&t.includes("_")||null!=r&&r.includes("_"))){var o=e.getAttribute("Name")||"";i.ManyToMany.push({SchemaName:o,Entity1LogicalName:t||"",Entity2LogicalName:r||""})}}var J=function(){var e=s((function*(e){console.log("Generating Tables JSON from customizations.xml");var t={tables:[]};try{var r=e.file(h.customizationFileName);if(!r)return t;var n=yield r.async("string"),i=(new b.DOMParser,(0,E.safeParseXml)(n));if(!i)return t;var o=w.default.select("//Entities/Entity/Name",i);if(0===o.length)return t;var a=function*(){var{displayName:e,description:r,schemaName:n}=function(e,t){var r=w.default.select1("string(../EntityInfo/entity/@Name)",t)||"Unknown Schema Name";return{displayName:w.default.select1("string(../EntityInfo/entity/LocalizedNames/LocalizedName[@languagecode='1033']/@description)",t)||"Unnamed Table",description:w.default.select1("string(../EntityInfo/entity/Descriptions/Description[@languagecode='1033']/@description)",t)||"",schemaName:r}}(0,s),o={DisplayName:e,SchemaName:n,Description:r,Fields:[],Relationships:{OneToMany:[],ManyToOne:[],ManyToMany:[]}},a=yield function(e,t){return $.apply(this,arguments)}(i,n);a.forEach((e=>{o.Fields.push({Name:e.Name,SchemaName:e.SchemaName,DataType:e.DataType})}));var l=yield function(e,t){return X.apply(this,arguments)}(i,n);l.OneToMany.forEach((e=>{o.Relationships.OneToMany.push({SchemaName:e.SchemaName,ReferencingEntity:e.ReferencingEntity||"",ReferencingAttribute:e.ReferencingAttribute||"",ReferencedEntity:e.ReferencedEntity||""})})),l.ManyToOne.forEach((e=>{o.Relationships.ManyToOne.push({SchemaName:e.SchemaName,ReferencedEntity:e.ReferencedEntity||"",ReferencingAttribute:e.ReferencingAttribute||""})})),l.ManyToMany.forEach((e=>{o.Relationships.ManyToMany.push({SchemaName:e.SchemaName,Entity1LogicalName:e.Entity1LogicalName||"",Entity2LogicalName:e.Entity2LogicalName||""})})),t.tables.push(o)};for(var s of o)yield*a();return console.log("Generated Tables JSON:",JSON.stringify(t,null,2)),t}catch(e){throw console.error("Error generating Tables JSON:",e),new Error("Failed to generate Tables JSON. See console for details.")}}));return function(t){return e.apply(this,arguments)}}();function $(){return($=s((function*(e,t){var r=[],n=w.default.select("//Entities/Entity",e);for(var i of n)if(1===i.nodeType){var o=i,a=w.default.select1("string(Name)",o);if(("string"==typeof a?a:"")===t){var s=w.default.select("attributes/attribute",o);for(var l of s)if(1===l.nodeType){var c=l,u=w.default.select1("string(Name)",c),p=w.default.select1("string(Type)",c),d=w.default.select1("string(LogicalName)",c),f="string"==typeof u?u:"",h="string"==typeof p?p:"";("string"==typeof d?d:"").includes("_")&&r.push({Name:f,SchemaName:t,DataType:h})}}}return r}))).apply(this,arguments)}t.generateTablesJSON=J},7004:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getItemsFromDataset=function(e){if(e.error||void 0===e.paging.totalResultCount)return[];var t={};return e.sortedRecordIds.map((r=>{var n=e.records[r],i=n.getValue("PatternID");return void 0!==t[i]?(t[i]++,i+="_".concat(t[i])):t[i]=1,{id:n.getRecordId(),key:i,text:n.getFormattedValue("PatternName"),clickable:!0,data:{patternID:n.getValue("PatternID"),patternName:n.getValue("PatternName"),description:n.getValue("PatternDescription"),recommendation:n.getValue("PatternRecommendation"),docLinks:n.getValue("PatternDocLink"),severity:n.getValue("PatternSeverity"),category:n.getValue("PatternCategory"),patternType:n.getValue("PatternType"),patternScore:n.getValue("PatternScore"),patternActive:n.getValue("PatternActive")}}}))},t.generateSarifFromReview=function(e){var t=(e,t)=>{var r=new Map,n=[];return t.result.forEach((i=>{r.has(i.patternID)||r.set(i.patternID,{id:i.patternID,name:i.patternID,shortDescription:{text:i.description||"No description provided."},helpUri:Array.isArray(i.docLinks)?i.docLinks[0]:i.docLinks}),i.instanceValue&&Array.isArray(i.instanceValue)&&i.instanceValue.forEach((r=>{i.description;var o={startLine:1};if("PowerApps"===e){var a=r;if(a.Code&&a.FailedPowerFxCode){var s=a.Code,l=a.FailedPowerFxCode,c=s.indexOf(l);-1!==c&&(o={startLine:1,startColumn:c+1,endColumn:c+l.length+1,snippet:{text:s}}),"".concat(i.description,": ").concat(l)}}else if("PowerAutomate"===e){var u=r;"".concat(i.description,": ").concat(u)}else if("Copilot"===e){var p=r;"".concat(i.description,": ").concat(JSON.stringify(p))}n.push({ruleId:i.patternID,level:"Pass"===i.status?"note":"Fail"===i.status?"error":"warning",message:{text:i.description,markdown:"PowerApps"===e&&r.FailedPowerFxCode?"```powerfx\n".concat(r.FailedPowerFxCode,"\n```"):void 0},locations:[{physicalLocation:{artifactLocation:{uri:"".concat(e,"/").concat(t.name)+("PowerApps"===e?"/".concat(r.ScreenName,"/").concat(r.ControlName):"")},region:o}}],properties:{component:e,name:t.name,score:t.score}})}))})),{tool:{driver:{name:"".concat(e,": ").concat(t.displayName||t.name),informationUri:"https://github.com/microsoft/Power-CAT-Tools",rules:Array.from(r.values())}},properties:{componentType:e,componentName:t.displayName||t.name,componentScore:t.score},results:n}};return{version:"2.1.0",properties:{solutionScore:e.SolutionScore},$schema:"https://schemastore.azurewebsites.net/schemas/json/sarif-2.1.0-rtm.5.json",runs:[...e.PowerApps.items.map((e=>t("PowerApps",e))),...e.PowerAutomate.items.map((e=>t("PowerAutomate",e))),...e.Copilot.items.map((e=>t("Copilot",e)))]}}},7087:(e,t,r)=>{"use strict";var n=r(3715),i=r(3114),o=r(9284),a=n.isHTMLEscapableRawTextElement,s=n.isHTMLMimeType,l=n.isHTMLRawTextElement,c=n.hasOwn,u=n.NAMESPACE,p=o.ParseError,d=o.DOMException;function f(){}f.prototype={parse:function(e,t,r){var o=this.domBuilder;o.startDocument(),b(t,t=Object.create(null)),function(e,t,r,o,a){var l=s(o.mimeType);function u(e){var t=";"===e[e.length-1]?e:e+";";if(!l&&t!==e)return a.error("EntityRef: expecting ;"),e;var n=i.Reference.exec(t);if(!n||n[0].length!==t.length)return a.error("entity not matching Reference production: "+e),e;var o=t.slice(1,-1);return c(r,o)?r[o]:"#"===o.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),r=56320+(1023&e);return String.fromCharCode(t,r)}return String.fromCharCode(e)}(parseInt(o.substring(1).replace("x","0x"))):(a.error("entity not found:"+e),e)}function f(t){if(t>I){var r=e.substring(I,t).replace(h,u);C&&_(I),o.characters(r,0,t-I),I=t}}e.indexOf(i.UNICODE_REPLACEMENT_CHARACTER)>=0&&a.warning("Unicode replacement character detected, source encoding issues?");var b=0,w=0,S=/\r\n?|\n|$/g,C=o.locator;function _(t,r){for(;t>=w&&(r=S.exec(e));)b=w,w=r.index+r[0].length,C.lineNumber++;C.columnNumber=t-b+1}for(var T=[{currentNSMap:t}],D=[],I=0;;){try{var x=e.indexOf("<",I);if(x<0){if(!l&&D.length>0)return a.fatalError("unclosed xml tag(s): "+D.join(", "));if(!e.substring(I).match(/^\s*$/)){var P=o.doc,k=P.createTextNode(e.substring(I));if(P.documentElement)return a.error("Extra content at the end of the document");P.appendChild(k),o.currentElement=k}return}if(x>I){var O=e.substring(I,x);l||0!==D.length||(O=O.replace(new RegExp(i.S_OPT.source,"g"),""))&&a.error("Unexpected content outside root element: '"+O+"'"),f(x)}switch(e.charAt(x+1)){case"/":var R=e.indexOf(">",x+2),L=e.substring(x+2,R>0?R:void 0);if(!L)return a.fatalError("end tag name missing");var F=R>0&&i.reg("^",i.QName_group,i.S_OPT,"$").exec(L);if(!F)return a.fatalError('end tag name contains invalid characters: "'+L+'"');if(!o.currentElement&&!o.doc.documentElement)return;var M=D[D.length-1]||o.currentElement.tagName||o.doc.documentElement.tagName||"";if(M!==F[1]){var U=F[1].toLowerCase();if(!l||M.toLowerCase()!==U)return a.fatalError('Opening and ending tag mismatch: "'+M+'" != "'+L+'"')}var B=T.pop();D.pop();var j=B.localNSMap;if(o.endElement(B.uri,B.localName,M),j)for(var z in j)c(j,z)&&o.endPrefixMapping(z);R++;break;case"?":C&&_(x),R=N(e,x,o,a);break;case"!":C&&_(x),R=E(e,x,o,a,l);break;default:C&&_(x);var V=new A,q=T[T.length-1].currentNSMap,H=(R=g(e,x,V,0,u,a,l),V.length);if(V.closed||(l&&n.isHTMLVoidElement(V.tagName)?V.closed=!0:D.push(V.tagName)),C&&H){for(var W=m(C,{}),G=0;G<H;G++){var Y=V[G];_(Y.offset),Y.locator=m(C,{})}o.locator=W,y(V,o,q)&&T.push(V),o.locator=C}else y(V,o,q)&&T.push(V);l&&!V.closed?R=v(e,R,V.tagName,u,o):R++}}catch(e){if(e instanceof p)throw e;if(e instanceof d)throw new p(e.name+": "+e.message,o.locator,e);a.error("element parse error: "+e),R=-1}R>I?I=R:f(Math.max(x,I)+1)}}(e,t,r,o,this.errorHandler),o.endDocument()}};var h=/&#?\w+;?/g;function m(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function g(e,t,r,n,i,o,a){function s(e,t,n){return c(r.attributeNames,e)?o.fatalError("Attribute "+e+" redefined"):!a&&t.indexOf("<")>=0?o.fatalError("Unescaped '<' not allowed in attributes values"):void r.addValue(e,t.replace(/[\t\n\r]/g," ").replace(h,i),n)}for(var l,u=++t,p=0;;){var d=e.charAt(u);switch(d){case"=":if(1===p)l=e.slice(t,u),p=3;else{if(2!==p)throw new Error("attribute equal must after attrName");p=3}break;case"'":case'"':if(3===p||1===p){if(1===p&&(o.warning('attribute value must after "="'),l=e.slice(t,u)),t=u+1,!((u=e.indexOf(d,t))>0))throw new Error("attribute value no end '"+d+"' match");s(l,f=e.slice(t,u),t-1),p=5}else{if(4!=p)throw new Error('attribute value must after "="');s(l,f=e.slice(t,u),t),o.warning('attribute "'+l+'" missed start quot('+d+")!!"),t=u+1,p=5}break;case"/":switch(p){case 0:r.setTagName(e.slice(t,u));case 5:case 6:case 7:p=7,r.closed=!0;case 4:case 1:break;case 2:r.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return o.error("unexpected end of input"),0==p&&r.setTagName(e.slice(t,u)),u;case">":switch(p){case 0:r.setTagName(e.slice(t,u));case 5:case 6:case 7:break;case 4:case 1:"/"===(f=e.slice(t,u)).slice(-1)&&(r.closed=!0,f=f.slice(0,-1));case 2:2===p&&(f=l),4==p?(o.warning('attribute "'+f+'" missed quot(")!'),s(l,f,t)):(a||o.warning('attribute "'+f+'" missed value!! "'+f+'" instead!!'),s(f,f,t));break;case 3:if(!a)return o.fatalError("AttValue: ' or \" expected")}return u;case"":d=" ";default:if(d<=" ")switch(p){case 0:r.setTagName(e.slice(t,u)),p=6;break;case 1:l=e.slice(t,u),p=2;break;case 4:var f=e.slice(t,u);o.warning('attribute "'+f+'" missed quot(")!!'),s(l,f,t);case 5:p=6}else switch(p){case 2:a||o.warning('attribute "'+l+'" missed value!! "'+l+'" instead2!!'),s(l,l,t),t=u,p=1;break;case 5:o.warning('attribute space is required"'+l+'"!!');case 6:p=1,t=u;break;case 3:p=4,t=u;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}u++}}function y(e,t,r){for(var n=e.tagName,i=null,o=e.length;o--;){var a=e[o],s=a.qName,l=a.value;if((h=s.indexOf(":"))>0)var p=a.prefix=s.slice(0,h),d=s.slice(h+1),f="xmlns"===p&&d;else d=s,p=null,f="xmlns"===s&&"";a.localName=d,!1!==f&&(null==i&&(i=Object.create(null),b(r,r=Object.create(null))),r[f]=i[f]=l,a.uri=u.XMLNS,t.startPrefixMapping(f,l))}for(o=e.length;o--;)(a=e[o]).prefix&&("xml"===a.prefix&&(a.uri=u.XML),"xmlns"!==a.prefix&&(a.uri=r[a.prefix]));var h;(h=n.indexOf(":"))>0?(p=e.prefix=n.slice(0,h),d=e.localName=n.slice(h+1)):(p=null,d=e.localName=n);var m=e.uri=r[p||""];if(t.startElement(m,d,n,e),!e.closed)return e.currentNSMap=r,e.localNSMap=i,!0;if(t.endElement(m,d,n),i)for(p in i)c(i,p)&&t.endPrefixMapping(p)}function v(e,t,r,n,i){var o=a(r);if(o||l(r)){var s=e.indexOf("</"+r+">",t),c=e.substring(t+1,s);return o&&(c=c.replace(h,n)),i.characters(c,0,c.length),s}return t+1}function b(e,t){for(var r in e)c(e,r)&&(t[r]=e[r])}function w(e,t){var r=t;function n(t){return t=t||0,e.charAt(r+t)}function o(e){r+=e=e||1}function a(){return e.substring(r)}return{char:n,getIndex:function(){return r},getMatch:function(e){var t=i.reg("^",e).exec(a());return t?(o(t[0].length),t[0]):null},getSource:function(){return e},skip:o,skipBlanks:function(){for(var t=0;r<e.length;){var i=n();if(" "!==i&&"\n"!==i&&"\t"!==i&&"\r"!==i)return t;t++,o()}return-1},substringFromIndex:a,substringStartsWith:function(t){return e.substring(r,r+t.length)===t},substringStartsWithCaseInsensitive:function(t){return e.substring(r,r+t.length).toUpperCase()===t.toUpperCase()}}}function E(e,t,r,n,o){var a=w(e,t);switch(o?a.char(2).toUpperCase():a.char(2)){case"-":var s=a.getMatch(i.Comment);return s?(r.comment(s,i.COMMENT_START.length,s.length-i.COMMENT_START.length-i.COMMENT_END.length),a.getIndex()):n.fatalError("comment is not well-formed at position "+a.getIndex());case"[":var l=a.getMatch(i.CDSect);return l?o||r.currentElement?(r.startCDATA(),r.characters(l,i.CDATA_START.length,l.length-i.CDATA_START.length-i.CDATA_END.length),r.endCDATA(),a.getIndex()):n.fatalError("CDATA outside of element"):n.fatalError("Invalid CDATA starting at position "+t);case"D":if(r.doc&&r.doc.documentElement)return n.fatalError("Doctype not allowed inside or after documentElement at position "+a.getIndex());if(o?!a.substringStartsWithCaseInsensitive(i.DOCTYPE_DECL_START):!a.substringStartsWith(i.DOCTYPE_DECL_START))return n.fatalError("Expected "+i.DOCTYPE_DECL_START+" at position "+a.getIndex());if(a.skip(i.DOCTYPE_DECL_START.length),a.skipBlanks()<1)return n.fatalError("Expected whitespace after "+i.DOCTYPE_DECL_START+" at position "+a.getIndex());var c={name:void 0,publicId:void 0,systemId:void 0,internalSubset:void 0};if(c.name=a.getMatch(i.Name),!c.name)return n.fatalError("doctype name missing or contains unexpected characters at position "+a.getIndex());if(o&&"html"!==c.name.toLowerCase()&&n.warning("Unexpected DOCTYPE in HTML document at position "+a.getIndex()),a.skipBlanks(),a.substringStartsWith(i.PUBLIC)||a.substringStartsWith(i.SYSTEM)){var u=i.ExternalID_match.exec(a.substringFromIndex());if(!u)return n.fatalError("doctype external id is not well-formed at position "+a.getIndex());void 0!==u.groups.SystemLiteralOnly?c.systemId=u.groups.SystemLiteralOnly:(c.systemId=u.groups.SystemLiteral,c.publicId=u.groups.PubidLiteral),a.skip(u[0].length)}else if(o&&a.substringStartsWithCaseInsensitive(i.SYSTEM)){if(a.skip(i.SYSTEM.length),a.skipBlanks()<1)return n.fatalError("Expected whitespace after "+i.SYSTEM+" at position "+a.getIndex());if(c.systemId=a.getMatch(i.ABOUT_LEGACY_COMPAT_SystemLiteral),!c.systemId)return n.fatalError("Expected "+i.ABOUT_LEGACY_COMPAT+" in single or double quotes after "+i.SYSTEM+" at position "+a.getIndex())}return o&&c.systemId&&!i.ABOUT_LEGACY_COMPAT_SystemLiteral.test(c.systemId)&&n.warning("Unexpected doctype.systemId in HTML document at position "+a.getIndex()),o||(a.skipBlanks(),c.internalSubset=function(e,t){function r(e,t){var r=i.PI.exec(e.substringFromIndex());return r?"xml"===r[1].toLowerCase()?t.fatalError("xml declaration is only allowed at the start of the document, but found at position "+e.getIndex()):(e.skip(r[0].length),r[0]):t.fatalError("processing instruction is not well-formed at position "+e.getIndex())}var n=e.getSource();if("["===e.char()){e.skip(1);for(var o=e.getIndex();e.getIndex()<n.length;){if(e.skipBlanks(),"]"===e.char()){var a=n.substring(o,e.getIndex());return e.skip(1),a}var s=null;if("<"===e.char()&&"!"===e.char(1))switch(e.char(2)){case"E":"L"===e.char(3)?s=e.getMatch(i.elementdecl):"N"===e.char(3)&&(s=e.getMatch(i.EntityDecl));break;case"A":s=e.getMatch(i.AttlistDecl);break;case"N":s=e.getMatch(i.NotationDecl);break;case"-":s=e.getMatch(i.Comment)}else if("<"===e.char()&&"?"===e.char(1))s=r(e,t);else{if("%"!==e.char())return t.fatalError("Error detected in Markup declaration");s=e.getMatch(i.PEReference)}if(!s)return t.fatalError("Error in internal subset at position "+e.getIndex())}return t.fatalError("doctype internal subset is not well-formed, missing ]")}}(a,n)),a.skipBlanks(),">"!==a.char()?n.fatalError("doctype not terminated with > at position "+a.getIndex()):(a.skip(1),r.startDTD(c.name,c.publicId,c.systemId,c.internalSubset),r.endDTD(),a.getIndex());default:return n.fatalError('Not well-formed XML starting with "<!" at position '+t)}}function N(e,t,r,n){var o=e.substring(t).match(i.PI);if(!o)return n.fatalError("Invalid processing instruction starting at position "+t);if("xml"===o[1].toLowerCase()){if(t>0)return n.fatalError("processing instruction at position "+t+" is an xml declaration which is only at the start of the document");if(!i.XMLDecl.test(e.substring(t)))return n.fatalError("xml declaration is not well-formed")}return r.processingInstruction(o[1],o[2]),t+o[0].length}function A(){this.attributeNames=Object.create(null)}A.prototype={setTagName:function(e){if(!i.QName_exact.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,r){if(!i.QName_exact.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},t.XMLReader=f,t.parseUtils=w,t.parseDoctypeCommentOrCData=E},7338:function(e,t,r){"use strict";function n(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.startReview=function(e,t,r,n,i){return c.apply(this,arguments)};var o=i(r(5271)),a=r(6442),s=r(3067),l=r(7953);function c(){var e;return e=function*(e,t,r,n,i){try{var c;if(t){var u={SolutionName:t,Managed:!1,getMetadata:()=>({boundParameter:null,parameterTypes:{SolutionName:{typeName:"Edm.String",structuralProperty:1},Managed:{typeName:"Edm.Boolean",structuralProperty:1}},operationType:0,operationName:"ExportSolution"})};try{var p=yield r.execute(u),d=yield p.json();if(null==d||!d.ExportSolutionFile)return void console.error("No solution found or failed to export the solution.");var f=(E=d.ExportSolutionFile,N="function"==typeof atob?atob(E):Buffer.from(E,"base64").toString("binary"),Uint8Array.from(N,(e=>e.charCodeAt(0)))),h=new o.default;c=yield h.loadAsync(new File([new Blob([f.buffer],{type:"application/zip"})],t))}catch(e){return void(e instanceof Error?console.error("Error exporting the solution:",e.message,e.stack):console.error("Unknown error occurred during solution export:",e))}}else if(e){var m=new o.default;c=yield m.loadAsync(e)}if(c){var g=yield(0,a.reviewCopilotComponents)(c,n,i),y=yield(0,s.reviewPowerAppsComponents)(c,n),v=yield(0,l.reviewPowerAutomateComponents)(c,n),b=0,w=0;return g.totalBots>0&&(b+=Number(g.totalScore.replace("%","")),w++),y.totalApps>0&&(b+=Number(y.totalScore.replace("%","")),w++),v.totalFlows>0&&(b+=Number(v.totalScore.replace("%","")),w++),{Copilot:g,PowerApps:y,PowerAutomate:v,SolutionScore:w>0?Math.round(b/w).toString()+"%":"0%"}}}catch(e){e instanceof Error?console.error("An error occurred during review:",e.message,e.stack):console.error("Unknown error during review:",e)}var E,N},c=function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,l,"next",e)}function l(e){n(a,i,o,s,l,"throw",e)}s(void 0)}))},c.apply(this,arguments)}},7379:(e,t,r)=>{"use strict";e.exports=r(332).extend({implicit:[r(5809),r(2220),r(6379),r(2332)]})},7414:(e,t,r)=>{"use strict";e.exports=r(7379)},7905:(e,t,r)=>{"use strict";function n(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,l,"next",e)}function l(e){n(a,i,o,s,l,"throw",e)}s(void 0)}))}}Object.defineProperty(t,"__esModule",{value:!0}),t.patternCheckTriggerPhraseCount=function(e){return new Promise((t=>{var r=[];e.forEach((e=>{e.isEnabled&&(0,a.extractTriggerPhrases)(e.data).length<5&&r.push({TopicName:e.name})}));var n=0===r.length;t({patternID:o.BotPatternDetails.TriggerPhraseCount.patternID,patternName:o.BotPatternDetails.TriggerPhraseCount.patternName,description:o.BotPatternDetails.TriggerPhraseCount.description,status:n?"Pass":"Fail",instanceValue:[{Topic:n?void 0:r,Flows:void 0,KnowledgeSource:void 0}],failureReason:n?"":"Some topics have less than 5 trigger queries.",recommendation:o.BotPatternDetails.TriggerPhraseCount.recommendation,docLinks:o.BotPatternDetails.TriggerPhraseCount.docLink,severity:o.BotPatternDetails.TriggerPhraseCount.severity,category:o.BotPatternDetails.TriggerPhraseCount.category})}))},t.patternCheckSingleWordPhrases=function(e){return new Promise((t=>{var r=[];e.forEach((e=>{if(e.isEnabled){var t=(0,a.extractTriggerPhrases)(e.data).filter((e=>1===e.trim().split(/\s+/).length));t.length>0&&r.push({TopicName:e.name,InvalidTriggerQueries:t})}}));var n=0===r.length;t({patternID:o.BotPatternDetails.SingleWordPhrases.patternID,patternName:o.BotPatternDetails.SingleWordPhrases.patternName,description:o.BotPatternDetails.SingleWordPhrases.description,status:n?"Pass":"Fail",instanceValue:[{Topic:n?void 0:r,Flows:void 0,KnowledgeSource:void 0}],failureReason:n?"":"Some trigger queries are single words.",recommendation:o.BotPatternDetails.SingleWordPhrases.recommendation,docLinks:o.BotPatternDetails.SingleWordPhrases.docLink,severity:o.BotPatternDetails.SingleWordPhrases.severity,category:o.BotPatternDetails.SingleWordPhrases.category})}))},t.patternCheckLongPhrases=function(e){return new Promise((t=>{var r=[];e.forEach((e=>{if(e.isEnabled){var t=(0,a.extractTriggerPhrases)(e.data).filter((e=>e.trim().split(/\s+/).length>10));t.length>0&&r.push({TopicName:e.name,InvalidTriggerQueries:t})}}));var n=0===r.length;t({patternID:o.BotPatternDetails.LongPhrases.patternID,patternName:o.BotPatternDetails.LongPhrases.patternName,description:o.BotPatternDetails.LongPhrases.description,status:n?"Pass":"Fail",instanceValue:[{Topic:n?void 0:r,Flows:void 0,KnowledgeSource:void 0}],failureReason:n?"":"Some trigger queries are too long.",recommendation:o.BotPatternDetails.LongPhrases.recommendation,docLinks:o.BotPatternDetails.LongPhrases.docLink,severity:o.BotPatternDetails.LongPhrases.severity,category:o.BotPatternDetails.LongPhrases.category})}))},t.patternCheckConditionCount=function(e){return s.apply(this,arguments)},t.patternCheckFlowCount=function(e){return l.apply(this,arguments)},t.patternCheckSharePointAuthMode=function(e){return c.apply(this,arguments)},t.patternCheckUnusedTopics=function(e,t){return u.apply(this,arguments)},t.patternCheckSynonymsQuality=function(e){return p.apply(this,arguments)},t.patternCheckDuplicateRegexEntities=function(e){return d.apply(this,arguments)},t.patternCheckEndOfConversationUsage=function(e,t){return f.apply(this,arguments)};var o=r(7985),a=r(4248);function s(){return(s=i((function*(e){var t=[];e.forEach((e=>{if(e.isEnabled){var r=e.data;r&&r.beginDialog&&r.beginDialog.actions&&(0,a.countConditionsInActions)(r.beginDialog.actions)>15&&t.push({TopicName:e.name})}}));var r=0===t.length;return{patternID:o.BotPatternDetails.ConditionCount.patternID,patternName:o.BotPatternDetails.ConditionCount.patternName,description:o.BotPatternDetails.ConditionCount.description,status:r?"Pass":"Fail",instanceValue:[{Topic:r?void 0:t,Flows:void 0,KnowledgeSource:void 0}],failureReason:r?"":"Some topic(s) have more than 15 conditions.",recommendation:o.BotPatternDetails.ConditionCount.recommendation,docLinks:o.BotPatternDetails.ConditionCount.docLink,severity:o.BotPatternDetails.ConditionCount.severity,category:o.BotPatternDetails.ConditionCount.category}}))).apply(this,arguments)}function l(){return(l=i((function*(e){var t=new Set;e.forEach((e=>{if(e.isEnabled){var r=e.data;r&&r.beginDialog&&r.beginDialog.actions&&(0,a.extractUniqueFlowIds)(r.beginDialog.actions,t)}}));var r=t.size,n=r>10,i=n?Array.from(t):[];return{patternID:o.BotPatternDetails.FlowCount.patternID,patternName:o.BotPatternDetails.FlowCount.patternName,description:o.BotPatternDetails.FlowCount.description,status:n?"Fail":"Pass",instanceValue:[{Topic:void 0,Flows:i,KnowledgeSource:void 0}],failureReason:n?"More than 10 Flows found (".concat(r,")."):"",recommendation:o.BotPatternDetails.FlowCount.recommendation,docLinks:o.BotPatternDetails.FlowCount.docLink,severity:o.BotPatternDetails.FlowCount.severity,category:o.BotPatternDetails.FlowCount.category}}))).apply(this,arguments)}function c(){return(c=i((function*(e){var t=(yield(0,a.getAuthenticationMode)(e.botXml)).toString(),r=(0,a.mapAuthMode)(t),n=(e.botComponents.knowledge||[]).filter((e=>{var r;return"SharePointSearchSource"===(null===(r=e.data)||void 0===r||null===(r=r.source)||void 0===r?void 0:r.kind)&&"1"===t})),i=n.length>0;return{patternID:o.BotPatternDetails.SharePointAuthMode.patternID,patternName:o.BotPatternDetails.SharePointAuthMode.patternName,description:o.BotPatternDetails.SharePointAuthMode.description,status:i?"Fail":"Pass",instanceValue:i?[{Topic:void 0,Flows:void 0,Entity:void 0,KnowledgeSource:n.map((e=>e.name))}]:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}],failureReason:i?"Found SharePoint knowledge sources with incorrect authentication mode '".concat(r,"'."):"",recommendation:o.BotPatternDetails.SharePointAuthMode.recommendation,docLinks:o.BotPatternDetails.SharePointAuthMode.docLink,severity:o.BotPatternDetails.SharePointAuthMode.severity,category:o.BotPatternDetails.SharePointAuthMode.category}}))).apply(this,arguments)}function u(){return(u=i((function*(e,t){var r=new Set,n=e.filter((e=>e.isEnabled));for(var i of n){var s;null!==(s=i.data)&&void 0!==s&&null!==(s=s.beginDialog)&&void 0!==s&&s.actions&&(0,a.collectBeginDialogReferences)(i.data.beginDialog.actions,r)}var l=[];for(var c of n){var u;if(0===((null===(u=c.data)||void 0===u||null===(u=u.beginDialog)||void 0===u||null===(u=u.intent)||void 0===u?void 0:u.triggerQueries)||[]).length){var p=(0,a.formatTopicName)(t,c.name);r.has(p)||l.push(c.name)}}var d=l.length>0;return{patternID:o.BotPatternDetails.UnusedTopics.patternID,patternName:o.BotPatternDetails.UnusedTopics.patternName,description:o.BotPatternDetails.UnusedTopics.description,status:d?"Fail":"Pass",instanceValue:d?[{Topic:l.map((e=>({TopicName:e,InvalidTriggerQueries:void 0}))),Flows:void 0,KnowledgeSource:void 0,Entity:void 0}]:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}],failureReason:d?"Some topics do not have trigger queries and are not referenced in any other topics.":"",recommendation:o.BotPatternDetails.UnusedTopics.recommendation,docLinks:o.BotPatternDetails.UnusedTopics.docLink,severity:o.BotPatternDetails.UnusedTopics.severity,category:o.BotPatternDetails.UnusedTopics.category}}))).apply(this,arguments)}function p(){return(p=i((function*(e){if(!e||0===e.length)return{patternID:o.BotPatternDetails.SynonymsQuality.patternID,patternName:o.BotPatternDetails.SynonymsQuality.patternName,description:o.BotPatternDetails.SynonymsQuality.description,status:"Pass",instanceValue:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}],failureReason:"",recommendation:o.BotPatternDetails.SynonymsQuality.recommendation,docLinks:o.BotPatternDetails.SynonymsQuality.docLink,severity:o.BotPatternDetails.SynonymsQuality.severity,category:o.BotPatternDetails.SynonymsQuality.category};var t=[];for(var r of e){var n;if("ClosedListEntity"===(null===(n=r.data)||void 0===n?void 0:n.kind)&&Array.isArray(r.data.items)){var i=new Set;for(var a of r.data.items){var s=Array.isArray(a.synonyms)?a.synonyms:[];for(var l of s)l.trim().split(/\s+/).length>2&&i.add(l)}i.size>0&&t.push({name:r.name,longSynonyms:Array.from(i)})}}var c=0===t.length;return{patternID:o.BotPatternDetails.SynonymsQuality.patternID,patternName:o.BotPatternDetails.SynonymsQuality.patternName,description:o.BotPatternDetails.SynonymsQuality.description,status:c?"Pass":"Fail",instanceValue:c?[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}]:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:{ClosedListEntity:t.map((e=>({name:e.name,longSynonyms:e.longSynonyms})))}}],failureReason:c?"":"Some ClosedListEntity synonyms exceed 2 words.",recommendation:o.BotPatternDetails.SynonymsQuality.recommendation,docLinks:o.BotPatternDetails.SynonymsQuality.docLink,severity:o.BotPatternDetails.SynonymsQuality.severity,category:o.BotPatternDetails.SynonymsQuality.category}}))).apply(this,arguments)}function d(){return(d=i((function*(e){if(!e||0===e.length)return{patternID:o.BotPatternDetails.DuplicateRegexEntities.patternID,patternName:o.BotPatternDetails.DuplicateRegexEntities.patternName,description:o.BotPatternDetails.DuplicateRegexEntities.description,status:"Pass",instanceValue:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}],failureReason:"",recommendation:o.BotPatternDetails.DuplicateRegexEntities.recommendation,docLinks:o.BotPatternDetails.DuplicateRegexEntities.docLink,severity:o.BotPatternDetails.DuplicateRegexEntities.severity,category:o.BotPatternDetails.DuplicateRegexEntities.category};var t=new Map;for(var r of e){var n,i;if("RegexEntity"===(null===(n=r.data)||void 0===n?void 0:n.kind)&&null!==(i=r.data)&&void 0!==i&&i.pattern){var a,s=r.data.pattern;t.has(s)||t.set(s,[]),null===(a=t.get(s))||void 0===a||a.push(r.name)}}var l=[];for(var[c,u]of t.entries())u.length>1&&l.push({name:u[0],pattern:c,matchingPatternEntityList:u.slice(1)});var p=0===l.length;return{patternID:o.BotPatternDetails.DuplicateRegexEntities.patternID,patternName:o.BotPatternDetails.DuplicateRegexEntities.patternName,description:o.BotPatternDetails.DuplicateRegexEntities.description,status:p?"Pass":"Fail",instanceValue:p?[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}]:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:{RegexEntity:l}}],failureReason:p?"":"Multiple entities of kind RegexEntity use the same regex pattern.",recommendation:o.BotPatternDetails.DuplicateRegexEntities.recommendation,docLinks:o.BotPatternDetails.DuplicateRegexEntities.docLink,severity:o.BotPatternDetails.DuplicateRegexEntities.severity,category:o.BotPatternDetails.DuplicateRegexEntities.category}}))).apply(this,arguments)}function f(){return(f=i((function*(e,t){var r=e.filter((e=>e.isEnabled)),n=[];for(var i of r)(0,a.isEndOfConversationTopic)(i.data)&&n.push(i.name);if(0===n.length)return{patternID:o.BotPatternDetails.EndOfConversationReference.patternID,patternName:o.BotPatternDetails.EndOfConversationReference.patternName,description:o.BotPatternDetails.EndOfConversationReference.description,status:"Fail",instanceValue:[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}],failureReason:"No End Of Conversation topic found.",recommendation:o.BotPatternDetails.EndOfConversationReference.recommendation,docLinks:o.BotPatternDetails.EndOfConversationReference.docLink,severity:o.BotPatternDetails.EndOfConversationReference.severity,category:o.BotPatternDetails.EndOfConversationReference.category};var s=new Set;for(var l of r){var c;null!==(c=l.data)&&void 0!==c&&null!==(c=c.beginDialog)&&void 0!==c&&c.actions&&(0,a.collectBeginDialogReferences)(l.data.beginDialog.actions,s)}var u=n.map((e=>(0,a.formatTopicName)(t,e))).some((e=>s.has(e)));return{patternID:o.BotPatternDetails.EndOfConversationReference.patternID,patternName:o.BotPatternDetails.EndOfConversationReference.patternName,description:o.BotPatternDetails.EndOfConversationReference.description,status:u?"Pass":"Fail",instanceValue:u?[{Topic:void 0,Flows:void 0,KnowledgeSource:void 0,Entity:void 0}]:[{Topic:n.map((e=>({TopicName:e}))),Flows:void 0,KnowledgeSource:void 0,Entity:void 0}],failureReason:u?"":"None of the enabled topics redirect to any End Of Conversation topic.",recommendation:o.BotPatternDetails.EndOfConversationReference.recommendation,docLinks:o.BotPatternDetails.EndOfConversationReference.docLink,severity:o.BotPatternDetails.EndOfConversationReference.severity,category:o.BotPatternDetails.EndOfConversationReference.category}}))).apply(this,arguments)}},7953:(e,t,r)=>{"use strict";function n(e,t,r,n,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}Object.defineProperty(t,"__esModule",{value:!0}),t.reviewPowerAutomateComponents=function(e,t){return a.apply(this,arguments)};var i=r(1274),o=r(7985);function a(){var e;return e=function*(e,t){var r=e.folder("Workflows"),n=[],a=Object.keys(o.FlowPatternInfo).length,s=[],l=0;if(!r)return console.error("No Workflows folder found in the solution."),{items:[],totalFlows:0,totalScore:"0%"};var c=[];return r.forEach(((e,r)=>{e.endsWith(".json")&&c.push(r.async("string").then((r=>{var c,u=JSON.parse(r),p=null===(c=e.split("/").pop())||void 0===c?void 0:c.replace(".json",""),d=[],f=0,h=new Set,m=[{fn:i.patternCheckDataRetrievalParameters,name:o.FlowPatternDetails[o.FlowPatternInfo.DataRetrievalParameters].patternName},{fn:i.patternCheckScopeUsage,name:o.FlowPatternDetails[o.FlowPatternInfo.ScopeUsage].patternName},{fn:i.patternCheckNestedLoops,name:o.FlowPatternDetails[o.FlowPatternInfo.NestedLoops].patternName},{fn:i.patternCheckConcurrencySettings,name:o.FlowPatternDetails[o.FlowPatternInfo.Concurrency].patternName},{fn:i.patternCheckConsistentNaming,name:o.FlowPatternDetails[o.FlowPatternInfo.NamingConventions].patternName},{fn:i.patternCheckTriggerCondition,name:o.FlowPatternDetails[o.FlowPatternInfo.TriggerCondition].patternName},{fn:i.patternCheckPowerAppResponse,name:o.FlowPatternDetails[o.FlowPatternInfo.PowerAppResponse].patternName},{fn:i.patternCheckStaticVariables,name:o.FlowPatternDetails[o.FlowPatternInfo.StaticVariables].patternName},{fn:i.patternCheckMultipleInitializeVariable,name:o.FlowPatternDetails[o.FlowPatternInfo.MultipleInitializeVariableActions].patternName},{fn:i.patternCheckUnusedVariables,name:o.FlowPatternDetails[o.FlowPatternInfo.UnusedVariables].patternName},{fn:i.patternOptimizeActionCounts,name:o.FlowPatternDetails[o.FlowPatternInfo.ActionCount].patternName},{fn:i.patternCheckForActionNote,name:o.FlowPatternDetails[o.FlowPatternInfo.ActionNote].patternName},{fn:i.patternCheckCreateUpdateInsideLoop,name:o.FlowPatternDetails[o.FlowPatternInfo.CreateUpdateInsideLoop].patternName}],g=function(){var{fn:e,name:r}=y;try{var n=e(u);if(t&&t.length>0&&!h.has(n.patternID)){var i=t.find((e=>e.data.patternID===n.patternID));if(i){var o=i.data;n.patternName=o.patternName||n.patternName,n.description=o.description||n.description,n.docLinks=o.docLinks||n.docLinks,n.recommendation=o.recommendation||n.recommendation,n.severity=o.severity||n.severity,n.category=o.category||n.category}}d.push(n),h.add(n.patternID),"Pass"===n.status&&(f+=1),"Warning"===n.status&&(f+=.5)}catch(e){var a=e instanceof Error?e.message:String(e);s.push({pattern:r,error:a})}};for(var y of m)g();l+=f,n.push({name:p,displayName:null==p?void 0:p.split(/-[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}/)[0],result:d,score:f>0?Math.round(f/a*100)+"%":"0%"})})).catch((t=>{var r=t instanceof Error?t.message:String(t);console.error("Failed to process file ".concat(e,":"),r),s.push({file:e,error:r})})))})),console.log(s),yield Promise.all(c),{items:n,totalFlows:n.length,totalScore:n.length>0?Math.round(l/(n.length*a)*100).toString()+"%":"0%"}},a=function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,l,"next",e)}function l(e){n(a,i,o,s,l,"throw",e)}s(void 0)}))},a.apply(this,arguments)}},7985:(e,t)=>{"use strict";var r,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.topicExclusionList=t.PropertyExclusionList=t.InnerFunctions=t.OuterFunctions=t.RelevantRuleIdsForMediaFileSize=t.RelevantRuleIdsForUnusedElements=t.QueryFunctions=t.AppSettingsList=t.MEDIA_FILE_SIZE_THRESHOLD=t.PowerAppsPatternDetails=t.PowerAppsPatternInfo=t.BotPatternDetails=t.FlowPatternDetails=t.FlowPatternInfo=t.BotPatternInfo=t.customizationFileName=t.XML_MIME_TYPE=void 0,t.codeToLabel=function(e,t){switch(e){case 9:return"TaskDialog"===t?"action":"topic";case 11:return"entity";case 16:return"knowledge";case 14:return"fileAttachment";case 12:return"globalVariable";case 13:return"skill";case 15:return"customGPT";case 17:return"externalTrigger";case 18:return"copilotSettings";case 10:return"translations";default:return"UnknownComponentType"}},t.XML_MIME_TYPE="application/xml",t.customizationFileName="customizations.xml",function(e){e.TriggerPhraseCount="TriggerPhraseCount",e.SingleWordPhrases="SingleWordPhrases",e.LongPhrases="LongPhrases",e.ConditionCount="ConditionCount",e.SharePointAuthMode="SharePointAuthMode",e.FlowCount="FlowCount",e.UnusedTopics="UnusedTopics",e.SynonymsQuality="SynonymsQuality",e.DuplicateRegexEntities="DuplicateRegexEntities",e.EndOfConversationReference="EndOfConversationReference",e.EvaluateTopicDescription="EvaluateTopicDescription",e.EvaluateTopicInputOutputVariableDescription="EvaluateTopicInputOutputVariableDescription",e.EvaluateActionDescription="EvaluateActionDescription",e.EvaluateKnowledgeDescription="EvaluateKnowledgeDescription"}(r||(t.BotPatternInfo=r={})),function(e){e.UnusedVariables="UnusedVariables",e.ActionCount="ActionCount",e.NamingConventions="NamingConventions",e.NestedLoops="NestedLoops",e.Concurrency="Concurrency",e.MultipleInitializeVariableActions="MultipleInitializeVariableActions",e.StaticVariables="StaticVariables",e.PowerAppResponse="PowerAppResponse",e.ScopeUsage="ScopeUsage",e.TriggerCondition="TriggerCondition",e.DataRetrievalParameters="DataRetrievalParameters",e.ActionNote="ActionNote",e.CreateUpdateInsideLoop="CreateUpdateInsideLoop"}(n||(t.FlowPatternInfo=n={})),t.FlowPatternDetails={[n.UnusedVariables]:{patternID:"flow-UnusedVariables",patternName:"Unused Variables",description:"Check for variables that are declared but never used.",docLink:"https://go.microsoft.com/fwlink/?linkid=2290320",recommendation:"Remove any variables that are initialized but never used.",severity:"Medium",category:"Coding Standards"},[n.ActionCount]:{patternID:"flow-ActionCount",patternName:"Action Count",description:"Limit the number of actions to optimize flow performance. Checks if a flow exceeds 50 actions.",docLink:"https://learn.microsoft.com/en-us/power-automate/guidance/coding-guidelines/create-reusable-code",recommendation:"Reduce the number of actions to improve performance.",severity:"Medium",category:"Performance"},[n.NamingConventions]:{patternID:"flow-NamingConventions",patternName:"Naming Conventions",description:"Check if trigger starts with 'Trg_' and actions start with 'Act_' prefix for flow components.",docLink:"https://learn.microsoft.com/en-us/power-automate/guidance/coding-guidelines/use-consistent-naming-conventions",recommendation:"Follow consistent naming conventions (e.g., CamelCase, prefixes) for triggers, actions, and variables.",severity:"Low",category:"Maintainability"},[n.NestedLoops]:{patternID:"flow-NestedLoops",patternName:"Nested Loops",description:"Avoid using nested loops for better performance.",docLink:"https://learn.microsoft.com/en-us/power-automate/guidance/coding-guidelines/avoid-anti-patterns#avoid-nested-for-each-loops",recommendation:"Optimize flow logic to avoid nested loops.",severity:"High",category:"Performance"},[n.Concurrency]:{patternID:"flow-Concurrency",patternName:"Concurrency",description:"Verify loops and actions use parallel execution and concurrency settings.",docLink:"https://learn.microsoft.com/en-us/power-automate/guidance/coding-guidelines/implement-parallel-execution",recommendation:"Set concurrency limits and enable parallel execution for Foreach loops where appropriate.",severity:"Medium",category:"Performance"},[n.MultipleInitializeVariableActions]:{patternID:"flow-MultipleInitializeVariableActions",patternName:"Multiple Initialize Variable Actions",description:"Check if 'Initialize Variable' actions are used more than once.",docLink:"https://learn.microsoft.com/en-us/power-automate/guidance/coding-guidelines/use-data-operations#json-variables-vs-individual-variables",recommendation:"Combine multiple 'InitializeVariable' actions into a single 'InitializeVariable' action of type object or Use parallel initialization for faster execution.",severity:"Low",category:"Coding Standards"},[n.StaticVariables]:{patternID:"flow-StaticVariables",patternName:"Static Variables",description:"Identify variables that are initialized but never updated using Variable actions.",docLink:"https://learn.microsoft.com/en-us/power-automate/guidance/coding-guidelines/use-data-operations#variables-vs-compose",recommendation:"Use 'Compose' actions instead of variables that are initialized but never updated.",severity:"Low",category:"Optimization"},[n.PowerAppResponse]:{patternID:"flow-PowerAppResponse",patternName:"PowerApp Response",description:"Check if a Respond to a Power App or flow action is present in the flow.",docLink:"https://learn.microsoft.com/en-us/power-automate/guidance/coding-guidelines/asychronous-flow-pattern",recommendation:"Ensure the response is sent within 120 seconds to avoid potential failures.",severity:"Medium",category:"Reliability"},[n.ScopeUsage]:{patternID:"flow-ScopeUsage",patternName:"Scope Usage",description:"Check if the flow has a lot of actions and lacks any 'Scope' action.",docLink:"https://learn.microsoft.com/en-us/power-automate/guidance/coding-guidelines/create-scopes",recommendation:"Use Scopes to group actions and implement error handling (with Run After conditions) to handle failures gracefully.",severity:"Low",category:"Coding Standards"},[n.TriggerCondition]:{patternID:"flow-TriggerCondition",patternName:"Trigger Condition",description:"Check if flow triggers are configured to prevent infinite runs.",docLink:"https://learn.microsoft.com/en-us/power-automate/guidance/coding-guidelines/optimize-power-automate-triggers#set-trigger-conditions",recommendation:"Define trigger conditions to avoid unnecessary flow executions. This ensures that the flow only runs when specific conditions are met.",severity:"High",category:"Validation"},[n.DataRetrievalParameters]:{patternID:"flow-DataRetrievalParameters",patternName:"Data Retrieval Parameters",description:"Check if the flow uses filter, select, top count metadata in get actions of Dataverse or Sharepoint",docLink:"https://learn.microsoft.com/en-us/power-automate/guidance/coding-guidelines/work-with-relevant-data",recommendation:"Get actions need to get only relevant data to be used in flow in terms of row and column count. Use top, filter, select parameters to retrieve only required data.",severity:"Medium",category:"Optimization"},[n.ActionNote]:{patternID:"flow-ActionNote",patternName:"Action Note",description:"Ensure every action has a non-empty description.",docLink:"https://learn.microsoft.com/en-us/power-automate/guidance/coding-guidelines/use-peekcode-addnotes#add-notes",recommendation:"Add meaningful notes/descriptions to all actions for better documentation and maintainability.",severity:"Low",category:"Mantainability"},[n.CreateUpdateInsideLoop]:{patternID:"flow-CreateUpdateInsideLoop",patternName:"Create/Update Inside Loop",description:"Check if Create/Update actions are inside a loop action.",docLink:"https://learn.microsoft.com/en-us/power-automate/guidance/coding-guidelines/avoid-anti-patterns#avoid-using-for-each-loop-to-update-large-numbers-of-records",recommendation:"Avoid using Create/Update actions to create/update large number of records inside loops. Use BulkOperations APIs or batch processing for better performance.",severity:"High",category:"Performance"}},t.BotPatternDetails={[r.TriggerPhraseCount]:{patternID:"bot-TriggerPhraseCount",patternName:"Trigger Phrase Count",description:"This pattern ensures that each topic contains at least 5 trigger phrases, which helps bots respond to a wider variety of user queries.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance/trigger-phrases-best-practices#2",recommendation:"Ensure each topic has at least 5 trigger queries.",severity:"Medium",category:"Usage"},[r.SingleWordPhrases]:{patternID:"bot-SingleWordPhrases",patternName:"Single Word Phrases",description:"This pattern identifies single-word trigger phrases, recommending the use of multi-word phrases for more accurate and meaningful responses.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance/trigger-phrases-best-practices#3",recommendation:"Ensure all trigger phrases are more than one word.",severity:"Medium",category:"Usage"},[r.LongPhrases]:{patternID:"bot-LongPhrases",patternName:"Long Phrases",description:"This pattern flags trigger phrases that exceed 10 words in length, encouraging shorter and more concise queries for better bot performance.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance/trigger-phrases-best-practices#4",recommendation:"Ensure all trigger phrases have fewer than 10 words.",severity:"Low",category:"Usage"},[r.ConditionCount]:{patternID:"bot-ConditionCount",patternName:"Condition Count",description:"Checks if topics have too many condition action branches.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance",recommendation:"Consider breaking the topic into subtopics and redirect the conversation to those subtopics to improve maintainability.",severity:"Medium",category:"Maintainability"},[r.SharePointAuthMode]:{patternID:"bot-SharePointAuthMode",patternName:"SharePoint Auth Mode",description:"Checks if Agent has any SharePoint knowledge sources and is using 'No Authentication' as authentication mode.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance",recommendation:"Ensure an Agent with SharePoint sources use 'Authenticate Manually' or 'Authenticate with Microsoft' for authentication mode.",severity:"Medium",category:"Security"},[r.FlowCount]:{patternID:"bot-FlowCount",patternName:"Flow Count",description:"Checks the number of unique flowIds used in InvokeFlowAction and fails if more than 10 are found.",docLink:"https://learn.microsoft.com/en-us/power-platform",recommendation:"Reduce the usage of flows(no more than 10 flows) to optimize performance and maintainability.",severity:"Medium",category:"Data"},[r.UnusedTopics]:{patternID:"bot-UnusedTopics",patternName:"Unused Topics",description:"Checks for topics that do not have trigger phrases and are not referenced in any other topics.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance",recommendation:"Consider removing unused topics to keep the bot optimized.",severity:"Medium",category:"Usage"},[r.SynonymsQuality]:{patternID:"bot-SynonymsQuality",patternName:"Synonyms Quality",description:"Checks synonyms in ClosedListEntity items to ensure no synonym exceeds 2 words.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance",recommendation:"Synonyms should only be keywords (no more than 2 words).",severity:"Medium",category:"Usage"},[r.DuplicateRegexEntities]:{patternID:"bot-DuplicateRegexEntities",patternName:"Duplicate Regex Entities",description:"Checks if multiple RegexEntity entities share the exact same pattern.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance",recommendation:"Use unique regex patterns to avoid confusion or conflicts.",severity:"Medium",category:"Usage"},[r.EndOfConversationReference]:{patternID:"bot-EndOfConversationReference",patternName:"End Of Conversation Usage",description:"Checks if there is at least one End Of Conversation topic (with CancelOtherTopics and a Resolved outcome), and at least one topic referencing it.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/guidance",recommendation:"Ensure you have an EndOfConversation topic with 'startBehavior: CancelOtherTopics'  and conversationOutcome: ResolvedImplied Or conversationOutcome: ResolvedConfirmed and it is referenced by at least one topic to properly end the conversation. Without this, no analytics is collected(no CSAT).",severity:"High",category:"Usage"},[r.EvaluateTopicDescription]:{patternID:"bot-ai-EvaluateTopicDescription",patternName:"Meaningful Topic Description ",description:"Checks the quality of a topic's modelDescription via AI.",recommendation:"Please add a meaningful description to the topic.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/advanced-generative-actions#selecting-the-right-topics-actions-and-knowledge-sources",severity:"Medium",category:"Usage"},[r.EvaluateTopicInputOutputVariableDescription]:{patternID:"bot-ai-EvaluateTopicInputOutputVariableDescription",patternName:"Meaningful Topic Input/Output Variable Description ",description:"Checks the quality of a topic's input/output variables' description via AI.",recommendation:"Please add a meaningful description to the input/output variables of the topic.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/advanced-managing-topic-inputs-outputs",severity:"Medium",category:"Usage"},[r.EvaluateKnowledgeDescription]:{patternID:"bot-ai-EvaluateKnowledgeDescription",patternName:"Meaningful Knowledge Description ",description:"Checks the quality of a knowledge's description via AI.",recommendation:"Please add a meaningful description to the knowledge.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/knowledge-copilot-studio#generative-orchestration",severity:"Medium",category:"Usage"},[r.EvaluateActionDescription]:{patternID:"bot-ai-EvaluateActionDescription",patternName:"Meaningful Action Description ",description:"Checks the quality of an action's modelDescription via AI.",recommendation:"Please add a meaningful description to the action.",docLink:"https://learn.microsoft.com/en-us/microsoft-copilot-studio/advanced-generative-actions#authoring-descriptions",severity:"Medium",category:"Usage"}},function(e){e.MediaFileSize="MediaFileSize",e.AppSettings="AppSettings",e.AppCheckerAccessibilityIssues="AppCheckerAccessibilityIssues",e.UnusedElements="UnusedElements",e.NPlusOne="NPlusOne",e.ErrorHandling="ErrorHandling",e.CodeReadability="CodeReadability",e.InefficientDataRetrieval="InefficientDataRetrieval",e.NestedFilters="NestedFilters",e.PatchFormulaOptimization="PatchFormulaOptimization",e.NestedAPICalls="NestedAPICalls",e.NamedFormulas="NamedFormulas",e.UxLayout="UxLayout",e.UnusedMediaResources="UnusedMediaResources",e.InefficientDelayLoading="InefficientDelayLoading"}(i||(t.PowerAppsPatternInfo=i={})),t.PowerAppsPatternDetails={[i.MediaFileSize]:{patternID:"app-AssetOptimization",patternName:"Asset Optimization",description:"Review embedded asset compression/size optimization. Validate apps respect limitations related to media and audio asset sizes.",docLinks:"",recommendation:"Ensure that all files do not exceed 300KB file size. Please consider compressing the files using optimized file formats (e.g., SVG for icons, WebP for images), and limiting media file sizes.",severity:"Medium",category:"Performance"},[i.AppSettings]:{patternID:"app-AppSettings",patternName:"App Settings flags",description:"Ensure that all necessary settings are enabled for optimal performance.",docLinks:"https://www.microsoft.com/en-us/power-platform/blog/power-apps/app-checker-now-includes-performance-optimization-tips/",recommendation:"Please consider turning on the listed settings.",severity:"Medium",category:"Performance"},[i.AppCheckerAccessibilityIssues]:{patternID:"app-Accessibility",patternName:"Accessibility",description:"Review accessibility checker. Notes: Alternate Text labels can reveal otherwise hidden media and context to users with disabilities. Use natural language text when naming screens to optimize results from screen readers.",docLinks:"https://docs.microsoft.com/power-apps/maker/canvas-apps/accessible-apps",recommendation:"Please address the listed accessibility issues in failure reason.",severity:"High",category:"Accessibility"},[i.UnusedElements]:{patternID:"app-UnusedVariables",patternName:"Formulas, Controls with Low/No Usage",description:"This pattern refers to any formulas, assets, or controls that might be included in the app, but are potentially unnecessary, redundant, or not used.",docLinks:"https://docs.microsoft.com/powerapps/maker/canvas-apps/performance-tips",recommendation:"Remove or reference the unused variables to optimize performance.",severity:"Medium",category:"Performance"},[i.NPlusOne]:{patternID:"app-CheckForNplusOneCalls",patternName:"N+1 Database or API requests",description:"N+1 query, which are used often in galleries, can trigger too many requests to servers. Optimize data retrieval to reduce the number of requests.",docLinks:"https://powerapps.microsoft.com/blog/considerations-for-optimized-performance-in-power-apps",recommendation:"Consider optimizing data retrieval to reduce the number of requests.",severity:"High",category:"Performance"},[i.ErrorHandling]:{patternID:"app-ErrorHandling",patternName:"Error Handling",description:"Always ensure apps have appropriate error handling methods. It is best to use the IfError() function to manage data validation for Patch() commands and the OnSuccess/OnFail properties when submitting form data.",docLinks:"https://docs.microsoft.com/powerapps/maker/canvas-apps/functions/function-iferror",recommendation:"Implement error handling using IfError() or similar mechanisms.",severity:"Low",category:"Coding Standards"},[i.CodeReadability]:{patternID:"app-CodeReadability",patternName:"Code Readability",description:"Avoid expressions or formulas that are very long as they will become hard to read. Examples include, but are not limited to nested If/Then/Else statements and nested operators such as OR or AND.",docLinks:"",recommendation:"Simplify code to improve readability.",severity:"Low",category:"Maintainability"},[i.InefficientDataRetrieval]:{patternID:"app-FormulaOptimization-FirstFilter",patternName:"Inefficient Data Retrieval",description:"Using Filter or Search inside First or Last functions with external data sources.",docLinks:"https://docs.microsoft.com/powerapps/maker/canvas-apps/performance-tips",recommendation:"Optimize data retrieval by avoiding inefficient use of functions.",severity:"High",category:"Performance"},[i.NestedFilters]:{patternID:"app-FormulaOptimization-NestedFilter",patternName:"Nested Filters",description:"Consider simplifying nested formulas with Search() and Filter() operations. Avoiding the nesting of these two together leads to a more compact/concise formula and performance improvement.",docLinks:"",recommendation:"Simplify nested filters to improve performance.",severity:"Medium",category:"Performance"},[i.PatchFormulaOptimization]:{patternID:"app-FormulaOptimization-Patch",patternName:"Patch Formula Optimization",description:"Ensure the second parameter is not using a LookUp() function. It is a best practice to use ThisItem whenever patching from a gallery or { id: userid }.",docLinks:"",recommendation:"Optimize Patch formulas by avoiding unnecessary LookUp() functions.",severity:"Low",category:"Performance"},[i.NestedAPICalls]:{patternID:"app-FormulaOptimization-NestedApiCalls",patternName:"Nested API Calls",description:"Avoid making API calls within Filter() and LookUp() operations in combination.",docLinks:"",recommendation:"Avoid nesting API calls to improve performance.",severity:"Medium",category:"Performance"},[i.NamedFormulas]:{patternID:"app-NamedFormulas",patternName:"Named Formulas",description:"Use Named Formulas to improve performance and maintainability by defining formulas that can be reused throughout the app.",docLinks:"https://learn.microsoft.com/en-us/power-platform/power-fx/formula-reuse-named-formulas",recommendation:"Utilize Named Formulas for better code reuse and maintainability.",severity:"Low",category:"Maintainability"},[i.UxLayout]:{patternID:"app-UxLayout",patternName:"UX Layout",description:"Use containers to make responsive apps.",docLinks:"https://learn.microsoft.com/en-us/powerapps/maker/canvas-apps/create-responsive-layout",recommendation:"Implement responsive design using containers.",severity:"Low",category:"UX"},[i.UnusedMediaResources]:{patternID:"app-UnusedMediaResources",patternName:"Unused Media Resources",description:"Checks if the app has any media resources which are not referenced/used in the app.",docLinks:"",recommendation:"Remove or reference the unused media files to optimize performance.",severity:"Medium",category:"Performance"},[i.InefficientDelayLoading]:{patternID:"app-InefficientDelayLoading",patternName:"Inefficient Delay Loading",description:"Checks if there are any delay loading issues flagged by the App Checker (ruleId: app-InefficientDelayLoading). ",docLinks:"",recommendation:"Referencing controls from other screens can impact app performance by slowing down loading and navigation. Use variables, collections, and navigation context to share state across screens.",severity:"Medium",category:"Performance"}},t.MEDIA_FILE_SIZE_THRESHOLD=307200,t.AppSettingsList=["sharepointselectsenabled","enableupdateifdelegation","mobilenativerendering","keeprecentscreensloaded"],t.QueryFunctions=["Filter","LookUp","Search","CountRows","ForAll","Patch"],t.RelevantRuleIdsForUnusedElements=["app-UnusedVariables"],t.RelevantRuleIdsForMediaFileSize=["app-UnusedMediaResources"],t.OuterFunctions=["First","Last"],t.InnerFunctions=["Filter","Search"],t.PropertyExclusionList=["X","Y","PaddingBottom","PaddingTop","PaddingLeft","PaddingRight","Height","Width","HoverBorderColor","BorderColor","FocusedBorderColor","PressedFill","HoverFill","PressedBorderColor","PressedColor","Size","DisabledBorderColor","LoadingSpinnerColor","DisabledFill","Align","Padding","Margin","LineHeight","TextAlign","VerticalAlign","BorderStyle","BorderRadius","BorderThickness","FontSize","FontWeight","FontStyle","FontFamily","LineHeight"],t.topicExclusionList=["ConversationStart","EndofConversation","MultipleTopicsMatched","OnError","ResetConversation","Search","Signin","Escalate","Fallback","Goodbye","Greeting","ThankYou","StartOver"]},8124:(e,t)=>{!function(e){"use strict";var t="__namespace",r=function(e){return e&&((r=e.nodeType)===t||Number.isInteger(r)&&r>=1&&r<=11)&&"string"==typeof e.nodeName;var r},n=function(e,t){for(var r=0;r<t.length;r+=1)e(t[r],r,t)},i=function(e,t,r){var i=t;return n((function(t,r){i=e(i,t,r)}),r),i},o=function(e,t){var r=new Array(t.length);return n((function(t,n){r[n]=e(t)}),t),r},a=function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return!0;return!1};function s(e){return e.toString()}var l=function(e,t){return t.join(e)},c=function(e,t,r){return e+r+t},u=Array.prototype.concat;function p(e,t){for(var r=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])}return r}var d=t;function f(){this.init()}function h(e){this.expression=e}function m(e,t,r){t in e||(e[t]=r)}function g(){}function y(e){arguments.length>0&&this.init(e)}function v(e){arguments.length>0&&this.init(e)}function b(e,t){arguments.length>0&&this.init(e,t)}function w(e,t){arguments.length>0&&this.init(e,t)}function E(e,t){arguments.length>0&&this.init(e,t)}function N(e,t){arguments.length>0&&this.init(e,t)}function A(e,t){arguments.length>0&&this.init(e,t)}function S(e,t){arguments.length>0&&this.init(e,t)}function C(e,t){arguments.length>0&&this.init(e,t)}function _(e,t){arguments.length>0&&this.init(e,t)}function T(e,t){arguments.length>0&&this.init(e,t)}function D(e,t){arguments.length>0&&this.init(e,t)}function I(e,t){arguments.length>0&&this.init(e,t)}function x(e,t){arguments.length>0&&this.init(e,t)}function P(e,t){arguments.length>0&&this.init(e,t)}function k(e,t){arguments.length>0&&this.init(e,t)}function O(e,t){arguments.length>0&&this.init(e,t)}function R(e,t,r){arguments.length>0&&this.init(e,t,r)}function L(e){for(;e&&e.parentNode;)e=e.parentNode;return e}f.prototype=new Object,f.prototype.constructor=f,f.superclass=Object.prototype,f.prototype.init=function(){this.reduceActions=[],this.reduceActions[3]=function(e){return new w(e[0],e[2])},this.reduceActions[5]=function(e){return new E(e[0],e[2])},this.reduceActions[7]=function(e){return new N(e[0],e[2])},this.reduceActions[8]=function(e){return new A(e[0],e[2])},this.reduceActions[10]=function(e){return new S(e[0],e[2])},this.reduceActions[11]=function(e){return new C(e[0],e[2])},this.reduceActions[12]=function(e){return new _(e[0],e[2])},this.reduceActions[13]=function(e){return new T(e[0],e[2])},this.reduceActions[15]=function(e){return new D(e[0],e[2])},this.reduceActions[16]=function(e){return new I(e[0],e[2])},this.reduceActions[18]=function(e){return new x(e[0],e[2])},this.reduceActions[19]=function(e){return new P(e[0],e[2])},this.reduceActions[20]=function(e){return new k(e[0],e[2])},this.reduceActions[22]=function(e){return new v(e[1])},this.reduceActions[24]=function(e){return new O(e[0],e[2])},this.reduceActions[25]=function(e){return new R(void 0,void 0,e[0])},this.reduceActions[27]=function(e){return e[0].locationPath=e[2],e[0]},this.reduceActions[28]=function(e){return e[0].locationPath=e[2],e[0].locationPath.steps.unshift(new j(j.DESCENDANTORSELF,V.nodeTest,[])),e[0]},this.reduceActions[29]=function(e){return new R(e[0],[],void 0)},this.reduceActions[30]=function(e){return ne.instance_of(e[0],R)?(null==e[0].filterPredicates&&(e[0].filterPredicates=[]),e[0].filterPredicates.push(e[1]),e[0]):new R(e[0],[e[1]],void 0)},this.reduceActions[32]=function(e){return e[1]},this.reduceActions[33]=function(e){return new G(e[0])},this.reduceActions[34]=function(e){return new Y(e[0])},this.reduceActions[36]=function(e){return new H(e[0],[])},this.reduceActions[37]=function(e){return new H(e[0],e[2])},this.reduceActions[38]=function(e){return[e[0]]},this.reduceActions[39]=function(e){return e[2].unshift(e[0]),e[2]},this.reduceActions[43]=function(e){return new B(!0,[])},this.reduceActions[44]=function(e){return e[1].absolute=!0,e[1]},this.reduceActions[46]=function(e){return new B(!1,[e[0]])},this.reduceActions[47]=function(e){return e[0].steps.push(e[2]),e[0]},this.reduceActions[49]=function(e){return new j(e[0],e[1],[])},this.reduceActions[50]=function(e){return new j(j.CHILD,e[0],[])},this.reduceActions[51]=function(e){return new j(e[0],e[1],e[2])},this.reduceActions[52]=function(e){return new j(j.CHILD,e[0],e[1])},this.reduceActions[54]=function(e){return[e[0]]},this.reduceActions[55]=function(e){return e[1].unshift(e[0]),e[1]},this.reduceActions[56]=function(e){return"ancestor"==e[0]?j.ANCESTOR:"ancestor-or-self"==e[0]?j.ANCESTORORSELF:"attribute"==e[0]?j.ATTRIBUTE:"child"==e[0]?j.CHILD:"descendant"==e[0]?j.DESCENDANT:"descendant-or-self"==e[0]?j.DESCENDANTORSELF:"following"==e[0]?j.FOLLOWING:"following-sibling"==e[0]?j.FOLLOWINGSIBLING:"namespace"==e[0]?j.NAMESPACE:"parent"==e[0]?j.PARENT:"preceding"==e[0]?j.PRECEDING:"preceding-sibling"==e[0]?j.PRECEDINGSIBLING:"self"==e[0]?j.SELF:-1},this.reduceActions[57]=function(e){return j.ATTRIBUTE},this.reduceActions[59]=function(e){return"comment"==e[0]?V.commentTest:"text"==e[0]?V.textTest:"processing-instruction"==e[0]?V.anyPiTest:"node"==e[0]?V.nodeTest:new V(-1,void 0)},this.reduceActions[60]=function(e){return new V.PITest(e[2])},this.reduceActions[61]=function(e){return e[1]},this.reduceActions[63]=function(e){return e[1].absolute=!0,e[1].steps.unshift(new j(j.DESCENDANTORSELF,V.nodeTest,[])),e[1]},this.reduceActions[64]=function(e){return e[0].steps.push(new j(j.DESCENDANTORSELF,V.nodeTest,[])),e[0].steps.push(e[2]),e[0]},this.reduceActions[65]=function(e){return new j(j.SELF,V.nodeTest,[])},this.reduceActions[66]=function(e){return new j(j.PARENT,V.nodeTest,[])},this.reduceActions[67]=function(e){return new q(e[1])},this.reduceActions[68]=function(e){return V.nameTestAny},this.reduceActions[69]=function(e){return new V.NameTestPrefixAny(e[0].split(":")[0])},this.reduceActions[70]=function(e){return new V.NameTestQName(e[0])}},f.actionTable=[" s s        sssssssss    s ss  s  ss","                 s                  ","r  rrrrrrrrr         rrrrrrr rr  r  ","                rrrrr               "," s s        sssssssss    s ss  s  ss","rs  rrrrrrrr s  sssssrrrrrr  rrs rs "," s s        sssssssss    s ss  s  ss","                            s       ","                            s       ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","  s                                 ","                            s       "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr  r  ","a                                   ","r       s                    rr  r  ","r      sr                    rr  r  ","r   s  rr            s       rr  r  ","r   rssrr            rss     rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrrs  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r  srrrrrrrr         rrrrrrs rr sr  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r   rrrrrrrr         rrrrrr  rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","                sssss               ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             s      ","r  srrrrrrrr         rrrrrrs rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","              s                     ","                             s      ","                rrrrr               "," s s        sssssssss    s sss s  ss","r  srrrrrrrr         rrrrrrs rr  r  "," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss    s ss  s  ss"," s s        sssssssss      ss  s  ss"," s s        sssssssss    s ss  s  ss"," s           s  sssss          s  s "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr rr  "," s           s  sssss          s  s "," s           s  sssss          s  s ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr sr  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             s      ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  ","                             rr     ","                             s      ","                             rs     ","r      sr                    rr  r  ","r   s  rr            s       rr  r  ","r   rssrr            rss     rr  r  ","r   rssrr            rss     rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrr            rrrss   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrsss         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrr   rr  r  ","r   rrrrrrrr         rrrrrr  rr  r  ","                                 r  ","                                 s  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  srrrrrrrr         rrrrrrs rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr  r  ","r  rrrrrrrrr         rrrrrrr rr rr  ","r  rrrrrrrrr         rrrrrrr rr rr  "," s s        sssssssss    s ss  s  ss","r  rrrrrrrrr         rrrrrrr rr rr  ","                             r      "],f.actionTableNumber=[" 1 0        /.-,+*)('    & %$  #  \"!","                 J                  ","a  aaaaaaaaa         aaaaaaa aa  a  ","                YYYYY               "," 1 0        /.-,+*)('    & %$  #  \"!","K1  KKKKKKKK .  +*)('KKKKKK  KK# K\" "," 1 0        /.-,+*)('    & %$  #  \"!","                            N       ","                            O       ","e  eeeeeeeee         eeeeeee ee ee  ","f  fffffffff         fffffff ff ff  ","d  ddddddddd         ddddddd dd dd  ","B  BBBBBBBBB         BBBBBBB BB BB  ","A  AAAAAAAAA         AAAAAAA AA AA  ","  P                                 ","                            Q       "," 1           .  +*)('          #  \" ","b  bbbbbbbbb         bbbbbbb bb  b  ","                                    ","!       S                    !!  !  ",'"      T"                    ""  "  ',"$   V  $$            U       $$  $  ","&   &ZY&&            &XW     &&  &  ",")   )))))            )))\\[   ))  )  ",".   ....._^]         .....   ..  .  ","1   11111111         11111   11  1  ","5   55555555         55555`  55  5  ","7   77777777         777777  77  7  ","9   99999999         999999  99  9  ",":  c::::::::         ::::::b :: a:  ","I  fIIIIIIII         IIIIIIe II  I  ","=  =========         ======= == ==  ","?  ?????????         ??????? ?? ??  ","C  CCCCCCCCC         CCCCCCC CC CC  ","J   JJJJJJJJ         JJJJJJ  JJ  J  ","M   MMMMMMMM         MMMMMM  MM  M  ","N  NNNNNNNNN         NNNNNNN NN  N  ","P  PPPPPPPPP         PPPPPPP PP  P  ","                +*)('               ","R  RRRRRRRRR         RRRRRRR RR aR  ","U  UUUUUUUUU         UUUUUUU UU  U  ","Z  ZZZZZZZZZ         ZZZZZZZ ZZ ZZ  ","c  ccccccccc         ccccccc cc cc  ","                             j      ","L  fLLLLLLLL         LLLLLLe LL  L  ","6   66666666         66666   66  6  ","              k                     ","                             l      ","                XXXXX               "," 1 0        /.-,+*)('    & %$m #  \"!","_  f________         ______e __  _  "," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1 0        /.-,+*)('      %$  #  \"!"," 1 0        /.-,+*)('    & %$  #  \"!"," 1           .  +*)('          #  \" "," 1           .  +*)('          #  \" ",">  >>>>>>>>>         >>>>>>> >> >>  "," 1           .  +*)('          #  \" "," 1           .  +*)('          #  \" ","Q  QQQQQQQQQ         QQQQQQQ QQ aQ  ","V  VVVVVVVVV         VVVVVVV VV aV  ","T  TTTTTTTTT         TTTTTTT TT  T  ","@  @@@@@@@@@         @@@@@@@ @@ @@  ","                                   ","[  [[[[[[[[[         [[[[[[[ [[ [[  ","D  DDDDDDDDD         DDDDDDD DD DD  ","                             HH     ","                                   ","                             F     ","#      T#                    ##  #  ","%   V  %%            U       %%  %  ","'   'ZY''            'XW     ''  '  ","(   (ZY((            (XW     ((  (  ","+   +++++            +++\\[   ++  +  ","*   *****            ***\\[   **  *  ","-   -----            ---\\[   --  -  ",",   ,,,,,            ,,,\\[   ,,  ,  ","0   00000_^]         00000   00  0  ","/   /////_^]         /////   //  /  ","2   22222222         22222   22  2  ","3   33333333         33333   33  3  ","4   44444444         44444   44  4  ","8   88888888         888888  88  8  ","                                 ^  ","                                   ",";  f;;;;;;;;         ;;;;;;e ;;  ;  ","<  f<<<<<<<<         <<<<<<e <<  <  ","O  OOOOOOOOO         OOOOOOO OO  O  ","`  `````````         ``````` ``  `  ","S  SSSSSSSSS         SSSSSSS SS  S  ","W  WWWWWWWWW         WWWWWWW WW  W  ","\\  \\\\\\\\\\\\\\\\\\         \\\\\\\\\\\\\\ \\\\ \\\\  ","E  EEEEEEEEE         EEEEEEE EE EE  "," 1 0        /.-,+*)('    & %$  #  \"!","]  ]]]]]]]]]         ]]]]]]] ]] ]]  ","                             G      "],f.gotoTable=["3456789:;<=>?@ AB  CDEFGH IJ ","                             ","                             ","                             ","L456789:;<=>?@ AB  CDEFGH IJ ","            M        EFGH IJ ","       N;<=>?@ AB  CDEFGH IJ ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","            S        EFGH IJ ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","              e              ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                        h  J ","              i          j   ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","o456789:;<=>?@ ABpqCDEFGH IJ ","                             ","  r6789:;<=>?@ AB  CDEFGH IJ ","   s789:;<=>?@ AB  CDEFGH IJ ","    t89:;<=>?@ AB  CDEFGH IJ ","    u89:;<=>?@ AB  CDEFGH IJ ","     v9:;<=>?@ AB  CDEFGH IJ ","     w9:;<=>?@ AB  CDEFGH IJ ","     x9:;<=>?@ AB  CDEFGH IJ ","     y9:;<=>?@ AB  CDEFGH IJ ","      z:;<=>?@ AB  CDEFGH IJ ","      {:;<=>?@ AB  CDEFGH IJ ","       |;<=>?@ AB  CDEFGH IJ ","       };<=>?@ AB  CDEFGH IJ ","       ~;<=>?@ AB  CDEFGH IJ ","         =>?@ AB  CDEFGH IJ ","456789:;<=>?@ AB  CDEFGH IJ","                    EFGH IJ ","                    EFGH IJ ","                             ","                      GH IJ ","                      GH IJ ","              i             ","              i             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","                             ","o456789:;<=>?@ ABqCDEFGH IJ ","                             ","                             "],f.productions=[[1,1,2],[2,1,3],[3,1,4],[3,3,3,-9,4],[4,1,5],[4,3,4,-8,5],[5,1,6],[5,3,5,-22,6],[5,3,5,-5,6],[6,1,7],[6,3,6,-23,7],[6,3,6,-24,7],[6,3,6,-6,7],[6,3,6,-7,7],[7,1,8],[7,3,7,-25,8],[7,3,7,-26,8],[8,1,9],[8,3,8,-12,9],[8,3,8,-11,9],[8,3,8,-10,9],[9,1,10],[9,2,-26,9],[10,1,11],[10,3,10,-27,11],[11,1,12],[11,1,13],[11,3,13,-28,14],[11,3,13,-4,14],[13,1,15],[13,2,13,16],[15,1,17],[15,3,-29,2,-30],[15,1,-15],[15,1,-16],[15,1,18],[18,3,-13,-29,-30],[18,4,-13,-29,19,-30],[19,1,20],[19,3,20,-31,19],[20,1,2],[12,1,14],[12,1,21],[21,1,-28],[21,2,-28,14],[21,1,22],[14,1,23],[14,3,14,-28,23],[14,1,24],[23,2,25,26],[23,1,26],[23,3,25,26,27],[23,2,26,27],[23,1,28],[27,1,16],[27,2,16,27],[25,2,-14,-3],[25,1,-32],[26,1,29],[26,3,-20,-29,-30],[26,4,-21,-29,-15,-30],[16,3,-33,30,-34],[30,1,2],[22,2,-4,14],[24,3,14,-4,23],[28,1,-35],[28,1,-2],[17,2,-36,-18],[29,1,-17],[29,1,-19],[29,1,-18]],f.DOUBLEDOT=2,f.DOUBLECOLON=3,f.DOUBLESLASH=4,f.NOTEQUAL=5,f.LESSTHANOREQUAL=6,f.GREATERTHANOREQUAL=7,f.AND=8,f.OR=9,f.MOD=10,f.DIV=11,f.MULTIPLYOPERATOR=12,f.FUNCTIONNAME=13,f.AXISNAME=14,f.LITERAL=15,f.NUMBER=16,f.ASTERISKNAMETEST=17,f.QNAME=18,f.NCNAMECOLONASTERISK=19,f.NODETYPE=20,f.PROCESSINGINSTRUCTIONWITHLITERAL=21,f.EQUALS=22,f.LESSTHAN=23,f.GREATERTHAN=24,f.PLUS=25,f.MINUS=26,f.BAR=27,f.SLASH=28,f.LEFTPARENTHESIS=29,f.RIGHTPARENTHESIS=30,f.COMMA=31,f.AT=32,f.LEFTBRACKET=33,f.RIGHTBRACKET=34,f.DOT=35,f.DOLLAR=36,f.prototype.tokenize=function(e){for(var t=[],r=[],n=e+"\0",i=0,o=n.charAt(i++);;){for(;" "==o||"\t"==o||"\r"==o||"\n"==o;)o=n.charAt(i++);if("\0"==o||i>=n.length)break;if("("!=o)if(")"!=o)if("["!=o)if("]"!=o)if("@"!=o)if(","!=o)if("|"!=o)if("+"!=o)if("-"!=o)if("="!=o)if("$"!=o)if("."!=o)if("'"!=o&&'"'!=o)if(o>="0"&&o<="9"){for(u=o,o=n.charAt(i++);o>="0"&&o<="9";)u+=o,o=n.charAt(i++);if("."==o&&n.charAt(i)>="0"&&n.charAt(i)<="9")for(u+=o,u+=n.charAt(i++),o=n.charAt(i++);o>="0"&&o<="9";)u+=o,o=n.charAt(i++);t.push(f.NUMBER),r.push(u)}else if("*"!=o)if(":"!=o||":"!=n.charAt(i))if("/"!=o)if("!"!=o||"="!=n.charAt(i))if("<"!=o)if(">"!=o){if("_"!=o&&!ne.isLetter(o.charCodeAt(0)))throw new Error("Unexpected character "+o);var a=o;for(o=n.charAt(i++);ne.isNCNameChar(o.charCodeAt(0));)a+=o,o=n.charAt(i++);if(t.length>0&&(s=t[t.length-1])!=f.AT&&s!=f.DOUBLECOLON&&s!=f.LEFTPARENTHESIS&&s!=f.LEFTBRACKET&&s!=f.AND&&s!=f.OR&&s!=f.MOD&&s!=f.DIV&&s!=f.MULTIPLYOPERATOR&&s!=f.SLASH&&s!=f.DOUBLESLASH&&s!=f.BAR&&s!=f.PLUS&&s!=f.MINUS&&s!=f.EQUALS&&s!=f.NOTEQUAL&&s!=f.LESSTHAN&&s!=f.LESSTHANOREQUAL&&s!=f.GREATERTHAN&&s!=f.GREATERTHANOREQUAL){if("and"==a){t.push(f.AND),r.push(a);continue}if("or"==a){t.push(f.OR),r.push(a);continue}if("mod"==a){t.push(f.MOD),r.push(a);continue}if("div"==a){t.push(f.DIV),r.push(a);continue}}if(":"==o){if("*"==n.charAt(i)){t.push(f.NCNAMECOLONASTERISK),r.push(a+":*"),i++,o=n.charAt(i++);continue}if("_"==n.charAt(i)||ne.isLetter(n.charCodeAt(i))){for(a+=":",o=n.charAt(i++);ne.isNCNameChar(o.charCodeAt(0));)a+=o,o=n.charAt(i++);if("("==o){t.push(f.FUNCTIONNAME),r.push(a);continue}t.push(f.QNAME),r.push(a);continue}if(":"==n.charAt(i)){t.push(f.AXISNAME),r.push(a);continue}}if("("==o){if("comment"==a||"text"==a||"node"==a){t.push(f.NODETYPE),r.push(a);continue}if("processing-instruction"==a){")"==n.charAt(i)?t.push(f.NODETYPE):t.push(f.PROCESSINGINSTRUCTIONWITHLITERAL),r.push(a);continue}t.push(f.FUNCTIONNAME),r.push(a);continue}t.push(f.QNAME),r.push(a)}else{if("="==n.charAt(i)){t.push(f.GREATERTHANOREQUAL),r.push(">="),i++,o=n.charAt(i++);continue}t.push(f.GREATERTHAN),r.push(">"),o=n.charAt(i++)}else{if("="==n.charAt(i)){t.push(f.LESSTHANOREQUAL),r.push("<="),i++,o=n.charAt(i++);continue}t.push(f.LESSTHAN),r.push("<"),o=n.charAt(i++)}else t.push(f.NOTEQUAL),r.push("!="),i++,o=n.charAt(i++);else{if("/"==(o=n.charAt(i++))){t.push(f.DOUBLESLASH),r.push("//"),o=n.charAt(i++);continue}t.push(f.SLASH),r.push("/")}else t.push(f.DOUBLECOLON),r.push("::"),i++,o=n.charAt(i++);else{var s;if(t.length>0&&(s=t[t.length-1])!=f.AT&&s!=f.DOUBLECOLON&&s!=f.LEFTPARENTHESIS&&s!=f.LEFTBRACKET&&s!=f.AND&&s!=f.OR&&s!=f.MOD&&s!=f.DIV&&s!=f.MULTIPLYOPERATOR&&s!=f.SLASH&&s!=f.DOUBLESLASH&&s!=f.BAR&&s!=f.PLUS&&s!=f.MINUS&&s!=f.EQUALS&&s!=f.NOTEQUAL&&s!=f.LESSTHAN&&s!=f.LESSTHANOREQUAL&&s!=f.GREATERTHAN&&s!=f.GREATERTHANOREQUAL){t.push(f.MULTIPLYOPERATOR),r.push(o),o=n.charAt(i++);continue}t.push(f.ASTERISKNAMETEST),r.push(o),o=n.charAt(i++)}else{for(var l=o,c="";i<n.length&&(o=n.charAt(i))!==l;)c+=o,i+=1;if(o!==l)throw oe.fromMessage("Unterminated string literal: "+l+c);i+=1,t.push(f.LITERAL),r.push(c),o=n.charAt(i++)}else{if("."==(o=n.charAt(i++))){t.push(f.DOUBLEDOT),r.push(".."),o=n.charAt(i++);continue}if(o>="0"&&o<="9"){var u="."+o;for(o=n.charAt(i++);o>="0"&&o<="9";)u+=o,o=n.charAt(i++);t.push(f.NUMBER),r.push(u);continue}t.push(f.DOT),r.push(".")}else t.push(f.DOLLAR),r.push(o),o=n.charAt(i++);else t.push(f.EQUALS),r.push(o),o=n.charAt(i++);else t.push(f.MINUS),r.push(o),o=n.charAt(i++);else t.push(f.PLUS),r.push(o),o=n.charAt(i++);else t.push(f.BAR),r.push(o),o=n.charAt(i++);else t.push(f.COMMA),r.push(o),o=n.charAt(i++);else t.push(f.AT),r.push(o),o=n.charAt(i++);else t.push(f.RIGHTBRACKET),r.push(o),o=n.charAt(i++);else t.push(f.LEFTBRACKET),r.push(o),o=n.charAt(i++);else t.push(f.RIGHTPARENTHESIS),r.push(o),o=n.charAt(i++);else t.push(f.LEFTPARENTHESIS),r.push(o),o=n.charAt(i++)}return t.push(1),r.push("[EOF]"),[t,r]},f.SHIFT="s",f.REDUCE="r",f.ACCEPT="a",f.prototype.parse=function(e){if(!e)throw new Error("XPath expression unspecified.");if("string"!=typeof e)throw new Error("XPath expression must be a string.");var t,r,n=this.tokenize(e);if(null!=n){t=n[0],r=n[1];var i,o,a=0,s=[],l=[],c=[];for(s.push(0),l.push(1),c.push("_S"),i=t[a],o=r[a++];;)switch(e=s[s.length-1],f.actionTable[e].charAt(i-1)){case f.SHIFT:l.push(-i),c.push(o),s.push(f.actionTableNumber[e].charCodeAt(i-1)-32),i=t[a],o=r[a++];break;case f.REDUCE:for(var u=f.productions[f.actionTableNumber[e].charCodeAt(i-1)-32][1],p=[],d=0;d<u;d++)l.pop(),p.unshift(c.pop()),s.pop();var m=s[s.length-1];l.push(f.productions[f.actionTableNumber[e].charCodeAt(i-1)-32][0]),null==this.reduceActions[f.actionTableNumber[e].charCodeAt(i-1)-32]?c.push(p[0]):c.push(this.reduceActions[f.actionTableNumber[e].charCodeAt(i-1)-32](p)),s.push(f.gotoTable[m].charCodeAt(f.productions[f.actionTableNumber[e].charCodeAt(i-1)-32][0]-2)-33);break;case f.ACCEPT:return new h(c.pop());default:throw new Error("XPath parse error")}}},h.prototype=new Object,h.prototype.constructor=h,h.superclass=Object.prototype,h.prototype.toString=function(){return this.expression.toString()},h.prototype.evaluate=function(e){var t=e.expressionContextNode;if(null!=t&&!r(t))throw new Error("Context node does not appear to be a valid DOM node.");return e.contextNode=e.expressionContextNode,e.contextSize=1,e.contextPosition=1,e.isHtml&&(m(e,"caseInsensitive",!0),m(e,"allowAnyNamespaceForNoPrefix",!0)),m(e,"caseInsensitive",!1),this.expression.evaluate(e)},h.XML_NAMESPACE_URI="http://www.w3.org/XML/1998/namespace",h.XMLNS_NAMESPACE_URI="http://www.w3.org/2000/xmlns/",g.prototype=new Object,g.prototype.constructor=g,g.superclass=Object.prototype,g.prototype.init=function(){},g.prototype.toString=function(){return"<Expression>"},g.prototype.evaluate=function(e){throw new Error("Could not evaluate expression.")},y.prototype=new g,y.prototype.constructor=y,y.superclass=g.prototype,y.prototype.init=function(e){this.rhs=e},v.prototype=new y,v.prototype.constructor=v,v.superclass=y.prototype,v.prototype.init=function(e){v.superclass.init.call(this,e)},v.prototype.evaluate=function(e){return this.rhs.evaluate(e).number().negate()},v.prototype.toString=function(){return"-"+this.rhs.toString()},b.prototype=new g,b.prototype.constructor=b,b.superclass=g.prototype,b.prototype.init=function(e,t){this.lhs=e,this.rhs=t},w.prototype=new b,w.prototype.constructor=w,w.superclass=b.prototype,w.prototype.init=function(e,t){w.superclass.init.call(this,e,t)},w.prototype.toString=function(){return"("+this.lhs.toString()+" or "+this.rhs.toString()+")"},w.prototype.evaluate=function(e){var t=this.lhs.evaluate(e).bool();return t.booleanValue()?t:this.rhs.evaluate(e).bool()},E.prototype=new b,E.prototype.constructor=E,E.superclass=b.prototype,E.prototype.init=function(e,t){E.superclass.init.call(this,e,t)},E.prototype.toString=function(){return"("+this.lhs.toString()+" and "+this.rhs.toString()+")"},E.prototype.evaluate=function(e){var t=this.lhs.evaluate(e).bool();return t.booleanValue()?this.rhs.evaluate(e).bool():t},N.prototype=new b,N.prototype.constructor=N,N.superclass=b.prototype,N.prototype.init=function(e,t){N.superclass.init.call(this,e,t)},N.prototype.toString=function(){return"("+this.lhs.toString()+" = "+this.rhs.toString()+")"},N.prototype.evaluate=function(e){return this.lhs.evaluate(e).equals(this.rhs.evaluate(e))},A.prototype=new b,A.prototype.constructor=A,A.superclass=b.prototype,A.prototype.init=function(e,t){A.superclass.init.call(this,e,t)},A.prototype.toString=function(){return"("+this.lhs.toString()+" != "+this.rhs.toString()+")"},A.prototype.evaluate=function(e){return this.lhs.evaluate(e).notequal(this.rhs.evaluate(e))},S.prototype=new b,S.prototype.constructor=S,S.superclass=b.prototype,S.prototype.init=function(e,t){S.superclass.init.call(this,e,t)},S.prototype.evaluate=function(e){return this.lhs.evaluate(e).lessthan(this.rhs.evaluate(e))},S.prototype.toString=function(){return"("+this.lhs.toString()+" < "+this.rhs.toString()+")"},C.prototype=new b,C.prototype.constructor=C,C.superclass=b.prototype,C.prototype.init=function(e,t){C.superclass.init.call(this,e,t)},C.prototype.evaluate=function(e){return this.lhs.evaluate(e).greaterthan(this.rhs.evaluate(e))},C.prototype.toString=function(){return"("+this.lhs.toString()+" > "+this.rhs.toString()+")"},_.prototype=new b,_.prototype.constructor=_,_.superclass=b.prototype,_.prototype.init=function(e,t){_.superclass.init.call(this,e,t)},_.prototype.evaluate=function(e){return this.lhs.evaluate(e).lessthanorequal(this.rhs.evaluate(e))},_.prototype.toString=function(){return"("+this.lhs.toString()+" <= "+this.rhs.toString()+")"},T.prototype=new b,T.prototype.constructor=T,T.superclass=b.prototype,T.prototype.init=function(e,t){T.superclass.init.call(this,e,t)},T.prototype.evaluate=function(e){return this.lhs.evaluate(e).greaterthanorequal(this.rhs.evaluate(e))},T.prototype.toString=function(){return"("+this.lhs.toString()+" >= "+this.rhs.toString()+")"},D.prototype=new b,D.prototype.constructor=D,D.superclass=b.prototype,D.prototype.init=function(e,t){D.superclass.init.call(this,e,t)},D.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().plus(this.rhs.evaluate(e).number())},D.prototype.toString=function(){return"("+this.lhs.toString()+" + "+this.rhs.toString()+")"},I.prototype=new b,I.prototype.constructor=I,I.superclass=b.prototype,I.prototype.init=function(e,t){I.superclass.init.call(this,e,t)},I.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().minus(this.rhs.evaluate(e).number())},I.prototype.toString=function(){return"("+this.lhs.toString()+" - "+this.rhs.toString()+")"},x.prototype=new b,x.prototype.constructor=x,x.superclass=b.prototype,x.prototype.init=function(e,t){x.superclass.init.call(this,e,t)},x.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().multiply(this.rhs.evaluate(e).number())},x.prototype.toString=function(){return"("+this.lhs.toString()+" * "+this.rhs.toString()+")"},P.prototype=new b,P.prototype.constructor=P,P.superclass=b.prototype,P.prototype.init=function(e,t){P.superclass.init.call(this,e,t)},P.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().div(this.rhs.evaluate(e).number())},P.prototype.toString=function(){return"("+this.lhs.toString()+" div "+this.rhs.toString()+")"},k.prototype=new b,k.prototype.constructor=k,k.superclass=b.prototype,k.prototype.init=function(e,t){k.superclass.init.call(this,e,t)},k.prototype.evaluate=function(e){return this.lhs.evaluate(e).number().mod(this.rhs.evaluate(e).number())},k.prototype.toString=function(){return"("+this.lhs.toString()+" mod "+this.rhs.toString()+")"},O.prototype=new b,O.prototype.constructor=O,O.superclass=b.prototype,O.prototype.init=function(e,t){O.superclass.init.call(this,e,t)},O.prototype.evaluate=function(e){return this.lhs.evaluate(e).nodeset().union(this.rhs.evaluate(e).nodeset())},O.prototype.toString=function(){return o(s,[this.lhs,this.rhs]).join(" | ")},R.prototype=new g,R.prototype.constructor=R,R.superclass=g.prototype,R.prototype.init=function(e,t,r){R.superclass.init.call(this),this.filter=e,this.filterPredicates=t,this.locationPath=r};var F=function(e,t,r,o){if(0===e.length)return r;var a=t.extend({});return i((function(e,t){return a.contextSize=e.length,r=function(e,r){return a.contextNode=e,a.contextPosition=r+1,R.predicateMatches(t,a)},i=[],n((function(e,t){r(e,t)&&i.push(e)}),e),i;var r,i}),function(e,t){var r=new Q;r.addArray(e);var n=r.toArray();return t?n.reverse():n}(r,o),e)};function M(e,t,r){return F(e.predicates,t,R.applyStep(e,t,r),a(z,e.axis))}function U(e,t,r){return function(e){for(var t=[],r=0;r<e.length;r+=32767){var n=e.slice(r,r+32767);t=u.apply(t,n)}return t}(o(M.bind(null,r,e),t))}function B(e,t){arguments.length>0&&this.init(e,t)}function j(e,t,r){arguments.length>0&&this.init(e,t,r)}R.getRoot=function(e,t){var r=t[0];if(r&&9===r.nodeType)return r;if(e.virtualRoot)return e.virtualRoot;if(!r)throw new Error("Context node not found when determining document root.");var n=r.ownerDocument;if(n)return n;for(var i=r;null!=i.parentNode;)i=i.parentNode;return i},R.applyStep=function(e,t,r){if(!r)throw new Error("Context node not found when evaluating XPath step: "+e);var n,i=[];switch(t.contextNode=r,e.axis){case j.ANCESTOR:if(t.contextNode===t.virtualRoot)break;for(o=2==t.contextNode.nodeType?R.getOwnerElement(t.contextNode):t.contextNode.parentNode;null!=o&&(e.nodeTest.matches(o,t)&&i.push(o),o!==t.virtualRoot);)o=o.parentNode;break;case j.ANCESTORORSELF:for(var o=t.contextNode;null!=o&&(e.nodeTest.matches(o,t)&&i.push(o),o!==t.virtualRoot);o=2==o.nodeType?R.getOwnerElement(o):o.parentNode);break;case j.ATTRIBUTE:var a=t.contextNode.attributes;if(null!=a)for(var s=0;s<a.length;s++)o=a.item(s),e.nodeTest.matches(o,t)&&i.push(o);break;case j.CHILD:for(o=t.contextNode.firstChild;null!=o;o=o.nextSibling)e.nodeTest.matches(o,t)&&i.push(o);break;case j.DESCENDANT:for(var l=[t.contextNode.firstChild];l.length>0;)for(o=l.pop();null!=o;)e.nodeTest.matches(o,t)&&i.push(o),null!=o.firstChild?(l.push(o.nextSibling),o=o.firstChild):o=o.nextSibling;break;case j.DESCENDANTORSELF:for(e.nodeTest.matches(t.contextNode,t)&&i.push(t.contextNode),l=[t.contextNode.firstChild];l.length>0;)for(o=l.pop();null!=o;)e.nodeTest.matches(o,t)&&i.push(o),null!=o.firstChild?(l.push(o.nextSibling),o=o.firstChild):o=o.nextSibling;break;case j.FOLLOWING:if(t.contextNode===t.virtualRoot)break;for(l=[],null!=t.contextNode.firstChild?l.unshift(t.contextNode.firstChild):l.unshift(t.contextNode.nextSibling),o=t.contextNode.parentNode;null!=o&&9!=o.nodeType&&o!==t.virtualRoot;o=o.parentNode)l.unshift(o.nextSibling);do{for(o=l.pop();null!=o;)e.nodeTest.matches(o,t)&&i.push(o),null!=o.firstChild?(l.push(o.nextSibling),o=o.firstChild):o=o.nextSibling}while(l.length>0);break;case j.FOLLOWINGSIBLING:if(t.contextNode===t.virtualRoot)break;for(o=t.contextNode.nextSibling;null!=o;o=o.nextSibling)e.nodeTest.matches(o,t)&&i.push(o);break;case j.NAMESPACE:var c={};if(1==t.contextNode.nodeType){for(c.xml=new K("xml",null,h.XML_NAMESPACE_URI,t.contextNode),o=t.contextNode;null!=o&&1==o.nodeType;o=o.parentNode)for(s=0;s<o.attributes.length;s++){var u=o.attributes.item(s);null!=(n=void 0,p="xmlns"===(n=String(u.name))?"":"xmlns:"===n.substring(0,6)?n.substring(6,n.length):null)&&null==c[p]&&(c[p]=new K(p,u,u.value,t.contextNode))}for(var p in c)r=c[p],e.nodeTest.matches(r,t)&&i.push(r)}break;case j.PARENT:o=null,t.contextNode!==t.virtualRoot&&(o=2==t.contextNode.nodeType?R.getOwnerElement(t.contextNode):t.contextNode.parentNode),null!=o&&e.nodeTest.matches(o,t)&&i.push(o);break;case j.PRECEDING:l=null!=t.virtualRoot?[t.virtualRoot]:[L(t.contextNode)];e:for(;l.length>0;)for(o=l.pop();null!=o;){if(o==t.contextNode)break e;e.nodeTest.matches(o,t)&&i.unshift(o),null!=o.firstChild?(l.push(o.nextSibling),o=o.firstChild):o=o.nextSibling}break;case j.PRECEDINGSIBLING:if(t.contextNode===t.virtualRoot)break;for(o=t.contextNode.previousSibling;null!=o;o=o.previousSibling)e.nodeTest.matches(o,t)&&i.push(o);break;case j.SELF:e.nodeTest.matches(t.contextNode,t)&&i.push(t.contextNode)}return i},R.applySteps=function(e,t,r){return i(U.bind(null,t),r,e)},R.prototype.applyFilter=function(e,t){if(!this.filter)return{nodes:[e.contextNode]};var r=this.filter.evaluate(e);if(!ne.instance_of(r,Q)){if(null!=this.filterPredicates&&this.filterPredicates.length>0||null!=this.locationPath)throw new Error("Path expression filter must evaluate to a nodeset if predicates or location path are used");return{nonNodes:r}}return{nodes:F(this.filterPredicates||[],t,r.toUnsortedArray(),!1)}},R.applyLocationPath=function(e,t,r){if(!e)return r;var n=e.absolute?[R.getRoot(t,r)]:r;return R.applySteps(e.steps,t,n)},R.prototype.evaluate=function(e){var t=p(new J,e),r=this.applyFilter(e,t);if("nonNodes"in r)return r.nonNodes;var n=new Q;return n.addArray(R.applyLocationPath(this.locationPath,t,r.nodes)),n},R.predicateMatches=function(e,t){var r=e.evaluate(t);return ne.instance_of(r,Y)?t.contextPosition===r.numberValue():r.booleanValue()},R.predicateString=function(e){return c("[","]",e.toString())},R.predicatesString=function(e){return l("",o(R.predicateString,e))},R.prototype.toString=function(){if(null!=this.filter){var e=s(this.filter);return ne.instance_of(this.filter,G)?c("'","'",e):null!=this.filterPredicates&&this.filterPredicates.length?c("(",")",e)+R.predicatesString(this.filterPredicates):null!=this.locationPath?e+(this.locationPath.absolute?"":"/")+s(this.locationPath):e}return s(this.locationPath)},R.getOwnerElement=function(e){if(e.ownerElement)return e.ownerElement;try{if(e.selectSingleNode)return e.selectSingleNode("..")}catch(e){}for(var t=(9==e.nodeType?e:e.ownerDocument).getElementsByTagName("*"),r=0;r<t.length;r++)for(var n=t.item(r),i=n.attributes,o=0;o<i.length;o++)if(i.item(o)===e)return n;return null},B.prototype=new Object,B.prototype.constructor=B,B.superclass=Object.prototype,B.prototype.init=function(e,t){this.absolute=e,this.steps=t},B.prototype.toString=function(){return(this.absolute?"/":"")+o(s,this.steps).join("/")},j.prototype=new Object,j.prototype.constructor=j,j.superclass=Object.prototype,j.prototype.init=function(e,t,r){this.axis=e,this.nodeTest=t,this.predicates=r},j.prototype.toString=function(){return j.STEPNAMES[this.axis]+"::"+this.nodeTest.toString()+R.predicatesString(this.predicates)},j.ANCESTOR=0,j.ANCESTORORSELF=1,j.ATTRIBUTE=2,j.CHILD=3,j.DESCENDANT=4,j.DESCENDANTORSELF=5,j.FOLLOWING=6,j.FOLLOWINGSIBLING=7,j.NAMESPACE=8,j.PARENT=9,j.PRECEDING=10,j.PRECEDINGSIBLING=11,j.SELF=12,j.STEPNAMES=i((function(e,t){return e[t[0]]=t[1],e}),{},[[j.ANCESTOR,"ancestor"],[j.ANCESTORORSELF,"ancestor-or-self"],[j.ATTRIBUTE,"attribute"],[j.CHILD,"child"],[j.DESCENDANT,"descendant"],[j.DESCENDANTORSELF,"descendant-or-self"],[j.FOLLOWING,"following"],[j.FOLLOWINGSIBLING,"following-sibling"],[j.NAMESPACE,"namespace"],[j.PARENT,"parent"],[j.PRECEDING,"preceding"],[j.PRECEDINGSIBLING,"preceding-sibling"],[j.SELF,"self"]]);var z=[j.ANCESTOR,j.ANCESTORORSELF,j.PARENT,j.PRECEDING,j.PRECEDINGSIBLING];function V(e,t){arguments.length>0&&this.init(e,t)}function q(e){arguments.length>0&&this.init(e)}function H(e,t){arguments.length>0&&this.init(e,t)}V.prototype=new Object,V.prototype.constructor=V,V.superclass=Object.prototype,V.prototype.init=function(e,t){this.type=e,this.value=t},V.prototype.toString=function(){return"<unknown nodetest type>"},V.prototype.matches=function(e,t){console.warn("unknown node test type")},V.NAMETESTANY=0,V.NAMETESTPREFIXANY=1,V.NAMETESTQNAME=2,V.COMMENT=3,V.TEXT=4,V.PI=5,V.NODE=6,V.isNodeType=function(e){return function(t){return a(e,t.nodeType)}},V.makeNodeTestType=function(e,t,r){var n=r||function(){};return n.prototype=new V(e),n.prototype.constructor=n,p(n.prototype,t),n},V.makeNodeTypeTest=function(e,t,r){return new(V.makeNodeTestType(e,{matches:V.isNodeType(t),toString:(n=r,function(){return n})}));var n},V.hasPrefix=function(e){return e.prefix||-1!==(e.nodeName||e.tagName).indexOf(":")},V.isElementOrAttribute=V.isNodeType([1,2]),V.nameSpaceMatches=function(e,t,r){var n=r.namespaceURI||"";if(!e)return!n||t.allowAnyNamespaceForNoPrefix&&!V.hasPrefix(r);var i=t.namespaceResolver.getNamespace(e,t.expressionContextNode);if(null==i)throw new Error("Cannot resolve QName "+e);return i===n},V.localNameMatches=function(e,t,r){var n=r.localName||r.nodeName;return t.caseInsensitive?e.toLowerCase()===n.toLowerCase():e===n},V.NameTestPrefixAny=V.makeNodeTestType(V.NAMETESTPREFIXANY,{matches:function(e,t){return V.isElementOrAttribute(e)&&V.nameSpaceMatches(this.prefix,t,e)},toString:function(){return this.prefix+":*"}},(function(e){this.prefix=e})),V.NameTestQName=V.makeNodeTestType(V.NAMETESTQNAME,{matches:function(e,t){return V.isNodeType([1,2,d])(e)&&V.nameSpaceMatches(this.prefix,t,e)&&V.localNameMatches(this.localName,t,e)},toString:function(){return this.name}},(function(e){var t=e.split(":");this.name=e,this.prefix=t.length>1?t[0]:null,this.localName=t[t.length>1?1:0]})),V.PITest=V.makeNodeTestType(V.PI,{matches:function(e,t){return V.isNodeType([7])(e)&&(e.target||e.nodeName)===this.name},toString:function(){return c('processing-instruction("','")',this.name)}},(function(e){this.name=e})),V.nameTestAny=V.makeNodeTypeTest(V.NAMETESTANY,[1,2,d],"*"),V.textTest=V.makeNodeTypeTest(V.TEXT,[3,4],"text()"),V.commentTest=V.makeNodeTypeTest(V.COMMENT,[8],"comment()"),V.nodeTest=V.makeNodeTypeTest(V.NODE,[1,2,3,4,7,8,9],"node()"),V.anyPiTest=V.makeNodeTypeTest(V.PI,[7],"processing-instruction()"),q.prototype=new g,q.prototype.constructor=q,q.superclass=g.prototype,q.prototype.init=function(e){this.variable=e},q.prototype.toString=function(){return"$"+this.variable},q.prototype.evaluate=function(e){var t=ne.resolveQName(this.variable,e.namespaceResolver,e.contextNode,!1);if(null==t[0])throw new Error("Cannot resolve QName "+fn);var r=e.variableResolver.getVariable(t[1],t[0]);if(!r)throw oe.fromMessage("Undeclared variable: "+this.toString());return r},H.prototype=new g,H.prototype.constructor=H,H.superclass=g.prototype,H.prototype.init=function(e,t){this.functionName=e,this.arguments=t},H.prototype.toString=function(){for(var e=this.functionName+"(",t=0;t<this.arguments.length;t++)t>0&&(e+=", "),e+=this.arguments[t].toString();return e+")"},H.prototype.evaluate=function(e){var t=ee.getFunctionFromContext(this.functionName,e);if(!t)throw new Error("Unknown function "+this.functionName);var r=[e].concat(this.arguments);return t.apply(e.functionResolver.thisArg,r)};var W=new Object;function G(e){arguments.length>0&&this.init(e)}function Y(e){arguments.length>0&&this.init(e)}function X(e){arguments.length>0&&this.init(e)}function Z(e){this.init(e)}function Q(){this.init()}function K(e,t,r,n){this.isXPathNamespace=!0,this.baseNode=t,this.ownerDocument=n.ownerDocument,this.nodeName=e,this.prefix=e,this.localName=e,this.namespaceURI=null,this.nodeValue=r,this.ownerElement=n,this.nodeType=d}function J(e,t,r){this.variableResolver=null!=e?e:new $,this.namespaceResolver=null!=t?t:new te,this.functionResolver=null!=r?r:new ee}function $(){}function ee(e){this.thisArg=null!=e?e:re,this.functions=new Object,this.addStandardFunctions()}function te(){}W.equals=function(e,t){return e.equals(t)},W.notequal=function(e,t){return e.notequal(t)},W.lessthan=function(e,t){return e.lessthan(t)},W.greaterthan=function(e,t){return e.greaterthan(t)},W.lessthanorequal=function(e,t){return e.lessthanorequal(t)},W.greaterthanorequal=function(e,t){return e.greaterthanorequal(t)},G.prototype=new g,G.prototype.constructor=G,G.superclass=g.prototype,G.prototype.init=function(e){this.str=String(e)},G.prototype.toString=function(){return this.str},G.prototype.evaluate=function(e){return this},G.prototype.string=function(){return this},G.prototype.number=function(){return new Y(this.str)},G.prototype.bool=function(){return new X(this.str)},G.prototype.nodeset=function(){throw new Error("Cannot convert string to nodeset")},G.prototype.stringValue=function(){return this.str},G.prototype.numberValue=function(){return this.number().numberValue()},G.prototype.booleanValue=function(){return this.bool().booleanValue()},G.prototype.equals=function(e){return ne.instance_of(e,X)?this.bool().equals(e):ne.instance_of(e,Y)?this.number().equals(e):ne.instance_of(e,Q)?e.compareWithString(this,W.equals):new X(this.str==e.str)},G.prototype.notequal=function(e){return ne.instance_of(e,X)?this.bool().notequal(e):ne.instance_of(e,Y)?this.number().notequal(e):ne.instance_of(e,Q)?e.compareWithString(this,W.notequal):new X(this.str!=e.str)},G.prototype.lessthan=function(e){return this.number().lessthan(e)},G.prototype.greaterthan=function(e){return this.number().greaterthan(e)},G.prototype.lessthanorequal=function(e){return this.number().lessthanorequal(e)},G.prototype.greaterthanorequal=function(e){return this.number().greaterthanorequal(e)},Y.prototype=new g,Y.prototype.constructor=Y,Y.superclass=g.prototype,Y.prototype.init=function(e){this.num="string"==typeof e?this.parse(e):Number(e)},Y.prototype.numberFormat=/^\s*-?[0-9]*\.?[0-9]+\s*$/,Y.prototype.parse=function(e){return this.numberFormat.test(e)?parseFloat(e):Number.NaN},Y.prototype.toString=function(){var e=this.num.toString();return-1!==e.indexOf("e-")?function(e){for(var t=e.split("e-"),r=t[0].replace(".",""),n=Number(t[1]),i=0;i<n-1;i+=1)r="0"+r;return"0."+r}(e):-1!==e.indexOf("e")?function(e){for(var t=e.split("e"),r=t[0].replace(".",""),n=Number(t[1])+1-r.length,i=0;i<n;i+=1)r+="0";return r}(e):e},Y.prototype.evaluate=function(e){return this},Y.prototype.string=function(){return new G(this.toString())},Y.prototype.number=function(){return this},Y.prototype.bool=function(){return new X(this.num)},Y.prototype.nodeset=function(){throw new Error("Cannot convert number to nodeset")},Y.prototype.stringValue=function(){return this.string().stringValue()},Y.prototype.numberValue=function(){return this.num},Y.prototype.booleanValue=function(){return this.bool().booleanValue()},Y.prototype.negate=function(){return new Y(-this.num)},Y.prototype.equals=function(e){return ne.instance_of(e,X)?this.bool().equals(e):ne.instance_of(e,G)?this.equals(e.number()):ne.instance_of(e,Q)?e.compareWithNumber(this,W.equals):new X(this.num==e.num)},Y.prototype.notequal=function(e){return ne.instance_of(e,X)?this.bool().notequal(e):ne.instance_of(e,G)?this.notequal(e.number()):ne.instance_of(e,Q)?e.compareWithNumber(this,W.notequal):new X(this.num!=e.num)},Y.prototype.lessthan=function(e){return ne.instance_of(e,Q)?e.compareWithNumber(this,W.greaterthan):ne.instance_of(e,X)||ne.instance_of(e,G)?this.lessthan(e.number()):new X(this.num<e.num)},Y.prototype.greaterthan=function(e){return ne.instance_of(e,Q)?e.compareWithNumber(this,W.lessthan):ne.instance_of(e,X)||ne.instance_of(e,G)?this.greaterthan(e.number()):new X(this.num>e.num)},Y.prototype.lessthanorequal=function(e){return ne.instance_of(e,Q)?e.compareWithNumber(this,W.greaterthanorequal):ne.instance_of(e,X)||ne.instance_of(e,G)?this.lessthanorequal(e.number()):new X(this.num<=e.num)},Y.prototype.greaterthanorequal=function(e){return ne.instance_of(e,Q)?e.compareWithNumber(this,W.lessthanorequal):ne.instance_of(e,X)||ne.instance_of(e,G)?this.greaterthanorequal(e.number()):new X(this.num>=e.num)},Y.prototype.plus=function(e){return new Y(this.num+e.num)},Y.prototype.minus=function(e){return new Y(this.num-e.num)},Y.prototype.multiply=function(e){return new Y(this.num*e.num)},Y.prototype.div=function(e){return new Y(this.num/e.num)},Y.prototype.mod=function(e){return new Y(this.num%e.num)},X.prototype=new g,X.prototype.constructor=X,X.superclass=g.prototype,X.prototype.init=function(e){this.b=Boolean(e)},X.prototype.toString=function(){return this.b.toString()},X.prototype.evaluate=function(e){return this},X.prototype.string=function(){return new G(this.b)},X.prototype.number=function(){return new Y(this.b)},X.prototype.bool=function(){return this},X.prototype.nodeset=function(){throw new Error("Cannot convert boolean to nodeset")},X.prototype.stringValue=function(){return this.string().stringValue()},X.prototype.numberValue=function(){return this.number().numberValue()},X.prototype.booleanValue=function(){return this.b},X.prototype.not=function(){return new X(!this.b)},X.prototype.equals=function(e){return ne.instance_of(e,G)||ne.instance_of(e,Y)?this.equals(e.bool()):ne.instance_of(e,Q)?e.compareWithBoolean(this,W.equals):new X(this.b==e.b)},X.prototype.notequal=function(e){return ne.instance_of(e,G)||ne.instance_of(e,Y)?this.notequal(e.bool()):ne.instance_of(e,Q)?e.compareWithBoolean(this,W.notequal):new X(this.b!=e.b)},X.prototype.lessthan=function(e){return this.number().lessthan(e)},X.prototype.greaterthan=function(e){return this.number().greaterthan(e)},X.prototype.lessthanorequal=function(e){return this.number().lessthanorequal(e)},X.prototype.greaterthanorequal=function(e){return this.number().greaterthanorequal(e)},X.true_=new X(!0),X.false_=new X(!1),Z.prototype=new Object,Z.prototype.constructor=Z,Z.superclass=Object.prototype,Z.prototype.init=function(e){this.left=null,this.right=null,this.node=e,this.depth=1},Z.prototype.balance=function(){var e=null==this.left?0:this.left.depth,t=null==this.right?0:this.right.depth;if(e>t+1)(null==this.left.left?0:this.left.left.depth)<(null==this.left.right?0:this.left.right.depth)&&this.left.rotateRR(),this.rotateLL();else if(e+1<t){var r=null==this.right.right?0:this.right.right.depth;(null==this.right.left?0:this.right.left.depth)>r&&this.right.rotateLL(),this.rotateRR()}},Z.prototype.rotateLL=function(){var e=this.node,t=this.right;this.node=this.left.node,this.right=this.left,this.left=this.left.left,this.right.left=this.right.right,this.right.right=t,this.right.node=e,this.right.updateInNewLocation(),this.updateInNewLocation()},Z.prototype.rotateRR=function(){var e=this.node,t=this.left;this.node=this.right.node,this.left=this.right,this.right=this.right.right,this.left.right=this.left.left,this.left.left=t,this.left.node=e,this.left.updateInNewLocation(),this.updateInNewLocation()},Z.prototype.updateInNewLocation=function(){this.getDepthFromChildren()},Z.prototype.getDepthFromChildren=function(){this.depth=null==this.node?0:1,null!=this.left&&(this.depth=this.left.depth+1),null!=this.right&&this.depth<=this.right.depth&&(this.depth=this.right.depth+1)},Z.prototype.add=function(e){if(e===this.node)return!1;var t=function(e,t){if(e===t)return 0;if(e.compareDocumentPosition){var r=e.compareDocumentPosition(t);return 1&r||10&r?1:20&r?-1:0}for(var n=0,i=0,o=e;null!=o;o=o.parentNode||o.ownerElement)n++;for(var a=t;null!=a;a=a.parentNode||a.ownerElement)i++;if(n>i){for(;n>i;)e=e.parentNode||e.ownerElement,n--;if(e===t)return 1}else if(i>n){for(;i>n;)t=t.parentNode||t.ownerElement,i--;if(e===t)return-1}for(var s=e.parentNode||e.ownerElement,l=t.parentNode||t.ownerElement;s!==l;)t=l,s=(e=s).parentNode||e.ownerElement,l=t.parentNode||t.ownerElement;var c=ie(e),u=ie(t);if(c&&!u)return-1;if(!c&&u)return 1;if(e.isXPathNamespace){if(e.nodeValue===h.XML_NAMESPACE_URI)return-1;if(!t.isXPathNamespace)return-1;if(t.nodeValue===h.XML_NAMESPACE_URI)return 1}else if(t.isXPathNamespace)return 1;if(s)for(var p=c?s.attributes:s.childNodes,d=p.length,f=e.baseNode||e,m=t.baseNode||t,g=0;g<d;g+=1){var y=p[g];if(y===f)return-1;if(y===m)return 1}throw new Error("Unexpected: could not determine node order")}(e,this.node),r=!1;return-1==t?null==this.left?(this.left=new Z(e),r=!0):(r=this.left.add(e))&&this.balance():1==t&&(null==this.right?(this.right=new Z(e),r=!0):(r=this.right.add(e))&&this.balance()),r&&this.getDepthFromChildren(),r},Q.prototype=new g,Q.prototype.constructor=Q,Q.superclass=g.prototype,Q.prototype.init=function(){this.tree=null,this.nodes=[],this.size=0},Q.prototype.toString=function(){var e=this.first();return null==e?"":this.stringForNode(e)},Q.prototype.evaluate=function(e){return this},Q.prototype.string=function(){return new G(this.toString())},Q.prototype.stringValue=function(){return this.toString()},Q.prototype.number=function(){return new Y(this.string())},Q.prototype.numberValue=function(){return Number(this.string())},Q.prototype.bool=function(){return new X(this.booleanValue())},Q.prototype.booleanValue=function(){return!!this.size},Q.prototype.nodeset=function(){return this},Q.prototype.stringForNode=function(e){return 9==e.nodeType||1==e.nodeType||11===e.nodeType?this.stringForContainerNode(e):2===e.nodeType?e.value||e.nodeValue:e.isNamespaceNode?e.namespace:e.nodeValue},Q.prototype.stringForContainerNode=function(e){for(var t="",r=e.firstChild;null!=r;r=r.nextSibling){var n=r.nodeType;1!==n&&3!==n&&4!==n&&9!==n&&11!==n||(t+=this.stringForNode(r))}return t},Q.prototype.buildTree=function(){if(!this.tree&&this.nodes.length){this.tree=new Z(this.nodes[0]);for(var e=1;e<this.nodes.length;e+=1)this.tree.add(this.nodes[e])}return this.tree},Q.prototype.first=function(){var e=this.buildTree();if(null==e)return null;for(;null!=e.left;)e=e.left;return e.node},Q.prototype.add=function(e){for(var t=0;t<this.nodes.length;t+=1)if(e===this.nodes[t])return;this.tree=null,this.nodes.push(e),this.size+=1},Q.prototype.addArray=function(e){var t=this;n((function(e){t.add(e)}),e)},Q.prototype.toArray=function(){var e=[];return this.toArrayRec(this.buildTree(),e),e},Q.prototype.toArrayRec=function(e,t){null!=e&&(this.toArrayRec(e.left,t),t.push(e.node),this.toArrayRec(e.right,t))},Q.prototype.toUnsortedArray=function(){return this.nodes.slice()},Q.prototype.compareWithString=function(e,t){for(var r=this.toUnsortedArray(),n=0;n<r.length;n++){var i=r[n],o=t(new G(this.stringForNode(i)),e);if(o.booleanValue())return o}return new X(!1)},Q.prototype.compareWithNumber=function(e,t){for(var r=this.toUnsortedArray(),n=0;n<r.length;n++){var i=r[n],o=t(new Y(this.stringForNode(i)),e);if(o.booleanValue())return o}return new X(!1)},Q.prototype.compareWithBoolean=function(e,t){return t(this.bool(),e)},Q.prototype.compareWithNodeSet=function(e,t){for(var r=this.toUnsortedArray(),n=function(e,r){return t(r,e)},i=0;i<r.length;i++){var o=new G(this.stringForNode(r[i])),a=e.compareWithString(o,n);if(a.booleanValue())return a}return new X(!1)},Q.compareWith=function(e){var t=Array.prototype.slice,r=e.length,n=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var i=t.call(arguments);return i.length<r?function(e,r){return function(){return r.apply(this,e.concat(t.call(arguments)))}}(i,n):e.apply(this,t.apply(arguments,[0,r]))}));return n}((function(e,t){return ne.instance_of(t,G)?this.compareWithString(t,e):ne.instance_of(t,Y)?this.compareWithNumber(t,e):ne.instance_of(t,X)?this.compareWithBoolean(t,e):this.compareWithNodeSet(t,e)})),Q.prototype.equals=Q.compareWith(W.equals),Q.prototype.notequal=Q.compareWith(W.notequal),Q.prototype.lessthan=Q.compareWith(W.lessthan),Q.prototype.greaterthan=Q.compareWith(W.greaterthan),Q.prototype.lessthanorequal=Q.compareWith(W.lessthanorequal),Q.prototype.greaterthanorequal=Q.compareWith(W.greaterthanorequal),Q.prototype.union=function(e){var t=new Q;return t.addArray(this.toUnsortedArray()),t.addArray(e.toUnsortedArray()),t},K.prototype=new Object,K.prototype.constructor=K,K.superclass=Object.prototype,K.prototype.toString=function(){return'{ "'+this.prefix+'", "'+this.namespaceURI+'" }'},J.prototype=new Object,J.prototype.constructor=J,J.superclass=Object.prototype,J.prototype.extend=function(e){return p(new J,this,e)},$.prototype=new Object,$.prototype.constructor=$,$.superclass=Object.prototype,$.prototype.getVariable=function(e,t){return null},ee.prototype=new Object,ee.prototype.constructor=ee,ee.superclass=Object.prototype,ee.prototype.addStandardFunctions=function(){this.functions["{}last"]=re.last,this.functions["{}position"]=re.position,this.functions["{}count"]=re.count,this.functions["{}id"]=re.id,this.functions["{}local-name"]=re.localName,this.functions["{}namespace-uri"]=re.namespaceURI,this.functions["{}name"]=re.name,this.functions["{}string"]=re.string,this.functions["{}concat"]=re.concat,this.functions["{}starts-with"]=re.startsWith,this.functions["{}contains"]=re.contains,this.functions["{}substring-before"]=re.substringBefore,this.functions["{}substring-after"]=re.substringAfter,this.functions["{}substring"]=re.substring,this.functions["{}string-length"]=re.stringLength,this.functions["{}normalize-space"]=re.normalizeSpace,this.functions["{}translate"]=re.translate,this.functions["{}boolean"]=re.boolean_,this.functions["{}not"]=re.not,this.functions["{}true"]=re.true_,this.functions["{}false"]=re.false_,this.functions["{}lang"]=re.lang,this.functions["{}number"]=re.number,this.functions["{}sum"]=re.sum,this.functions["{}floor"]=re.floor,this.functions["{}ceiling"]=re.ceiling,this.functions["{}round"]=re.round},ee.prototype.addFunction=function(e,t,r){this.functions["{"+e+"}"+t]=r},ee.getFunctionFromContext=function(e,t){var r=ne.resolveQName(e,t.namespaceResolver,t.contextNode,!1);if(null===r[0])throw new Error("Cannot resolve QName "+name);return t.functionResolver.getFunction(r[1],r[0])},ee.prototype.getFunction=function(e,t){return this.functions["{"+t+"}"+e]},te.prototype=new Object,te.prototype.constructor=te,te.superclass=Object.prototype,te.prototype.getNamespace=function(e,t){if("xml"==e)return h.XML_NAMESPACE_URI;if("xmlns"==e)return h.XMLNS_NAMESPACE_URI;for(9==t.nodeType?t=t.documentElement:2==t.nodeType?t=R.getOwnerElement(t):1!=t.nodeType&&(t=t.parentNode);null!=t&&1==t.nodeType;){for(var r=t.attributes,n=0;n<r.length;n++){var i=r.item(n),o=i.name||i.nodeName;if("xmlns"===o&&""===e||o==="xmlns:"+e)return String(i.value||i.nodeValue)}t=t.parentNode}return null};var re=new Object;re.last=function(e){if(1!=arguments.length)throw new Error("Function last expects ()");return new Y(e.contextSize)},re.position=function(e){if(1!=arguments.length)throw new Error("Function position expects ()");return new Y(e.contextPosition)},re.count=function(){var e,t=arguments[0];if(2!=arguments.length||!ne.instance_of(e=arguments[1].evaluate(t),Q))throw new Error("Function count expects (node-set)");return new Y(e.size)},re.id=function(){var e,t=arguments[0];if(2!=arguments.length)throw new Error("Function id expects (object)");e=arguments[1].evaluate(t);for(var r=(e=ne.instance_of(e,Q)?e.toArray().join(" "):e.stringValue()).split(/[\x0d\x0a\x09\x20]+/),n=new Q,i=9==t.contextNode.nodeType?t.contextNode:t.contextNode.ownerDocument,o=0;o<r.length;o++){var a;null!=(a=i.getElementById?i.getElementById(r[o]):ne.getElementById(i,r[o]))&&n.add(a)}return n},re.localName=function(e,t){var r;if(1==arguments.length)r=e.contextNode;else{if(2!=arguments.length)throw new Error("Function local-name expects (node-set?)");r=t.evaluate(e).first()}return new G(null==r?"":r.localName||r.baseName||r.target||r.nodeName||"")},re.namespaceURI=function(){var e,t=arguments[0];if(1==arguments.length)e=t.contextNode;else{if(2!=arguments.length)throw new Error("Function namespace-uri expects (node-set?)");e=arguments[1].evaluate(t).first()}return new G(null==e?"":e.namespaceURI||"")},re.name=function(){var e,t=arguments[0];if(1==arguments.length)e=t.contextNode;else{if(2!=arguments.length)throw new Error("Function name expects (node-set?)");e=arguments[1].evaluate(t).first()}return null==e?new G(""):1==e.nodeType?new G(e.nodeName):2==e.nodeType?new G(e.name||e.nodeName):7===e.nodeType?new G(e.target||e.nodeName):null==e.localName?new G(""):new G(e.localName)},re.string=function(){var e=arguments[0];if(1==arguments.length)return new G(Q.prototype.stringForNode(e.contextNode));if(2==arguments.length)return arguments[1].evaluate(e).string();throw new Error("Function string expects (object?)")},re.concat=function(e){if(arguments.length<3)throw new Error("Function concat expects (string, string[, string]*)");for(var t="",r=1;r<arguments.length;r++)t+=arguments[r].evaluate(e).stringValue();return new G(t)},re.startsWith=function(){var e=arguments[0];if(3!=arguments.length)throw new Error("Function startsWith expects (string, string)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue();return new X(t.substring(0,r.length)==r)},re.contains=function(){var e=arguments[0];if(3!=arguments.length)throw new Error("Function contains expects (string, string)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue();return new X(-1!==t.indexOf(r))},re.substringBefore=function(){var e=arguments[0];if(3!=arguments.length)throw new Error("Function substring-before expects (string, string)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue();return new G(t.substring(0,t.indexOf(r)))},re.substringAfter=function(){var e=arguments[0];if(3!=arguments.length)throw new Error("Function substring-after expects (string, string)");var t=arguments[1].evaluate(e).stringValue(),r=arguments[2].evaluate(e).stringValue();if(0==r.length)return new G(t);var n=t.indexOf(r);return new G(-1==n?"":t.substring(n+r.length))},re.substring=function(){var e=arguments[0];if(3!=arguments.length&&4!=arguments.length)throw new Error("Function substring expects (string, number, number?)");var t=arguments[1].evaluate(e).stringValue(),r=Math.round(arguments[2].evaluate(e).numberValue())-1,n=4==arguments.length?r+Math.round(arguments[3].evaluate(e).numberValue()):void 0;return new G(t.substring(r,n))},re.stringLength=function(){var e,t=arguments[0];if(1==arguments.length)e=Q.prototype.stringForNode(t.contextNode);else{if(2!=arguments.length)throw new Error("Function string-length expects (string?)");e=arguments[1].evaluate(t).stringValue()}return new Y(e.length)},re.normalizeSpace=function(){var e,t=arguments[0];if(1==arguments.length)e=Q.prototype.stringForNode(t.contextNode);else{if(2!=arguments.length)throw new Error("Function normalize-space expects (string?)");e=arguments[1].evaluate(t).stringValue()}for(var r=0,n=e.length-1;ne.isSpace(e.charCodeAt(n));)n--;for(var i="";r<=n&&ne.isSpace(e.charCodeAt(r));)r++;for(;r<=n;)if(ne.isSpace(e.charCodeAt(r)))for(i+=" ";r<=n&&ne.isSpace(e.charCodeAt(r));)r++;else i+=e.charAt(r),r++;return new G(i)},re.translate=function(e,t,r,n){if(4!=arguments.length)throw new Error("Function translate expects (string, string, string)");var a=t.evaluate(e).stringValue(),s=r.evaluate(e).stringValue(),c=n.evaluate(e).stringValue(),u=i((function(e,t,r){return t in e||(e[t]=r>c.length?"":c[r]),e}),{},s);return new G(l("",o((function(e){return e in u?u[e]:e}),a)))},re.boolean_=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function boolean expects (object)");return arguments[1].evaluate(e).bool()},re.not=function(e,t){if(2!=arguments.length)throw new Error("Function not expects (object)");return t.evaluate(e).bool().not()},re.true_=function(){if(1!=arguments.length)throw new Error("Function true expects ()");return X.true_},re.false_=function(){if(1!=arguments.length)throw new Error("Function false expects ()");return X.false_},re.lang=function(){var e,t=arguments[0];if(2!=arguments.length)throw new Error("Function lang expects (string)");for(var r=t.contextNode;null!=r&&9!=r.nodeType;r=r.parentNode){var n=r.getAttributeNS(h.XML_NAMESPACE_URI,"lang");if(null!=n){e=String(n);break}}if(null==e)return X.false_;var i=arguments[1].evaluate(t).stringValue();return new X(e.substring(0,i.length)==i&&(e.length==i.length||"-"==e.charAt(i.length)))},re.number=function(){var e=arguments[0];if(1!=arguments.length&&2!=arguments.length)throw new Error("Function number expects (object?)");return 1==arguments.length?new Y(Q.prototype.stringForNode(e.contextNode)):arguments[1].evaluate(e).number()},re.sum=function(){var e,t=arguments[0];if(2!=arguments.length||!ne.instance_of(e=arguments[1].evaluate(t),Q))throw new Error("Function sum expects (node-set)");e=e.toUnsortedArray();for(var r=0,n=0;n<e.length;n++)r+=new Y(Q.prototype.stringForNode(e[n])).numberValue();return new Y(r)},re.floor=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function floor expects (number)");return new Y(Math.floor(arguments[1].evaluate(e).numberValue()))},re.ceiling=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function ceiling expects (number)");return new Y(Math.ceil(arguments[1].evaluate(e).numberValue()))},re.round=function(){var e=arguments[0];if(2!=arguments.length)throw new Error("Function round expects (number)");return new Y(Math.round(arguments[1].evaluate(e).numberValue()))};var ne=new Object,ie=function(e){return e&&(2===e.nodeType||e.ownerElement||e.isXPathNamespace)};ne.splitQName=function(e){var t=e.indexOf(":");return-1==t?[null,e]:[e.substring(0,t),e.substring(t+1)]},ne.resolveQName=function(e,t,r,n){var i=ne.splitQName(e);return null!=i[0]?i[0]=t.getNamespace(i[0],r):n?(i[0]=t.getNamespace("",r),null==i[0]&&(i[0]="")):i[0]="",i},ne.isSpace=function(e){return 9==e||13==e||10==e||32==e},ne.isLetter=function(e){return e>=65&&e<=90||e>=97&&e<=122||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=255||e>=256&&e<=305||e>=308&&e<=318||e>=321&&e<=328||e>=330&&e<=382||e>=384&&e<=451||e>=461&&e<=496||e>=500&&e<=501||e>=506&&e<=535||e>=592&&e<=680||e>=699&&e<=705||902==e||e>=904&&e<=906||908==e||e>=910&&e<=929||e>=931&&e<=974||e>=976&&e<=982||986==e||988==e||990==e||992==e||e>=994&&e<=1011||e>=1025&&e<=1036||e>=1038&&e<=1103||e>=1105&&e<=1116||e>=1118&&e<=1153||e>=1168&&e<=1220||e>=1223&&e<=1224||e>=1227&&e<=1228||e>=1232&&e<=1259||e>=1262&&e<=1269||e>=1272&&e<=1273||e>=1329&&e<=1366||1369==e||e>=1377&&e<=1414||e>=1488&&e<=1514||e>=1520&&e<=1522||e>=1569&&e<=1594||e>=1601&&e<=1610||e>=1649&&e<=1719||e>=1722&&e<=1726||e>=1728&&e<=1742||e>=1744&&e<=1747||1749==e||e>=1765&&e<=1766||e>=2309&&e<=2361||2365==e||e>=2392&&e<=2401||e>=2437&&e<=2444||e>=2447&&e<=2448||e>=2451&&e<=2472||e>=2474&&e<=2480||2482==e||e>=2486&&e<=2489||e>=2524&&e<=2525||e>=2527&&e<=2529||e>=2544&&e<=2545||e>=2565&&e<=2570||e>=2575&&e<=2576||e>=2579&&e<=2600||e>=2602&&e<=2608||e>=2610&&e<=2611||e>=2613&&e<=2614||e>=2616&&e<=2617||e>=2649&&e<=2652||2654==e||e>=2674&&e<=2676||e>=2693&&e<=2699||2701==e||e>=2703&&e<=2705||e>=2707&&e<=2728||e>=2730&&e<=2736||e>=2738&&e<=2739||e>=2741&&e<=2745||2749==e||2784==e||e>=2821&&e<=2828||e>=2831&&e<=2832||e>=2835&&e<=2856||e>=2858&&e<=2864||e>=2866&&e<=2867||e>=2870&&e<=2873||2877==e||e>=2908&&e<=2909||e>=2911&&e<=2913||e>=2949&&e<=2954||e>=2958&&e<=2960||e>=2962&&e<=2965||e>=2969&&e<=2970||2972==e||e>=2974&&e<=2975||e>=2979&&e<=2980||e>=2984&&e<=2986||e>=2990&&e<=2997||e>=2999&&e<=3001||e>=3077&&e<=3084||e>=3086&&e<=3088||e>=3090&&e<=3112||e>=3114&&e<=3123||e>=3125&&e<=3129||e>=3168&&e<=3169||e>=3205&&e<=3212||e>=3214&&e<=3216||e>=3218&&e<=3240||e>=3242&&e<=3251||e>=3253&&e<=3257||3294==e||e>=3296&&e<=3297||e>=3333&&e<=3340||e>=3342&&e<=3344||e>=3346&&e<=3368||e>=3370&&e<=3385||e>=3424&&e<=3425||e>=3585&&e<=3630||3632==e||e>=3634&&e<=3635||e>=3648&&e<=3653||e>=3713&&e<=3714||3716==e||e>=3719&&e<=3720||3722==e||3725==e||e>=3732&&e<=3735||e>=3737&&e<=3743||e>=3745&&e<=3747||3749==e||3751==e||e>=3754&&e<=3755||e>=3757&&e<=3758||3760==e||e>=3762&&e<=3763||3773==e||e>=3776&&e<=3780||e>=3904&&e<=3911||e>=3913&&e<=3945||e>=4256&&e<=4293||e>=4304&&e<=4342||4352==e||e>=4354&&e<=4355||e>=4357&&e<=4359||4361==e||e>=4363&&e<=4364||e>=4366&&e<=4370||4412==e||4414==e||4416==e||4428==e||4430==e||4432==e||e>=4436&&e<=4437||4441==e||e>=4447&&e<=4449||4451==e||4453==e||4455==e||4457==e||e>=4461&&e<=4462||e>=4466&&e<=4467||4469==e||4510==e||4520==e||4523==e||e>=4526&&e<=4527||e>=4535&&e<=4536||4538==e||e>=4540&&e<=4546||4587==e||4592==e||4601==e||e>=7680&&e<=7835||e>=7840&&e<=7929||e>=7936&&e<=7957||e>=7960&&e<=7965||e>=7968&&e<=8005||e>=8008&&e<=8013||e>=8016&&e<=8023||8025==e||8027==e||8029==e||e>=8031&&e<=8061||e>=8064&&e<=8116||e>=8118&&e<=8124||8126==e||e>=8130&&e<=8132||e>=8134&&e<=8140||e>=8144&&e<=8147||e>=8150&&e<=8155||e>=8160&&e<=8172||e>=8178&&e<=8180||e>=8182&&e<=8188||8486==e||e>=8490&&e<=8491||8494==e||e>=8576&&e<=8578||e>=12353&&e<=12436||e>=12449&&e<=12538||e>=12549&&e<=12588||e>=44032&&e<=55203||e>=19968&&e<=40869||12295==e||e>=12321&&e<=12329},ne.isNCNameChar=function(e){return e>=48&&e<=57||e>=1632&&e<=1641||e>=1776&&e<=1785||e>=2406&&e<=2415||e>=2534&&e<=2543||e>=2662&&e<=2671||e>=2790&&e<=2799||e>=2918&&e<=2927||e>=3047&&e<=3055||e>=3174&&e<=3183||e>=3302&&e<=3311||e>=3430&&e<=3439||e>=3664&&e<=3673||e>=3792&&e<=3801||e>=3872&&e<=3881||46==e||45==e||95==e||ne.isLetter(e)||e>=768&&e<=837||e>=864&&e<=865||e>=1155&&e<=1158||e>=1425&&e<=1441||e>=1443&&e<=1465||e>=1467&&e<=1469||1471==e||e>=1473&&e<=1474||1476==e||e>=1611&&e<=1618||1648==e||e>=1750&&e<=1756||e>=1757&&e<=1759||e>=1760&&e<=1764||e>=1767&&e<=1768||e>=1770&&e<=1773||e>=2305&&e<=2307||2364==e||e>=2366&&e<=2380||2381==e||e>=2385&&e<=2388||e>=2402&&e<=2403||e>=2433&&e<=2435||2492==e||2494==e||2495==e||e>=2496&&e<=2500||e>=2503&&e<=2504||e>=2507&&e<=2509||2519==e||e>=2530&&e<=2531||2562==e||2620==e||2622==e||2623==e||e>=2624&&e<=2626||e>=2631&&e<=2632||e>=2635&&e<=2637||e>=2672&&e<=2673||e>=2689&&e<=2691||2748==e||e>=2750&&e<=2757||e>=2759&&e<=2761||e>=2763&&e<=2765||e>=2817&&e<=2819||2876==e||e>=2878&&e<=2883||e>=2887&&e<=2888||e>=2891&&e<=2893||e>=2902&&e<=2903||e>=2946&&e<=2947||e>=3006&&e<=3010||e>=3014&&e<=3016||e>=3018&&e<=3021||3031==e||e>=3073&&e<=3075||e>=3134&&e<=3140||e>=3142&&e<=3144||e>=3146&&e<=3149||e>=3157&&e<=3158||e>=3202&&e<=3203||e>=3262&&e<=3268||e>=3270&&e<=3272||e>=3274&&e<=3277||e>=3285&&e<=3286||e>=3330&&e<=3331||e>=3390&&e<=3395||e>=3398&&e<=3400||e>=3402&&e<=3405||3415==e||3633==e||e>=3636&&e<=3642||e>=3655&&e<=3662||3761==e||e>=3764&&e<=3769||e>=3771&&e<=3772||e>=3784&&e<=3789||e>=3864&&e<=3865||3893==e||3895==e||3897==e||3902==e||3903==e||e>=3953&&e<=3972||e>=3974&&e<=3979||e>=3984&&e<=3989||3991==e||e>=3993&&e<=4013||e>=4017&&e<=4023||4025==e||e>=8400&&e<=8412||8417==e||e>=12330&&e<=12335||12441==e||12442==e||183==e||720==e||721==e||903==e||1600==e||3654==e||3782==e||12293==e||e>=12337&&e<=12341||e>=12445&&e<=12446||e>=12540&&e<=12542},ne.coalesceText=function(e){for(var t=e.firstChild;null!=t;t=t.nextSibling)if(3==t.nodeType||4==t.nodeType){var r=t.nodeValue,n=t;for(t=t.nextSibling;null!=t&&(3==t.nodeType||4==t.nodeType);){r+=t.nodeValue;var i=t;t=t.nextSibling,i.parentNode.removeChild(i)}if(4==n.nodeType){var o=n.parentNode;if(null==n.nextSibling)o.removeChild(n),o.appendChild(o.ownerDocument.createTextNode(r));else{var a=n.nextSibling;o.removeChild(n),o.insertBefore(o.ownerDocument.createTextNode(r),a)}}else n.nodeValue=r;if(null==t)break}else 1==t.nodeType&&ne.coalesceText(t)},ne.instance_of=function(e,t){for(;null!=e;){if(e.constructor===t)return!0;if(e===Object)return!1;e=e.constructor.superclass}return!1},ne.getElementById=function(e,t){if(1==e.nodeType&&(e.getAttribute("id")==t||e.getAttributeNS(null,"id")==t))return e;for(var r=e.firstChild;null!=r;r=r.nextSibling){var n=ne.getElementById(r,t);if(null!=n)return n}return null};var oe=function(){function e(t,r,n){var i=Error.call(this,function(t,r){var n=r?": "+r.toString():"";switch(t){case e.INVALID_EXPRESSION_ERR:return"Invalid expression"+n;case e.TYPE_ERR:return"Type error"+n}return null}(t,r)||n);return i.code=t,i.exception=r,i}return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e.superclass=Error,e.prototype.toString=function(){return this.message},e.fromMessage=function(t,r){return new e(null,r,t)},e.INVALID_EXPRESSION_ERR=51,e.TYPE_ERR=52,e}();function ae(e,t,r){this.xpath=r.parse(e),this.context=new J,this.context.namespaceResolver=new se(t)}function se(e){this.xpathNSResolver=e}function le(e){this.node=e,this.namespaceResolver=new te}function ce(e,t){switch(t==ce.ANY_TYPE&&(e.constructor===G?t=ce.STRING_TYPE:e.constructor===Y?t=ce.NUMBER_TYPE:e.constructor===X?t=ce.BOOLEAN_TYPE:e.constructor===Q&&(t=ce.UNORDERED_NODE_ITERATOR_TYPE)),this.resultType=t,t){case ce.NUMBER_TYPE:return void(this.numberValue=e.numberValue());case ce.STRING_TYPE:return void(this.stringValue=e.stringValue());case ce.BOOLEAN_TYPE:return void(this.booleanValue=e.booleanValue());case ce.ANY_UNORDERED_NODE_TYPE:case ce.FIRST_ORDERED_NODE_TYPE:if(e.constructor===Q)return void(this.singleNodeValue=e.first());break;case ce.UNORDERED_NODE_ITERATOR_TYPE:case ce.ORDERED_NODE_ITERATOR_TYPE:if(e.constructor===Q)return this.invalidIteratorState=!1,this.nodes=e.toArray(),void(this.iteratorIndex=0);break;case ce.UNORDERED_NODE_SNAPSHOT_TYPE:case ce.ORDERED_NODE_SNAPSHOT_TYPE:if(e.constructor===Q)return this.nodes=e.toArray(),void(this.snapshotLength=this.nodes.length)}throw new oe(oe.TYPE_ERR)}function ue(e,t){e.createExpression=function(e,r){try{return new ae(e,r,t)}catch(e){throw new oe(oe.INVALID_EXPRESSION_ERR,e)}},e.createNSResolver=function(e){return new le(e)},e.evaluate=function(r,n,i,o,a){if(o<0||o>9)throw{code:0,toString:function(){return"Request type not supported"}};return e.createExpression(r,i,t).evaluate(n,o,a)}}ae.prototype={},ae.prototype.constructor=ae,ae.superclass=Object.prototype,ae.getOwnerDocument=function(e){return 9===e.nodeType?e:e.ownerDocument},ae.detectHtmlDom=function(e){if(!e)return!1;var t=ae.getOwnerDocument(e);try{return t.implementation.hasFeature("HTML","2.0")}catch(e){return!0}},ae.prototype.evaluate=function(e,t,r){return this.context.expressionContextNode=e,this.context.caseInsensitive=ae.detectHtmlDom(e),new ce(this.xpath.evaluate(this.context),t)},se.prototype={},se.prototype.constructor=se,se.superclass=Object.prototype,se.prototype.getNamespace=function(e,t){return null==this.xpathNSResolver?null:this.xpathNSResolver.lookupNamespaceURI(e)},le.prototype={},le.prototype.constructor=le,le.superclass=Object.prototype,le.prototype.lookupNamespaceURI=function(e){return this.namespaceResolver.getNamespace(e,this.node)},ce.prototype={},ce.prototype.constructor=ce,ce.superclass=Object.prototype,ce.prototype.iterateNext=function(){if(this.resultType!=ce.UNORDERED_NODE_ITERATOR_TYPE&&this.resultType!=ce.ORDERED_NODE_ITERATOR_TYPE)throw new oe(oe.TYPE_ERR);return this.nodes[this.iteratorIndex++]},ce.prototype.snapshotItem=function(e){if(this.resultType!=ce.UNORDERED_NODE_SNAPSHOT_TYPE&&this.resultType!=ce.ORDERED_NODE_SNAPSHOT_TYPE)throw new oe(oe.TYPE_ERR);return this.nodes[e]},ce.ANY_TYPE=0,ce.NUMBER_TYPE=1,ce.STRING_TYPE=2,ce.BOOLEAN_TYPE=3,ce.UNORDERED_NODE_ITERATOR_TYPE=4,ce.ORDERED_NODE_ITERATOR_TYPE=5,ce.UNORDERED_NODE_SNAPSHOT_TYPE=6,ce.ORDERED_NODE_SNAPSHOT_TYPE=7,ce.ANY_UNORDERED_NODE_TYPE=8,ce.FIRST_ORDERED_NODE_TYPE=9;try{var pe=!0;try{document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("XPath",null)&&(pe=!1)}catch(e){}pe&&ue(document,new f)}catch(e){}ue(e,new f),function(){var t=new f,r=new te,n=new ee,i=new $;function o(e){return{getNamespace:function(t,n){return e(t,n)||r.getNamespace(t,n)}}}function a(e){if(null==e||e instanceof G||e instanceof X||e instanceof Y||e instanceof Q)return e;switch(typeof e){case"string":return new G(e);case"boolean":return new X(e);case"number":return new Y(e)}var t=new Q;return t.addArray([].concat(e)),t}function s(e){return{getFunction:function(t,r){var i=e(t,r);return i?function(e){return function(t){var r=Array.prototype.slice.call(arguments,1).map((function(e){return e.evaluate(t)}));return a(e.apply(this,[].concat(t,r)))}}(i):n.getFunction(t,r)}}}function l(e){return{getVariable:function(t,r){return a(e(t,r))}}}function c(e,t,r){e in r&&(t[e]=r[e])}function u(e){var t,a,u=new J;return e?(u.namespaceResolver=(t=e.namespaces)&&"function"==typeof t.getNamespace?o((a=t).getNamespace.bind(a)):"function"==typeof t?o(t):"object"==typeof t?function(e){return o((function(t){return e[t]}))}(t):r,u.functionResolver=function(e){return e&&"function"==typeof e.getFunction?s((t=e).getFunction.bind(t)):"function"==typeof e?s(e):"object"==typeof e?function(e){return s((function(t){return e[t]}))}(e):n;var t}(e.functions),u.variableResolver=function(e){if(e){if("function"==typeof e.getVariable)return l(e.getVariable.bind(e));if("function"==typeof e)return l(e);if("object"==typeof e)return l((function(t){return e[t]}))}return i}(e.variables),u.expressionContextNode=e.node,c("allowAnyNamespaceForNoPrefix",u,e),c("isHtml",u,e)):u.namespaceResolver=r,u}var p={evaluate:function(e){return function(e,t){var r=u(t);return e.evaluate(r)}(this.expression,e)},evaluateNumber:function(e){return this.evaluate(e).numberValue()},evaluateString:function(e){return this.evaluate(e).stringValue()},evaluateBoolean:function(e){return this.evaluate(e).booleanValue()},evaluateNodeSet:function(e){return this.evaluate(e).nodeset()},select:function(e){return this.evaluateNodeSet(e).toArray()},select1:function(e){return this.select(e)[0]}};e.parse=function(e){var r=t.parse(e);return Object.create(p,{expression:{value:r}})}}(),p(e,{XPath:h,XPathParser:f,XPathResult:ce,Step:j,PathExpr:R,NodeTest:V,LocationPath:B,OrOperation:w,AndOperation:E,BarOperation:O,EqualsOperation:N,NotEqualOperation:A,LessThanOperation:S,GreaterThanOperation:C,LessThanOrEqualOperation:_,GreaterThanOrEqualOperation:T,PlusOperation:D,MinusOperation:I,MultiplyOperation:x,DivOperation:P,ModOperation:k,UnaryMinusOperation:v,FunctionCall:H,VariableReference:q,XPathContext:J,XNodeSet:Q,XBoolean:X,XString:G,XNumber:Y,NamespaceResolver:te,FunctionResolver:ee,VariableResolver:$,Utilities:ne}),e.select=function(t,r,n){return e.selectWithResolver(t,r,null,n)},e.useNamespaces=function(t){var r={mappings:t||{},lookupNamespaceURI:function(e){return this.mappings[e]}};return function(t,n,i){return e.selectWithResolver(t,n,r,i)}},e.selectWithResolver=function(e,t,r,n){var i=new ae(e,r,new f),o=ce.ANY_TYPE,a=i.evaluate(t,o,null);return a.resultType==ce.STRING_TYPE?a=a.stringValue:a.resultType==ce.NUMBER_TYPE?a=a.numberValue:a.resultType==ce.BOOLEAN_TYPE?a=a.booleanValue:(a=a.nodes,n&&(a=a[0])),a},e.select1=function(t,r){return e.select(t,r,!0)};var de=function(e){return function(t){return r(t)&&t.nodeType===e}};p(e,{isNodeLike:r,isArrayOfNodes:function(e){return Array.isArray(e)&&e.every(r)},isElement:de(1),isAttribute:de(2),isTextNode:de(3),isCDATASection:de(4),isProcessingInstruction:de(7),isComment:de(8),isDocumentNode:de(9),isDocumentTypeNode:de(10),isDocumentFragment:de(11)})}(t)},9113:(e,t,r)=>{"use strict";var n=r(6116),i=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],o=["scalar","sequence","mapping"];e.exports=function(e,t){var r,a;if(t=t||{},Object.keys(t).forEach((function(t){if(-1===i.indexOf(t))throw new n('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=(r=t.styleAliases||null,a={},null!==r&&Object.keys(r).forEach((function(e){r[e].forEach((function(t){a[String(t)]=e}))})),a),-1===o.indexOf(this.kind))throw new n('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}},9257:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDeclaredVariables=function(e){var t,r=(null==e||null===(t=e.properties)||void 0===t||null===(t=t.definition)||void 0===t?void 0:t.actions)||{},n=[];return Object.keys(r).forEach((e=>{var t,i=r[e];null!==(t=i.inputs)&&void 0!==t&&t.variables&&n.push(...i.inputs.variables)})),n},t.getVariablesUsedInVariableActions=function(e){var t,r=(null==e||null===(t=e.properties)||void 0===t||null===(t=t.definition)||void 0===t?void 0:t.actions)||{},n=new Set;return Object.keys(r).forEach((e=>{var t,i=r[e];null!=i&&null!==(t=i.inputs)&&void 0!==t&&t.name&&n.add(i.inputs.name)})),n}},9284:(e,t,r)=>{"use strict";function n(e,t){e.prototype=Object.create(Error.prototype,{constructor:{value:e},name:{value:e.name,enumerable:!0,writable:t}})}var i=r(3715).freeze({Error:"Error",IndexSizeError:"IndexSizeError",DomstringSizeError:"DomstringSizeError",HierarchyRequestError:"HierarchyRequestError",WrongDocumentError:"WrongDocumentError",InvalidCharacterError:"InvalidCharacterError",NoDataAllowedError:"NoDataAllowedError",NoModificationAllowedError:"NoModificationAllowedError",NotFoundError:"NotFoundError",NotSupportedError:"NotSupportedError",InUseAttributeError:"InUseAttributeError",InvalidStateError:"InvalidStateError",SyntaxError:"SyntaxError",InvalidModificationError:"InvalidModificationError",NamespaceError:"NamespaceError",InvalidAccessError:"InvalidAccessError",ValidationError:"ValidationError",TypeMismatchError:"TypeMismatchError",SecurityError:"SecurityError",NetworkError:"NetworkError",AbortError:"AbortError",URLMismatchError:"URLMismatchError",QuotaExceededError:"QuotaExceededError",TimeoutError:"TimeoutError",InvalidNodeTypeError:"InvalidNodeTypeError",DataCloneError:"DataCloneError",EncodingError:"EncodingError",NotReadableError:"NotReadableError",UnknownError:"UnknownError",ConstraintError:"ConstraintError",DataError:"DataError",TransactionInactiveError:"TransactionInactiveError",ReadOnlyError:"ReadOnlyError",VersionError:"VersionError",OperationError:"OperationError",NotAllowedError:"NotAllowedError",OptOutError:"OptOutError"}),o=Object.keys(i);function a(e){return"number"==typeof e&&e>=1&&e<=25}function s(e,t){var r;a(e)?(this.name=o[e],this.message=t||""):(this.message=e,this.name="string"==typeof(r=t)&&r.substring(r.length-i.Error.length)===i.Error?t:i.Error),Error.captureStackTrace&&Error.captureStackTrace(this,s)}n(s,!0),Object.defineProperties(s.prototype,{code:{enumerable:!0,get:function(){var e=o.indexOf(this.name);return a(e)?e:0}}});for(var l={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25},c=Object.entries(l),u=0;u<c.length;u++)s[c[u][0]]=c[u][1];function p(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,p)}n(p),t.DOMException=s,t.DOMExceptionName=i,t.ExceptionCode=l,t.ParseError=p},9444:e=>{"use strict";function t(e){return null==e}e.exports.isNothing=t,e.exports.isObject=function(e){return"object"==typeof e&&null!==e},e.exports.toArray=function(e){return Array.isArray(e)?e:t(e)?[]:[e]},e.exports.repeat=function(e,t){var r,n="";for(r=0;r<t;r+=1)n+=e;return n},e.exports.isNegativeZero=function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},e.exports.extend=function(e,t){var r,n,i,o;if(t)for(r=0,n=(o=Object.keys(t)).length;r<n;r+=1)e[i=o[r]]=t[i];return e}},9650:(e,t,r)=>{"use strict";var n=r(9113);e.exports=new n("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}})},9734:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.createMsApp=function(){return{appSettings:{Name:"",AppPreviewFlagsMap:{},AppDescription:"",DocumentType:""},totalCodeComponents:0,dataSources:[],appCheckerIssues:[],assets:[],yaml:{},totalCanvasComponents:0,totalScreens:0}},t.removeComments=function(e){return e.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//gm,"")},t.getExternalDataSources=s,t.iterateThroughScreens=function(e){var t=e.yaml.Screens,r=[];if(!t)return o.default.warn("No screens found in the yaml structure."),r;var n=s(e).map((e=>e.toLowerCase()));for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var u=t[i];null!=u&&u.Properties&&l(i,"",u.Properties,r,e,u.Control||"","",n),null!=u&&u.Children&&(c(i,0,u.Children,r,e,u.Control||"",n),(0,a.patternCheckForUxLayout)(i,u.Children[0],r))}var p=e.yaml.App;return null!=p&&p.Properties&&l("App","",p.Properties,r,e,"","",n),r},t.processControlProperties=l,t.processSubControls=c,t.processFailures=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[],o=function(e){var t={};for(var r of e){var n=r.PatternName;t[n]||(t[n]=[]),t[n].push(r)}return t}(e),s=Object.keys(i.PowerAppsPatternDetails);for(var l of s){var c=d(l,o[l]||[],t,r);n.push(c)}var p=[];for(var f of Object.keys(a.singleSetVariables)){var h=a.singleSetVariables[f];h.FailureReason="Variable '".concat(f,"' is initialized once but never updated. Consider defining in Named Formula."),p.push(h)}for(var m of Object.keys(a.singleCollectCollections)){var g=a.singleCollectCollections[m];g.FailureReason="Collection '".concat(m,"' is initialized once but never updated (no Patch). Consider defining in Named Formula."),p.push(g)}if(p.length>0){e.push(...p),n=n.filter((e=>"app-NamedFormulas"!==e.patternID));var y=i.PowerAppsPatternDetails[i.PowerAppsPatternInfo.NamedFormulas],v={patternID:y.patternID,patternName:y.patternName,description:y.description,status:"Warning",instanceValue:p,failureReason:u(p),recommendation:y.recommendation,docLinks:y.docLinks,severity:y.severity,category:y.category};n.push(v)}return Object.keys(a.singleSetVariables).forEach((e=>delete a.singleSetVariables[e])),Object.keys(a.singleCollectCollections).forEach((e=>delete a.singleCollectCollections[e])),n},t.containsNestedIf=function(e){for(var t=e.toLowerCase(),r=/\bif\s*\(/gi;;){var n=r.exec(t);if(!n)break;var i=n.index+n[0].indexOf("("),{endIndex:o}=f(e,i);if(-1!==o){e.substring(n.index,o+1);var a=e.substring(i+1,o);if(/\bif\s*\(/i.test(a))return e.substring(n.index,o+1)}}return null},t.tokenizeCode=function(e){for(var t=[],r="",n=!1,i="",o=0;o<e.length;o++){var a=e[o];n?(r+=a,a===i&&"\\"!==e[o-1]&&(n=!1)):'"'===a||"'"===a?(r.trim()&&t.push(r.trim()),r=a,n=!0,i=a):"("===a||")"===a||","===a?(r.trim()&&t.push(r.trim()),t.push(a),r=""):/\s/.test(a)?r.trim()&&(t.push(r.trim()),r=""):r+=a}return r.trim()&&t.push(r.trim()),t},t.findAPIFunctionOccurrences=function(e){for(var t,r=[],n=/\b(Filter|Search|ForAll|LookUp|Patch)\s*\(/gi;null!==(t=n.exec(e));){var i=t[1],o=t.index+t[0].indexOf("("),{endIndex:a}=f(e,o);if(-1!==a){var s=e.substring(o+1,a);r.push({functionName:i,startIndex:o+1,endIndex:a,content:s})}}return r},t.findMatchingParenthesis=f,t.getFirstParameter=function(e){for(var t=0,r=0;r<e.length;){if("("===e[r])t++;else if(")"===e[r])t--;else if(","===e[r]&&0===t)break;r++}return e.substring(0,r).trim()},t.normalizeDataSourceName=function(e){return e.replace(/^[\[\']\s*@?\s*(.+?)\s*[\]\']$/i,"$1").trim()},t.findPatchOccurrences=function(e){for(var t,r=[],n=/\b(Patch)\s*\(/gi;null!==(t=n.exec(e));){var i=t[1],o=t.index+t[0].indexOf("("),{endIndex:a}=f(e,o);if(-1!==a){var s=e.substring(o+1,a);r.push({functionName:i,startIndex:o+1,endIndex:a,content:s})}}return r},t.getNthArgument=function(e,t){for(var r=0,n=0,i=0,o=0,a=1;n<e.length;){var s=e[n];if("("===s)r++;else if(")"===s)r--;else if(","===s&&0===r){if(a===t){o=n;break}a++,i=n+1}n++}return a===t&&0===o&&(o=e.length),a===t?e.substring(i,o).trim():null},t.isFunctionWrapped=function(e,t,r){for(var n,i=/([a-zA-Z_][a-zA-Z0-9_]*)\s*\(/g;null!==(n=i.exec(e));){var o=n[1],a=n.index+n[0].length-1,{endIndex:s}=f(e,a);if(-1!==s){var l=t>=a&&t<=s;if(l&&r.map((e=>e.toLowerCase())).includes(o.toLowerCase()))return!0;l||(i.lastIndex=s+1)}}return!1},t.findFirstLastOccurrences=function(e){for(var t,r=[],n=/\b(First|FirstN|Last|LastN)\s*\(/gi;null!==(t=n.exec(e));){var i=t[1],o=t.index+t[0].indexOf("("),{endIndex:a}=f(e,o);if(-1!==a){var s=e.substring(o+1,a);r.push({functionName:i,startIndex:o+1,endIndex:a,content:s})}}return r},t.findFilterSearchOccurrences=function(e){for(var t,r=[],n=/\b(Filter|Search)\s*\(/gi;null!==(t=n.exec(e));){var i=t[1],o=t.index+t[0].indexOf("("),{endIndex:a}=f(e,o);if(-1!==a){var s=e.substring(o+1,a);r.push({functionName:i,startIndex:o+1,endIndex:a,content:s})}}return r},t.findFilterSearchLookUpOccurrences=function(e){for(var t,r=[],n=/\b(Filter|Search|LookUp)\s*\(/gi;null!==(t=n.exec(e));){var i=t[1],o=t.index+t[0].indexOf("("),{endIndex:a}=f(e,o);if(-1!==a){var s=e.substring(o+1,a);r.push({functionName:i,startIndex:o+1,endIndex:a,content:s})}}return r};var i=r(7985),o=n(r(5525)),a=r(1376);function s(e){return e.dataSources&&Array.isArray(e.dataSources)?e.dataSources.filter((e=>"CollectionDataSourceInfo"!==e.Type&&"StaticDataSourceInfo"!==e.Type)).map((e=>e.Name)):(console.error("DataSources not found or not an array in msapp."),[])}function l(e,t,r,n,o,s,l,c){for(var u in s=s.split("@")[0],l=l.split("@")[0],r){var p=r[u];i.PropertyExclusionList.includes(u)||("Gallery"!==l||u.startsWith("On")||(0,a.patternCheckForNPlusOneQuery)(u,p,n,e,t,o,c,s),(0,a.patternCheckForNamedFormulas)(p,e,t,u,s),(0,a.patternCheckForInefficientDataRetrieval)(u,p,n,e,t,o,c,s),(0,a.patternCheckForNestedFilters)(u,p,n,e,t,o,c,s),(0,a.patternCheckForPatchFormulaOptimization)(u,p,n,e,t,o,c,s),(0,a.patternCheckForCodeReadability)(u,p,n,e,t,s),(0,a.patternCheckForNestedAPICalls)(u,p,n,e,t,o,c,s),(0,a.patternCheckForErrorHandling)(u,p,n,e,t,o,c,s))}}function c(e,t,r,n,i,o,a){for(var s of r){var u=Object.keys(s)[0],p=s[u];p.Properties&&l(e,u,p.Properties,n,i,p.Control,o,a),p.Children&&c(e,0,p.Children,n,i,p.Control,a)}}function u(e){var t=[],r=[];return e.forEach((e=>{var n,i,o=null===(n=e.FailureReason)||void 0===n?void 0:n.match(/Variable '(.*?)'/);o&&t.push(o[1]);var a=null===(i=e.FailureReason)||void 0===i?void 0:i.match(/Collection '(.*?)'/);a&&r.push(a[1])})),[t.length>0?"Variables that are initialized but never updated: ".concat(t.join(", "),"."):"",r.length>0?"\nCollections that are initialized but never updated: ".concat(r.join(", "),"."):""].filter(Boolean).join(" ")}var p=[i.PowerAppsPatternInfo.ErrorHandling,i.PowerAppsPatternInfo.UxLayout,i.PowerAppsPatternInfo.NamedFormulas,i.PowerAppsPatternInfo.CodeReadability,i.PowerAppsPatternInfo.NestedAPICalls,i.PowerAppsPatternInfo.NPlusOne,i.PowerAppsPatternInfo.InefficientDataRetrieval,i.PowerAppsPatternInfo.NestedFilters,i.PowerAppsPatternInfo.PatchFormulaOptimization];function d(e,t,r,n){var o=i.PowerAppsPatternDetails[e],a=t.length>0,s=(e,t)=>null!=e&&""!==e?e:t,l=o.patternID,{patternName:c,description:u,docLinks:d,recommendation:f,severity:h,category:m}=o;if(r){var g=r.find((e=>e.key===l));if(g){var{data:y}=g;c=s(y.patternName,c),u=s(y.description,u),d=s(y.docLinks,d),f=s(y.recommendation,f),h=s(y.severity,h),m=s(y.category,m)}}var v=a?"Fail":"Pass";return!a&&n&&p.includes(e)&&(v="Skipped"),e===i.PowerAppsPatternInfo.NamedFormulas&&a&&"Skipped"!==v&&(v="Warning"),{patternID:l,patternName:c,description:u,status:v,instanceValue:t,failureReason:a?"Found ".concat(t.length," occurrences."):"",recommendation:f,docLinks:d,severity:h,category:m}}function f(e,t){for(var r=1,n=t+1;n<e.length&&r>0;)"("===e[n]?r++:")"===e[n]&&r--,n++;return 0===r?{endIndex:n-1}:{endIndex:-1}}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.c=t,r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var n=r(r.s=3152);pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad=n})();
if (window.ComponentFramework && window.ComponentFramework.registerControl) {
	ComponentFramework.registerControl('PowerCAT.IntelligentReviewVisualizer', pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.IntelligentReviewVisualizer);
} else {
	var PowerCAT = PowerCAT || {};
	PowerCAT.IntelligentReviewVisualizer = pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.IntelligentReviewVisualizer;
	pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad = undefined;
}