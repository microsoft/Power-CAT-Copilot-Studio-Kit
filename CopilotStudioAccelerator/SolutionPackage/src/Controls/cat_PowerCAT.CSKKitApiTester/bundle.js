/*! For license information please see bundle.js.LICENSE.txt */
var pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad;(()=>{"use strict";var e={d:(t,s)=>{for(var o in s)e.o(s,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:s[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{CSKKitApiTester:()=>n});var s=function(e,t,s,o){return new(s||(s=Promise))((function(r,n){function i(e){try{u(o.next(e))}catch(e){n(e)}}function a(e){try{u(o.throw(e))}catch(e){n(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,a)}u((o=o.apply(e,t||[])).next())}))};class o{constructor(){this.entityValue1={fullname:"System Administrator1",internalemailaddress:"admin1@CRM931440.OnMicrosoft.com",systemuserid:"a697caef-6776-ec12-8d21-000d3a0ca45e",ownerid:"a697caef-6776-ec12-8d21-000d3a0ca45e"},this.entityValue2={fullname:"System Administrator2",internalemailaddress:"admin2@CRM931440.OnMicrosoft.com",systemuserid:"a697caef-6776-ec12-8d21-000d3a0ca45e",ownerid:"a697caef-6776-ec12-8d21-000d3a0ca45e"},this.lookupValue={id:"a697caef-6776-ec11-8d21-000d3a0ca45e",name:"Contoso1",entityType:"Contoso"}}getRecords(e,t,o,r,n){return new Promise(((i,a)=>{(()=>{s(this,void 0,void 0,(function*(){try{var s="?$select=".concat(o),u="&$filter=".concat(r),d=s.concat(r.length>0?u:""),l=yield e.retrieveMultipleRecords(t,d,n);i(l.entities.map((e=>e)))}catch(e){e instanceof Error&&"PCFNonImplementedError"===e.name?(console.log("PCFNonImplementedError"),i([this.entityValue1,this.entityValue2])):a(e)}}))})()}))}getRecordbyID(e,t,o,r,n){return new Promise(((i,a)=>{(()=>{s(this,void 0,void 0,(function*(){try{var s="?$select=".concat(r),u="&$filter=".concat(n),d=r?s.concat(n.length>0?u:""):void 0;return yield e.retrieveRecord(t,o,d)}catch(e){e instanceof Error&&"PCFNonImplementedError"===e.name?(console.log("PCFNonImplementedError"),i([this.entityValue1])):a(e)}}))})()}))}createRecord(e,t,o){return new Promise(((r,n)=>{(()=>{s(this,void 0,void 0,(function*(){try{return yield e.createRecord(t,o)}catch(e){e instanceof Error&&"PCFNonImplementedError"===e.name?(console.log("PCFNonImplementedError"),r(this.lookupValue)):n(e)}}))})()}))}deleteRecord(e,t,o){return new Promise(((r,n)=>{(()=>{s(this,void 0,void 0,(function*(){try{return yield e.deleteRecord(t,o)}catch(e){e instanceof Error&&"PCFNonImplementedError"===e.name?(console.log("PCFNonImplementedError"),r(this.lookupValue)):n(e)}}))})()}))}updateRecord(e,t,o,r){return new Promise(((n,i)=>{(()=>{s(this,void 0,void 0,(function*(){try{return yield e.updateRecord(t,o,r)}catch(e){e instanceof Error&&"PCFNonImplementedError"===e.name?(console.log("PCFNonImplementedError"),n(this.lookupValue)):i(e)}}))})()}))}Get(e,t){return new Promise(((o,r)=>{var n={Output:"",StatusCode:0,Headers:void 0,IsXML:!1};(()=>{s(this,void 0,void 0,(function*(){try{var s=yield fetch(e,{method:"Get",headers:t});n.StatusCode=s.status,n.Headers=s.headers;var i=s.headers.get("content-type");i&&i.includes("application/json")?(n.Output=yield s.json(),n.IsXML=!1):i&&(i.includes("application/xml")||i.includes("text/xml"))&&(n.Output=yield s.text(),n.IsXML=!0),o(n)}catch(e){console.error(e),e instanceof Error&&"PCFNonImplementedError"===e.name?(console.error("PCFNonImplementedError"),o({id:"1",value:"test1"})):(n.Output=e,n.StatusCode=500,n.IsXML=!1,r(n))}}))})()}))}Post(e,t,o){return new Promise(((r,n)=>{var i={Output:"",StatusCode:0,Headers:void 0,IsXML:!1};(()=>{s(this,void 0,void 0,(function*(){try{var s=yield fetch(e,{method:"Post",headers:o,body:t});i.StatusCode=s.status,i.Headers=s.headers;var a=s.headers.get("content-type");a&&a.includes("application/json")?(i.Output=yield s.json(),i.IsXML=!1):a&&(a.includes("application/xml")||a.includes("text/xml"))&&(i.Output=yield s.text(),i.IsXML=!0),r(i)}catch(e){console.error(e),e instanceof Error&&"PCFNonImplementedError"===e.name?(console.error("PCFNonImplementedError"),r({id:"1",value:"test1"})):(i.Output=e,i.StatusCode=500,i.IsXML=!1,n(i))}}))})()}))}Put(e,t,o){return new Promise(((r,n)=>{var i={Output:"",StatusCode:0,Headers:void 0,IsXML:!1};(()=>{s(this,void 0,void 0,(function*(){try{var s=yield fetch(e,{method:"Put",headers:o,body:t});i.StatusCode=s.status,i.Headers=s.headers;var a=s.headers.get("content-type");a&&a.includes("application/json")?(i.Output=yield s.json(),i.IsXML=!1):a&&(a.includes("application/xml")||a.includes("text/xml"))&&(i.Output=yield s.text(),i.IsXML=!0),r(i)}catch(e){console.error(e),e instanceof Error&&"PCFNonImplementedError"===e.name?(console.error("PCFNonImplementedError"),r({id:"1",value:"test1"})):(i.Output=e,i.StatusCode=500,i.IsXML=!1,n(i))}}))})()}))}Patch(e,t,o){return new Promise(((r,n)=>{var i={Output:"",StatusCode:0,Headers:void 0,IsXML:!1};(()=>{s(this,void 0,void 0,(function*(){try{var s=yield fetch(e,{method:"Patch",headers:o,body:t});i.StatusCode=s.status,i.Headers=s.headers;var a=s.headers.get("content-type");a&&a.includes("application/json")?(i.Output=yield s.json(),i.IsXML=!1):a&&(a.includes("application/xml")||a.includes("text/xml"))&&(i.Output=yield s.text(),i.IsXML=!0),r(i)}catch(e){console.error(e),e instanceof Error&&"PCFNonImplementedError"===e.name?(console.error("PCFNonImplementedError"),r({id:"1",value:"test1"})):(i.Output=e,i.StatusCode=500,i.IsXML=!1,n(i))}}))})()}))}Delete(e,t,o){return new Promise(((r,n)=>{var i={Output:"",StatusCode:0,Headers:void 0,IsXML:!1};(()=>{s(this,void 0,void 0,(function*(){try{var s=yield fetch(e,{method:"Delete",headers:o,body:t});i.StatusCode=s.status,i.Headers=s.headers;var a=s.headers.get("content-type");a&&a.includes("application/json")?(i.Output=yield s.json(),i.IsXML=!1):a&&(a.includes("application/xml")||a.includes("text/xml"))&&(i.Output=yield s.text(),i.IsXML=!0),r(i)}catch(e){console.error(e),e instanceof Error&&"PCFNonImplementedError"===e.name?(console.error("PCFNonImplementedError"),r({id:"1",value:"test1"})):(i.Output=e,i.StatusCode=500,i.IsXML=!1,n(i))}}))})()}))}}var r=function(e,t,s,o){return new(s||(s=Promise))((function(r,n){function i(e){try{u(o.next(e))}catch(e){n(e)}}function a(e){try{u(o.throw(e))}catch(e){n(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(i,a)}u((o=o.apply(e,t||[])).next())}))};class n{init(e,t,s,o){this.context=e,this.notifyOutputChanged=t}updateView(e){var t,s,n,i,a=e,u=null!==(t=e.parameters.RequestURL.raw)&&void 0!==t?t:"",d=e.parameters.Method.raw,l=new o,c=null!==(s=e.parameters.Data.raw)&&void 0!==s?s:"",h=new Headers,p=null!==(n=e.parameters.Headers.raw)&&void 0!==n?n:"";try{""!=p&&null!=p&&null!=p?JSON.parse(p).forEach((e=>{h.append(e.key,e.value)})):h.append("Content-Type","application/json")}catch(e){console.warn("Invalid JSON format for Headers"),h.append("Content-Type","application/json")}if(e.updatedProperties.indexOf("Trigger")>-1)if(u){var v=a.page.getClientUrl().concat(u),m=Date.now(),f=0;switch(d){case"Get":l.Get(v,h).then((e=>{var t,s,o;f=Date.now()-m,this.response=e.Output,this.isSuccessful=!0,this.isError=!1,this.requestSize=new Blob([e.Output]).size,this.responseTime=null!==(t=f.toString())&&void 0!==t?t:"",this.statusCode=null!==(s=e.StatusCode)&&void 0!==s?s:0,this.isXML=null!==(o=e.IsXML)&&void 0!==o&&o,this.notifyOutputChanged()})).catch((e=>{var t,s,o;this.response=e.Output,this.isSuccessful=!1,this.isError=!0,this.responseTime=null!==(t=f.toString())&&void 0!==t?t:"",this.statusCode=null!==(s=e.StatusCode)&&void 0!==s?s:500,this.isXML=null!==(o=e.IsXML)&&void 0!==o&&o,this.notifyOutputChanged()}));break;case"Post":f=Date.now()-m,l.Post(v,c,h).then((e=>{var t,s,o,r;this.response=e.Output,this.isSuccessful=!0,this.isError=!1,this.requestSize=null!=e.Headers&&null!==(t=parseInt(e.Headers.get("Content-Length")))&&void 0!==t?t:new Blob([e.Output]).size,this.responseTime=null!==(s=f.toString())&&void 0!==s?s:"",this.statusCode=null!==(o=e.StatusCode)&&void 0!==o?o:500,this.isXML=null!==(r=e.IsXML)&&void 0!==r&&r,this.notifyOutputChanged()})).catch((e=>{(()=>{r(this,void 0,void 0,(function*(){var t,s;this.response=e.Output,this.isSuccessful=!1,this.isError=!0,this.responseTime=f.toString(),this.statusCode=null!==(t=e.StatusCode)&&void 0!==t?t:500,this.isXML=null!==(s=e.IsXML)&&void 0!==s&&s,this.notifyOutputChanged()}))})()}));break;case"Patch":f=Date.now()-m,l.Patch(v,c,h).then((e=>{var t,s,o,r;this.response=e.Output,this.isSuccessful=!0,this.isError=!1,this.requestSize=null!=e.Headers&&null!==(t=parseInt(e.Headers.get("Content-Length")))&&void 0!==t?t:new Blob([e.Output]).size,this.responseTime=null!==(s=f.toString())&&void 0!==s?s:"",this.statusCode=null!==(o=e.StatusCode)&&void 0!==o?o:500,this.isXML=null!==(r=e.IsXML)&&void 0!==r&&r,this.notifyOutputChanged()})).catch((e=>{(()=>{r(this,void 0,void 0,(function*(){var t,s;this.response=e.Output,this.isSuccessful=!1,this.isError=!0,this.responseTime=f.toString(),this.statusCode=null!==(t=e.StatusCode)&&void 0!==t?t:500,this.isXML=null!==(s=e.IsXML)&&void 0!==s&&s,this.notifyOutputChanged()}))})()}));break;case"Put":f=Date.now()-m,l.Put(v,c,h).then((e=>{var t,s,o,r;this.response=e.Output,this.isSuccessful=!0,this.isError=!1,this.requestSize=null!=e.Headers&&null!==(t=parseInt(e.Headers.get("Content-Length")))&&void 0!==t?t:new Blob([e.Output]).size,this.responseTime=null!==(s=f.toString())&&void 0!==s?s:"",this.statusCode=null!==(o=e.StatusCode)&&void 0!==o?o:500,this.isXML=null!==(r=e.IsXML)&&void 0!==r&&r,this.notifyOutputChanged()})).catch((e=>{(()=>{r(this,void 0,void 0,(function*(){var t,s;this.response=e.Output,this.isSuccessful=!1,this.isError=!0,this.responseTime=f.toString(),this.statusCode=null!==(t=e.StatusCode)&&void 0!==t?t:500,this.isXML=null!==(s=e.IsXML)&&void 0!==s&&s,this.notifyOutputChanged()}))})()}));break;case"Delete":f=Date.now()-m,l.Delete(v,c,h).then((e=>{var t,s,o,r;this.response=e.Output,this.isSuccessful=!0,this.isError=!1,this.requestSize=null!=e.Headers&&null!==(t=parseInt(e.Headers.get("Content-Length")))&&void 0!==t?t:new Blob([e.Output]).size,this.responseTime=null!==(s=f.toString())&&void 0!==s?s:"",this.statusCode=null!==(o=e.StatusCode)&&void 0!==o?o:500,this.isXML=null!==(r=e.IsXML)&&void 0!==r&&r,this.notifyOutputChanged()})).catch((e=>{(()=>{r(this,void 0,void 0,(function*(){var t,s;this.response=e.Output,this.isSuccessful=!1,this.isError=!0,this.responseTime=f.toString(),this.statusCode=null!==(t=e.StatusCode)&&void 0!==t?t:500,this.isXML=null!==(s=e.IsXML)&&void 0!==s&&s,this.notifyOutputChanged()}))})()}))}this.requestID=null!==(i=e.parameters.RequestID.raw)&&void 0!==i?i:""}else console.warn("EndPoint/RequestURL missing !")}getOutputs(){return{ResponseID:this.requestID,IsSuccessful:this.isSuccessful,IsError:this.isError,OutputString:this.isXML?(new XMLSerializer).serializeToString((new DOMParser).parseFromString(this.response,"text/xml")):JSON.stringify(this.response),StatusCode:this.statusCode.toString(),StatusContent:this.GetStatusText(this.statusCode),RequestSize:this.formatBytes(this.requestSize),ResponseTime:this.responseTime,IsXML:this.isXML}}destroy(){}GetStatusText(e){var t="";switch(e){case 200:t="OK";break;case 201:t="Created";break;case 202:t="Accepted";break;case 204:t="No Content";break;case 400:t="Bad Request";break;case 401:t="Unauthorized";break;case 403:t="Forbidden";break;case 404:t="Not Found";break;case 500:t="Internal Server Error";break;default:t="Unknown"}return t}formatBytes(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(!+e)return"0 bytes";var s=t<0?0:t,o=Math.floor(Math.log(e)/Math.log(1024));return"".concat(parseFloat((e/Math.pow(1024,o)).toFixed(s))," ").concat(["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][o])}}pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad=t})();
if (window.ComponentFramework && window.ComponentFramework.registerControl) {
	ComponentFramework.registerControl('PowerCAT.CSKKitApiTester', pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.CSKKitApiTester);
} else {
	var PowerCAT = PowerCAT || {};
	PowerCAT.CSKKitApiTester = pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.CSKKitApiTester;
	pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad = undefined;
}